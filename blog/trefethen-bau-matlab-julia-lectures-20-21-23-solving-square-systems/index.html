<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Wowchemy 5.7.0 for Hugo"><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload as=style href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media=print onload='this.media="all"'><link rel=stylesheet href=/css/vendor-bundle.min.16f785cdb553c8c4431db6775122af35.css media=print onload='this.media="all"'><link rel=stylesheet href=/css/wowchemy.24595df0c2dd320a6929bb350c13027d.css><link rel=stylesheet href=/css/libs/chroma/github-light.min.css title=hl-light media=print onload='this.media="all"' disabled><link rel=stylesheet href=/css/libs/chroma/dracula.min.css title=hl-dark media=print onload='this.media="all"'><meta name=author content="Toby Driscoll"><meta name=description content="Three in one this time: Lecture 20, which is on Gaussian elimination / LU factorization, Lecture 21, on row pivoting, and Lecture 23, on Cholesky factorization. I mainly skipped over Lecture 22, about the curious case of the stability of pivoted LU, but the main example is dropped into the end of my coverage of pivoting."><link rel=alternate hreflang=en-us href=https://tobydriscoll.net/blog/trefethen-bau-matlab-julia-lectures-20-21-23-solving-square-systems/><link rel=canonical href=https://tobydriscoll.net/blog/trefethen-bau-matlab-julia-lectures-20-21-23-solving-square-systems/><link rel=manifest href=/manifest.webmanifest><link rel=icon type=image/png href=/media/icon_hudca3d2a3171f399896ba920e49ec6cc3_21724_32x32_fill_lanczos_center_3.png><link rel=apple-touch-icon type=image/png href=/media/icon_hudca3d2a3171f399896ba920e49ec6cc3_21724_180x180_fill_lanczos_center_3.png><meta name=theme-color content="#bbdefb"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="https://tobydriscoll.net/media/logo_hueac33246f157bcd904a645b7aca24b63_24178_300x300_fit_lanczos_3.png"><meta property="og:site_name" content="Toby Driscoll"><meta property="og:url" content="https://tobydriscoll.net/blog/trefethen-bau-matlab-julia-lectures-20-21-23-solving-square-systems/"><meta property="og:title" content="Trefethen & Bau & MATLAB & Julia: Lectures 20, 21, 23: Solving square systems | Toby Driscoll"><meta property="og:description" content="Three in one this time: Lecture 20, which is on Gaussian elimination / LU factorization, Lecture 21, on row pivoting, and Lecture 23, on Cholesky factorization. I mainly skipped over Lecture 22, about the curious case of the stability of pivoted LU, but the main example is dropped into the end of my coverage of pivoting."><meta property="og:image" content="https://tobydriscoll.net/media/logo_hueac33246f157bcd904a645b7aca24b63_24178_300x300_fit_lanczos_3.png"><meta property="og:locale" content="en-us"><meta property="article:published_time" content="2016-10-22T16:20:15+00:00"><meta property="article:modified_time" content="2016-10-22T16:20:15+00:00"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://tobydriscoll.net/blog/trefethen-bau-matlab-julia-lectures-20-21-23-solving-square-systems/"},"headline":"Trefethen \u0026 Bau \u0026 MATLAB \u0026 Julia: Lectures 20, 21, 23: Solving square systems","datePublished":"2016-10-22T16:20:15Z","dateModified":"2016-10-22T16:20:15Z","author":{"@type":"Person","name":"Toby Driscoll"},"publisher":{"@type":"Organization","name":"Toby Driscoll","logo":{"@type":"ImageObject","url":"https://tobydriscoll.net/media/logo_hueac33246f157bcd904a645b7aca24b63_24178_192x192_fit_lanczos_3.png"}},"description":"Three in one this time: Lecture 20, which is on Gaussian elimination / LU factorization, Lecture 21, on row pivoting, and Lecture 23, on Cholesky factorization. I mainly skipped over Lecture 22, about the curious case of the stability of pivoted LU, but the main example is dropped into the end of my coverage of pivoting."}</script><title>Trefethen & Bau & MATLAB & Julia: Lectures 20, 21, 23: Solving square systems | Toby Driscoll</title></head><body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents class="page-wrapper dark" data-wc-page-id=c32f3a8fd2634ad2f758eff11a182cd0><script src=/js/wowchemy-init.min.2a7b4dc7d7846171b6299e17e1f3ac71.js></script><div class="page-header header--fixed"><header><nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id=navbar-main><div class=container-xl><div class="d-none d-lg-inline-flex"><a class=navbar-brand href=/><img src=/media/logo_hueac33246f157bcd904a645b7aca24b63_24178_0x70_resize_lanczos_3.png alt="Toby Driscoll"></a></div><button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-content aria-controls=navbar-content aria-expanded=false aria-label="Toggle navigation">
<span><i class="fas fa-bars"></i></span></button><div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none"><a class=navbar-brand href=/><img src=/media/logo_hueac33246f157bcd904a645b7aca24b63_24178_0x70_resize_lanczos_3.png alt="Toby Driscoll"></a></div><div class="navbar-collapse main-menu-item collapse justify-content-start" id=navbar-content><ul class="navbar-nav d-md-inline-flex"><li class=nav-item><a class=nav-link href=/#about><span>Home</span></a></li><li class=nav-item><a class=nav-link href=/post><span>Posts</span></a></li><li class=nav-item><a class=nav-link href=/publication><span>Publications</span></a></li><li class=nav-item><a class=nav-link href=/tag/book><span>Books</span></a></li><li class=nav-item><a class=nav-link href=/tag/software><span>Software</span></a></li><li class=nav-item><a class=nav-link href=/#contact><span>Contact</span></a></li></ul></div><ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2"></ul></div></nav></header></div><div class=page-body><article class=article><div class="article-container pt-3"><h1>Trefethen & Bau & MATLAB & Julia: Lectures 20, 21, 23: Solving square systems</h1><div class=article-metadata><span class=article-date>Oct 22, 2016</span>
<span class=middot-divider></span>
<span class=article-reading-time>4 min read</span>
<span class=middot-divider></span>
<span class=article-categories><i class="fas fa-folder mr-1"></i><a href=/category/computing/>computing</a>, <a href=/category/teaching/>teaching</a></span></div></div><div class=article-container><div class=article-style><p>Three in one this time: <a href=https://gist.github.com/tobydriscoll/e2f44e7756b864050b52c6773aa83b70 target=_blank rel=noopener>Lecture 20</a>, which is on Gaussian elimination / LU factorization, <a href=https://gist.github.com/tobydriscoll/2b74da569406da55c599a61afe99cf56 target=_blank rel=noopener>Lecture 21</a>, on row pivoting, and <a href=https://gist.github.com/tobydriscoll/17ce89eb2c827e0b870877219ec64fe8 target=_blank rel=noopener>Lecture 23</a>, on Cholesky factorization. I mainly skipped over Lecture 22, about the curious case of the stability of pivoted LU, but the main example is dropped into the end of my coverage of pivoting.</p><p>The Julia surprises are, not surprisingly, coming less frequently. In Lecture 20 I had some fun with rational representations. I like using MATLAB&rsquo;s <code>format rat</code> when presenting Gaussian elimination, as it allows me to recall the way the process looks when learned by hand. It&rsquo;s a fun trick, but of course the underlying values are still all double precision, and the rational approximations to them are found ex post facto. By contrast, Julia offers true rational numbers, constructed and shown using the <code>//</code> operation.</p><p>Compare the MATLAB</p><pre><code class=language-matlab>format rat
I = eye(4);
L21 = I + (-5/17)*I(:,2)*I(:,1)';
L31 = I + (-9/17)*I(:,3)*I(:,1)';
L41 = I + (-4/17)*I(:,4)*I(:,1)';
</code></pre><p>to the Julia</p><pre><code class=language-julia>I = eye(Rational,4);
L21 = copy(I);  L21[2,1] = -5//17;
L31 = copy(I);  L31[3,1] = -9//17;
L41 = copy(I);  L41[4,1] = -4//17;
</code></pre><p>The MATLAB code requires only the <code>format</code> call, because it&rsquo;s only the display of results that is affected. The Julia code is doing something deeper and needs more changes as a result.</p><p>Julia could use something like a <code>format</code> command. I almost always find MATLAB&rsquo;s terminal output more readable, or at least easier to manipulate into a good form. Here&rsquo;s one example using the rational output. First, MATLAB:</p><pre><code class=language-matlab>17              2              3             13             93       
 0            194/17         155/17          71/17         963/17    
 0            101/17          92/17          87/17         574/17    
 0            230/17         243/17         -18/17        1158/17
</code></pre><p>And the Julia:</p><pre><code class=language-julia>4x5 Array{Rational{T&amp;lt;:Integer},2}:
17//1    2//1     3//1    13//1    93//2 
  0//1  194//17  155//17   71//17  963//34
  0//1  101//17   92//17   87//17  287//17
  0//1  230//17  243//17  -18//17  579//17
</code></pre><p>I almost never need that header line that Julia gives. The numbers are already showing themselves to be Rational, and the shape of the array is self-evident. (Though I now see that MATLAB 2016b is adding such headers to non-float output.) The zero structure also jumps out more clearly in the MATLAB case, though it&rsquo;s profligate with whitespace.</p><p>Another comparison, of MATLAB (using the default format):</p><pre><code class=language-matlab>1     0     0     0     0     1
0     1     0     0     0     2
0     0     1     0     0     4
0     0     0     1     0     8
0     0     0     0     1    16
0     0     0     0     0    32
</code></pre><p>versus Julia:</p><pre><code class=language-julia>6×6 Array{Float64,2}:
  1.0  0.0  0.0  0.0  0.0   1.0
  0.0  1.0  0.0  0.0  0.0   2.0
  0.0  0.0  1.0  0.0  0.0   4.0
  0.0  0.0  0.0  1.0  0.0   8.0
  0.0  0.0  0.0  0.0  1.0  16.0
  0.0  0.0  0.0  0.0  0.0  32.0
</code></pre><p>There&rsquo;s nothing wrong per se about Julia&rsquo;s. But which version would you write down, or expect to see in print? One last case, of a matrix that is supposed to be triangular but for a little roundoff. First, Julia:</p><pre><code class=language-julia>4×4 Array{Float64,2}:
  17.0           2.0      3.0          13.0    
  0.0          13.5294  14.2941       -1.05882
  0.0           0.0     -2.93913       5.06957
  5.55112e-16   0.0     -4.44089e-16   4.09024
</code></pre><p>And MATLAB, using the default format:</p><pre><code class=language-matlab>17.0000    2.0000    3.0000   13.0000
      0   13.5294   14.2941   -1.0588
      0         0   -2.9391    5.0696
0.0000         0   -0.0000    4.0902
</code></pre><p>Julia has chosen to align on the decimal point. It&rsquo;s also suppressing trailing zeros, except for the first, giving an odd and false impression of values that have a precise number of significant digits. MATLAB&rsquo;s choice of right alignment is visually superior, and only exact zero gets a special display. True, you might want that exponential notation for the tiny values; you can get it by changing the format.</p><pre><code class=language-matlab>&gt;&gt; format short e
&gt;&gt; U
U =
    1.7000e+01   2.0000e+00   3.0000e+00   1.3000e+01
            0   1.3529e+01   1.4294e+01  -1.0588e+00
            0            0  -2.9391e+00   5.0696e+00
    5.5511e-16            0  -4.4409e-16   4.0902e+00

&gt;&gt; format short g
&gt;&gt; U
U =
            17            2            3           13
            0       13.529       14.294      -1.0588
            0            0      -2.9391       5.0696
    5.5511e-16            0  -4.4409e-16       4.0902
</code></pre><p>It&rsquo;s nice to have options.</p></div><div class=share-box><ul class=share><li><a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Ftobydriscoll.net%2Fblog%2Ftrefethen-bau-matlab-julia-lectures-20-21-23-solving-square-systems%2F&amp;text=Trefethen+%26+Bau+%26+MATLAB+%26+Julia%3A+Lectures+20%2C+21%2C+23%3A+Solving+square+systems" target=_blank rel=noopener class=share-btn-twitter aria-label=twitter><i class="fab fa-twitter"></i></a></li><li><a href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Ftobydriscoll.net%2Fblog%2Ftrefethen-bau-matlab-julia-lectures-20-21-23-solving-square-systems%2F&amp;t=Trefethen+%26+Bau+%26+MATLAB+%26+Julia%3A+Lectures+20%2C+21%2C+23%3A+Solving+square+systems" target=_blank rel=noopener class=share-btn-facebook aria-label=facebook><i class="fab fa-facebook"></i></a></li><li><a href="mailto:?subject=Trefethen%20%26%20Bau%20%26%20MATLAB%20%26%20Julia%3A%20Lectures%2020%2C%2021%2C%2023%3A%20Solving%20square%20systems&amp;body=https%3A%2F%2Ftobydriscoll.net%2Fblog%2Ftrefethen-bau-matlab-julia-lectures-20-21-23-solving-square-systems%2F" target=_blank rel=noopener class=share-btn-email aria-label=envelope><i class="fas fa-envelope"></i></a></li><li><a href="https://www.linkedin.com/shareArticle?url=https%3A%2F%2Ftobydriscoll.net%2Fblog%2Ftrefethen-bau-matlab-julia-lectures-20-21-23-solving-square-systems%2F&amp;title=Trefethen+%26+Bau+%26+MATLAB+%26+Julia%3A+Lectures+20%2C+21%2C+23%3A+Solving+square+systems" target=_blank rel=noopener class=share-btn-linkedin aria-label=linkedin-in><i class="fab fa-linkedin-in"></i></a></li><li><a href="whatsapp://send?text=Trefethen+%26+Bau+%26+MATLAB+%26+Julia%3A+Lectures+20%2C+21%2C+23%3A+Solving+square+systems%20https%3A%2F%2Ftobydriscoll.net%2Fblog%2Ftrefethen-bau-matlab-julia-lectures-20-21-23-solving-square-systems%2F" target=_blank rel=noopener class=share-btn-whatsapp aria-label=whatsapp><i class="fab fa-whatsapp"></i></a></li><li><a href="https://service.weibo.com/share/share.php?url=https%3A%2F%2Ftobydriscoll.net%2Fblog%2Ftrefethen-bau-matlab-julia-lectures-20-21-23-solving-square-systems%2F&amp;title=Trefethen+%26+Bau+%26+MATLAB+%26+Julia%3A+Lectures+20%2C+21%2C+23%3A+Solving+square+systems" target=_blank rel=noopener class=share-btn-weibo aria-label=weibo><i class="fab fa-weibo"></i></a></li></ul></div><div class="media author-card content-widget-hr"><a href=https://tobydriscoll.net/><img class="avatar mr-3 avatar-circle" src=/author/toby-driscoll/avatar_hu87468fbd7d8ed7ca5c1214e0740706c6_930052_270x270_fill_q85_lanczos_center.jpg alt="Toby Driscoll"></a><div class=media-body><h5 class=card-title><a href=https://tobydriscoll.net/>Toby Driscoll</a></h5><h6 class=card-subtitle>Professor of Mathematical Sciences</h6><p class=card-text>My research interests are in scientific computation, mathematical software, and applications of mathematics in the life sciences.</p><ul class=network-icon aria-hidden=true><li><a href=/#contact><i class="fas fa-envelope"></i></a></li><li><a href="https://scholar.google.com/citations?user=V2c1tmAAAAAJ&amp;hl=en" target=_blank rel=noopener><i class="ai ai-google-scholar"></i></a></li><li><a href=https://github.com/tobydriscoll target=_blank rel=noopener><i class="fab fa-github"></i></a></li><li><a href=https://www.youtube.com/channel/UCcDR49dQ8fGiJfF-vAxEDNw target=_blank rel=noopener><i class="fab fa-youtube"></i></a></li><li><a href=https://orcid.org/0000-0002-1490-2545 target=_blank rel=noopener><i class="ai ai-orcid"></i></a></li><li><a href=/media/cv.pdf><i class="ai ai-cv"></i></a></li></ul></div></div></div></article></div><div class=page-footer><div class=container><footer class=site-footer><p class=powered-by>Published with <a href="https://wowchemy.com/?utm_campaign=poweredby" target=_blank rel=noopener>Wowchemy</a> — the free, <a href=https://github.com/wowchemy/wowchemy-hugo-themes target=_blank rel=noopener>open source</a> website builder that empowers creators.</p></footer></div></div><script src=/js/vendor-bundle.min.d26509351aa0ff874abbee824e982e9b.js></script>
<script id=page-data type=application/json>{"use_headroom":true}</script><script src=/js/wowchemy-headroom.db4755770454eb63685f8de785c0a172.js type=module></script>
<script src=/en/js/wowchemy.min.cac6f31121e70d7b5e433048bdeb0af6.js></script><div id=modal class="modal fade" role=dialog><div class=modal-dialog><div class=modal-content><div class=modal-header><h5 class=modal-title>Cite</h5><button type=button class=close data-dismiss=modal aria-label=Close>
<span aria-hidden=true>&#215;</span></button></div><div class=modal-body><pre><code></code></pre></div><div class=modal-footer><a class="btn btn-outline-primary my-1 js-copy-cite" href=# target=_blank><i class="fas fa-copy"></i> Copy</a>
<a class="btn btn-outline-primary my-1 js-download-cite" href=# target=_blank><i class="fas fa-download"></i> Download</a><div id=modal-error></div></div></div></div></div><script src=/js/wowchemy-publication.68f8d7090562ca65fc6d3cb3f8f2d2cb.js type=module></script></body></html>