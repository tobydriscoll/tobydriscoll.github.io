<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Wowchemy 5.7.0 for Hugo"><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload as=style href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media=print onload='this.media="all"'><link rel=stylesheet href=/css/vendor-bundle.min.16f785cdb553c8c4431db6775122af35.css media=print onload='this.media="all"'><link rel=stylesheet href=/css/wowchemy.24595df0c2dd320a6929bb350c13027d.css><link rel=stylesheet href=/css/libs/chroma/github-light.min.css title=hl-light media=print onload='this.media="all"' disabled><link rel=stylesheet href=/css/libs/chroma/dracula.min.css title=hl-dark media=print onload='this.media="all"'><meta name=author content="Toby Driscoll"><meta name=description content="This week&rsquo;s notebooks (MATLAB and Julia&ndash;now all lectures are together for each language) are about least squares polynomial fitting.
The computational parts are almost identical, except for how polynomials are represented."><link rel=alternate hreflang=en-us href=https://tobydriscoll.net/blog/trefethen-bau-matlab-julia-lecture-11-least-squares/><link rel=canonical href=https://tobydriscoll.net/blog/trefethen-bau-matlab-julia-lecture-11-least-squares/><link rel=manifest href=/manifest.webmanifest><link rel=icon type=image/png href=/media/icon_hudca3d2a3171f399896ba920e49ec6cc3_21724_32x32_fill_lanczos_center_3.png><link rel=apple-touch-icon type=image/png href=/media/icon_hudca3d2a3171f399896ba920e49ec6cc3_21724_180x180_fill_lanczos_center_3.png><meta name=theme-color content="#bbdefb"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="https://tobydriscoll.net/media/logo_hueac33246f157bcd904a645b7aca24b63_24178_300x300_fit_lanczos_3.png"><meta property="og:site_name" content="Toby Driscoll"><meta property="og:url" content="https://tobydriscoll.net/blog/trefethen-bau-matlab-julia-lecture-11-least-squares/"><meta property="og:title" content="Trefethen & Bau & MATLAB & Julia, Lecture 11: Least squares | Toby Driscoll"><meta property="og:description" content="This week&rsquo;s notebooks (MATLAB and Julia&ndash;now all lectures are together for each language) are about least squares polynomial fitting.
The computational parts are almost identical, except for how polynomials are represented."><meta property="og:image" content="https://tobydriscoll.net/media/logo_hueac33246f157bcd904a645b7aca24b63_24178_300x300_fit_lanczos_3.png"><meta property="og:locale" content="en-us"><meta property="article:published_time" content="2016-09-28T13:19:16+00:00"><meta property="article:modified_time" content="2016-09-28T13:19:16+00:00"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://tobydriscoll.net/blog/trefethen-bau-matlab-julia-lecture-11-least-squares/"},"headline":"Trefethen \u0026 Bau \u0026 MATLAB \u0026 Julia, Lecture 11: Least squares","datePublished":"2016-09-28T13:19:16Z","dateModified":"2016-09-28T13:19:16Z","author":{"@type":"Person","name":"Toby Driscoll"},"publisher":{"@type":"Organization","name":"Toby Driscoll","logo":{"@type":"ImageObject","url":"https://tobydriscoll.net/media/logo_hueac33246f157bcd904a645b7aca24b63_24178_192x192_fit_lanczos_3.png"}},"description":"This week\u0026rsquo;s notebooks (MATLAB and Julia\u0026ndash;now all lectures are together for each language) are about least squares polynomial fitting.\nThe computational parts are almost identical, except for how polynomials are represented."}</script><title>Trefethen & Bau & MATLAB & Julia, Lecture 11: Least squares | Toby Driscoll</title></head><body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents class="page-wrapper dark" data-wc-page-id=3243adb13e5fe5e3f9b3356b31b3a162><script src=/js/wowchemy-init.min.2a7b4dc7d7846171b6299e17e1f3ac71.js></script><div class="page-header header--fixed"><header><nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id=navbar-main><div class=container-xl><div class="d-none d-lg-inline-flex"><a class=navbar-brand href=/><img src=/media/logo_hueac33246f157bcd904a645b7aca24b63_24178_0x70_resize_lanczos_3.png alt="Toby Driscoll"></a></div><button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-content aria-controls=navbar-content aria-expanded=false aria-label="Toggle navigation">
<span><i class="fas fa-bars"></i></span></button><div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none"><a class=navbar-brand href=/><img src=/media/logo_hueac33246f157bcd904a645b7aca24b63_24178_0x70_resize_lanczos_3.png alt="Toby Driscoll"></a></div><div class="navbar-collapse main-menu-item collapse justify-content-start" id=navbar-content><ul class="navbar-nav d-md-inline-flex"><li class=nav-item><a class=nav-link href=/#about><span>Home</span></a></li><li class=nav-item><a class=nav-link href=/post><span>Posts</span></a></li><li class=nav-item><a class=nav-link href=/publication><span>Publications</span></a></li><li class=nav-item><a class=nav-link href=/tag/book><span>Books</span></a></li><li class=nav-item><a class=nav-link href=/tag/software><span>Software</span></a></li><li class=nav-item><a class=nav-link href=/#contact><span>Contact</span></a></li></ul></div><ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2"></ul></div></nav></header></div><div class=page-body><article class=article><div class="article-container pt-3"><h1>Trefethen & Bau & MATLAB & Julia, Lecture 11: Least squares</h1><div class=article-metadata><span class=article-date>Sep 28, 2016</span>
<span class=middot-divider></span>
<span class=article-reading-time>4 min read</span>
<span class=middot-divider></span>
<span class=article-categories><i class="fas fa-folder mr-1"></i><a href=/category/computing/>computing</a>, <a href=/category/teaching/>teaching</a></span></div></div><div class=article-container><div class=article-style><p>This week&rsquo;s notebooks (<a href=https://gist.github.com/tobydriscoll/8d87997704e9fd400e96ea860d9f6a34#file-tb-lecture-11-ipynb target=_blank rel=noopener>MATLAB</a> and <a href=https://gist.github.com/tobydriscoll/3d9b29d953882738c51c9cabdcaf431b#file-tb-lecture-11-ipynb target=_blank rel=noopener>Julia</a>&ndash;now all lectures are together for each language) are about least squares polynomial fitting.</p><p>The computational parts are almost identical, except for how polynomials are represented. In MATLAB, a vector of coefficients is interpreted as a polynomial in the context of particular functions, such as <code>polyval</code>. The major pain is that the convention is for the coefficients to be ordered from high degree to low, which is almost always the opposite of what you really want. Hence I&rsquo;ve gotten used to writing code like</p><pre><code>p = @(x) polyval( c(end: -1:1), x-1955 );
</code></pre><p>It&rsquo;s not a big deal, but it trips up some students every semester.</p><p>Julia has a full-fledged polynomial type, if you care to add and load the package. And, it expects ordering from the constant term to the highest degree. So I came up with</p><pre><code class=language-julia>p = Poly(c);  
q = t -&gt; p(t-1955);
</code></pre><p>Simple enough, but I find two disappointments. First, it&rsquo;s a bare-bones class. For instance, the second object <code>q</code> above is also a polynomial, but we&rsquo;ll never know it formally, or be able to get its coefficients. A <code>shiftvar</code> method or something similar would be nice. Second, in the effort to clone the MATLAB interface, a potential for serious confusion was introduced. The command <code>p=poly(c)</code>
also works, but (like MATLAB&rsquo;s counterpart) constructs a polynomial whose roots, not coefficients, are given. This is <em>way</em> too easy a mistake to make.</p><p>Another element this time was that I tried using the nascent <a href=https://juliaplots.github.io/ target=_blank rel=noopener>Plots package</a> for Julia. It&rsquo;s an interesting attempt to graft a graceful interface onto the various graphics backends that already exist. I was motivated to try it because AFAIK, the <code>PyPlots</code> package lacks a counterpart to <code>fplot</code> from MATLAB. Perhaps in part because of my time with the <a href=http://www.chebfun.org target=_blank rel=noopener>Chebfun project</a>, I have been putting more emphasis in my teaching on representing functions as such, rather than implicitly as vectors of numbers. It bothers me now, for example, that functions such as <code>interp1</code> and <code>ode45</code> return numbers or structures rather than callable functions, which is what their algorithms should be doing in the deep sense.</p><p>Anyhow, I end up using <code>fplot</code> a lot because of my emphasis on functions, and couldn&rsquo;t find a counterpart in <code>PyPlot</code>. In <code>Plots</code>, however, the <code>plot</code> command handles both numerical and functional arguments alike. Here&rsquo;s a snippet from the notebook:</p><pre><code class=language-julia>p = Poly(c);  
plot( t-&gt;p(t-1955), 1955,2000 )
plot!( year,anomaly, m=:o,l=nothing );
title!(&quot;World temperature anomaly&quot;);
xlabel!(&quot;year&quot;);  ylabel!(&quot;anomaly (deg C)&quot;)
</code></pre><p>Not bad! You can see a couple of quirks though. One is the use of <a href=http://docs.julialang.org/en/release-0.5/manual/functions/#keyword-arguments target=_blank rel=noopener>keyword arguments</a> in line 3; the arguments <code>m=:o</code> and <code>l=nothing</code> respectively set the point markers to circles and the lines connecting points to be suppressed. This takes getting used to, but it&rsquo;s memorable and compact enough.</p><p>The other quirk that you see above is the use of the banged commands like <code>plot!</code> and <code>title!</code>. The bang in Julia is a convention meaning &ldquo;operate in place&rdquo; or &ldquo;overwrite existing.&rdquo; By default, the MATLAB-like commands replace the existing plot, so they have to be banged in order to build on top of it instead. This is a bit dubious in the case of titles and labels––why would I create a new plot by issuing a title?––but it is at least consistent, and, unlike the global state used in MATLAB by the <code>hold</code> command, works the same regardless of context and history.</p><p>One quirk––to me, a bug––that you don&rsquo;t see is that the default in <code>Plots</code> is that every plot creates or adds to a legend. I&rsquo;m not a big fan of plot legends in most contexts, but you&rsquo;re welcome to them if you like them. However, I don&rsquo;t find it reasonable to have one forced on me for a graph with a single curve that I didn&rsquo;t give a label to! I turned off this travesty by starting off with</p><pre><code class=language-julia>using Plots;  pyplot(legend=false);
</code></pre><p>which at least is straightforward, though entangled with my choice of backend.</p></div><div class=share-box><ul class=share><li><a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Ftobydriscoll.net%2Fblog%2Ftrefethen-bau-matlab-julia-lecture-11-least-squares%2F&amp;text=Trefethen+%26+Bau+%26+MATLAB+%26+Julia%2C+Lecture+11%3A+Least+squares" target=_blank rel=noopener class=share-btn-twitter aria-label=twitter><i class="fab fa-twitter"></i></a></li><li><a href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Ftobydriscoll.net%2Fblog%2Ftrefethen-bau-matlab-julia-lecture-11-least-squares%2F&amp;t=Trefethen+%26+Bau+%26+MATLAB+%26+Julia%2C+Lecture+11%3A+Least+squares" target=_blank rel=noopener class=share-btn-facebook aria-label=facebook><i class="fab fa-facebook"></i></a></li><li><a href="mailto:?subject=Trefethen%20%26%20Bau%20%26%20MATLAB%20%26%20Julia%2C%20Lecture%2011%3A%20Least%20squares&amp;body=https%3A%2F%2Ftobydriscoll.net%2Fblog%2Ftrefethen-bau-matlab-julia-lecture-11-least-squares%2F" target=_blank rel=noopener class=share-btn-email aria-label=envelope><i class="fas fa-envelope"></i></a></li><li><a href="https://www.linkedin.com/shareArticle?url=https%3A%2F%2Ftobydriscoll.net%2Fblog%2Ftrefethen-bau-matlab-julia-lecture-11-least-squares%2F&amp;title=Trefethen+%26+Bau+%26+MATLAB+%26+Julia%2C+Lecture+11%3A+Least+squares" target=_blank rel=noopener class=share-btn-linkedin aria-label=linkedin-in><i class="fab fa-linkedin-in"></i></a></li><li><a href="whatsapp://send?text=Trefethen+%26+Bau+%26+MATLAB+%26+Julia%2C+Lecture+11%3A+Least+squares%20https%3A%2F%2Ftobydriscoll.net%2Fblog%2Ftrefethen-bau-matlab-julia-lecture-11-least-squares%2F" target=_blank rel=noopener class=share-btn-whatsapp aria-label=whatsapp><i class="fab fa-whatsapp"></i></a></li><li><a href="https://service.weibo.com/share/share.php?url=https%3A%2F%2Ftobydriscoll.net%2Fblog%2Ftrefethen-bau-matlab-julia-lecture-11-least-squares%2F&amp;title=Trefethen+%26+Bau+%26+MATLAB+%26+Julia%2C+Lecture+11%3A+Least+squares" target=_blank rel=noopener class=share-btn-weibo aria-label=weibo><i class="fab fa-weibo"></i></a></li></ul></div><div class="media author-card content-widget-hr"><a href=https://tobydriscoll.net/><img class="avatar mr-3 avatar-circle" src=/author/toby-driscoll/avatar_hu87468fbd7d8ed7ca5c1214e0740706c6_930052_270x270_fill_q85_lanczos_center.jpg alt="Toby Driscoll"></a><div class=media-body><h5 class=card-title><a href=https://tobydriscoll.net/>Toby Driscoll</a></h5><h6 class=card-subtitle>Professor of Mathematical Sciences</h6><p class=card-text>My research interests are in scientific computation, mathematical software, and applications of mathematics in the life sciences.</p><ul class=network-icon aria-hidden=true><li><a href=/#contact><i class="fas fa-envelope"></i></a></li><li><a href="https://scholar.google.com/citations?user=V2c1tmAAAAAJ&amp;hl=en" target=_blank rel=noopener><i class="ai ai-google-scholar"></i></a></li><li><a href=https://github.com/tobydriscoll target=_blank rel=noopener><i class="fab fa-github"></i></a></li><li><a href=https://www.youtube.com/channel/UCcDR49dQ8fGiJfF-vAxEDNw target=_blank rel=noopener><i class="fab fa-youtube"></i></a></li><li><a href=https://orcid.org/0000-0002-1490-2545 target=_blank rel=noopener><i class="ai ai-orcid"></i></a></li><li><a href=/media/cv.pdf><i class="ai ai-cv"></i></a></li></ul></div></div></div></article></div><div class=page-footer><div class=container><footer class=site-footer><p class=powered-by>Published with <a href="https://wowchemy.com/?utm_campaign=poweredby" target=_blank rel=noopener>Wowchemy</a> — the free, <a href=https://github.com/wowchemy/wowchemy-hugo-themes target=_blank rel=noopener>open source</a> website builder that empowers creators.</p></footer></div></div><script src=/js/vendor-bundle.min.d26509351aa0ff874abbee824e982e9b.js></script>
<script id=page-data type=application/json>{"use_headroom":true}</script><script src=/js/wowchemy-headroom.db4755770454eb63685f8de785c0a172.js type=module></script>
<script src=/en/js/wowchemy.min.cac6f31121e70d7b5e433048bdeb0af6.js></script><div id=modal class="modal fade" role=dialog><div class=modal-dialog><div class=modal-content><div class=modal-header><h5 class=modal-title>Cite</h5><button type=button class=close data-dismiss=modal aria-label=Close>
<span aria-hidden=true>&#215;</span></button></div><div class=modal-body><pre><code></code></pre></div><div class=modal-footer><a class="btn btn-outline-primary my-1 js-copy-cite" href=# target=_blank><i class="fas fa-copy"></i> Copy</a>
<a class="btn btn-outline-primary my-1 js-download-cite" href=# target=_blank><i class="fas fa-download"></i> Download</a><div id=modal-error></div></div></div></div></div><script src=/js/wowchemy-publication.68f8d7090562ca65fc6d3cb3f8f2d2cb.js type=module></script></body></html>