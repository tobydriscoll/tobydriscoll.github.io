<html>
<head>
<title>DoubleIntegrals.html</title>
<!-- Created by Maple 9.00, Linux -->
</head>
<body bgcolor="FFFFFF">
<a name="MapleAutoBookmark1" />
<p align="center"><font size="5"><u><b></font><font size="5" face="Lucida Bright">Double integrals</b></u></font></p>
<p align="left"><table width="100%">
<tr>
<td valign="top"><font color="#ff0000" size="3" face="Monospaced"><b>&gt; </b></font></td>
<td width="100%" valign="top"><font color="#ff0000" size="3" face="Monospaced"><b>restart; with(plots): with(VectorCalculus):</b></font></td>
</tr>
</table></p>
<p align="left"><font color="#0000ff" size="3" face="Monospaced">Warning, the name changecoords has been redefined</font><font color="#0000ff" size="3" face="Monospaced">
<br></font></p>
<p align="left"><font color="#0000ff" size="3" face="Monospaced">Warning, the assigned names &lt;,&gt; and &lt;|&gt; now have a global binding</font><font color="#0000ff" size="3" face="Monospaced">
<br></font></p>
<p align="left"><font color="#0000ff" size="3" face="Monospaced">Warning, these protected names have been redefined and unprotected: *, +, ., D, Vector, diff, int, limit, series</font><font color="#0000ff" size="3" face="Monospaced">
<br></font></p>
<p align="left"><font color="#000000" size="3" face="Lucida Bright">One way of representing a double integral is literally as two nested single integrals. &nbsp;For example, over a rectangle:</font></p>
<p align="left"><table width="100%">
<tr>
<td valign="top"><font color="#ff0000" size="3" face="Monospaced"><b>&gt; </b></font></td>
<td width="100%" valign="top"><font color="#ff0000" size="3" face="Monospaced"><b>I1:= int( 4*x-y^2, y=0..2 );</b></font></td>
</tr>
</table></p>
<p align="center"><font color="#0000ff" face="Lucida Bright"><img src="images/DoubleIntegrals_1.gif" width="71" height="33" alt="I1 := 8*x-8/3" align="center">
</font></p>
<p align="left"><table width="100%">
<tr>
<td valign="top"><font color="#ff0000" size="3" face="Monospaced"><b>&gt; </b></font></td>
<td width="100%" valign="top"><font color="#ff0000" size="3" face="Monospaced"><b>I2:= int( I1, x=0..3 );</b></font></td>
</tr>
</table></p>
<p align="center"><font color="#0000ff" face="Lucida Bright"><img src="images/DoubleIntegrals_2.gif" width="46" height="13" alt="I2 := 28" align="center">
</font></p>
<p align="left"><font color="#000000" size="3" face="Lucida Bright">If you use </font><font color="#000000" size="3" face="Lucida Bright"></font><font color="#000000" size="3" face="Lucida Bright"><b>Int</b></font><font color="#000000" size="3" face="Lucida Bright"> (capitalized), Maple will not evaluate the integral (the "inert" form). &nbsp;This way you can see what is going on.</font></p>
<p align="left"><table width="100%">
<tr>
<td valign="top"><font color="#ff0000" size="3" face="Monospaced"><b>&gt; </b></font></td>
<td width="100%" valign="top"><font color="#ff0000" size="3" face="Monospaced"><b>I1:= Int( 4*x-y^2, y=0..2 );</b></font></td>
</tr>
</table></p>
<p align="center"><font color="#0000ff" face="Lucida Bright"><img src="images/DoubleIntegrals_3.gif" width="119" height="69" alt="I1 := Int(4*x-y^2, y = (0 .. 2))" align="center">
</font></p>
<p align="left"><table width="100%">
<tr>
<td valign="top"><font color="#ff0000" size="3" face="Monospaced"><b>&gt; </b></font></td>
<td width="100%" valign="top"><font color="#ff0000" size="3" face="Monospaced"><b>I2:= Int( I1, x=0..3 );</b></font></td>
</tr>
</table></p>
<p align="center"><font color="#0000ff" face="Lucida Bright"><img src="images/DoubleIntegrals_4.gif" width="160" height="69" alt="I2 := Int(Int(4*x-y^2, y = (0 .. 2)), x = (0 .. 3))" align="center">
</font></p>
<p align="left"><font color="#000000" size="3" face="Lucida Bright">Use </font><font color="#000000" size="3" face="Lucida Bright"></font><font color="#000000" size="3" face="Lucida Bright"><b>value</b></font><font color="#000000" size="3" face="Lucida Bright"> to force Maple to do the evaluation.</font></p>
<p align="left"><table width="100%">
<tr>
<td valign="top"><font color="#ff0000" size="3" face="Monospaced"><b>&gt; </b></font></td>
<td width="100%" valign="top"><font color="#ff0000" size="3" face="Monospaced"><b>value(I2);</b></font></td>
</tr>
</table></p>
<p align="center"><font color="#0000ff" face="Lucida Bright"><img src="images/DoubleIntegrals_5.gif" width="14" height="13" alt="28" align="center">
</font></p>
<p align="left"><font color="#000000" size="3" face="Lucida Bright">To save time for all this, however, the </font><font color="#000000" size="3" face="Lucida Bright"></font><font color="#000000" size="3" face="Lucida Bright"><b>VectorCalculus</b></font><font color="#000000" size="3" face="Lucida Bright"> package defines a special syntax for </font><font color="#000000" size="3" face="Lucida Bright"></font><font color="#000000" size="3" face="Lucida Bright"><b>int</b></font><font color="#000000" size="3" face="Lucida Bright">.</font></p>
<p align="left"><table width="100%">
<tr>
<td valign="top"><font color="#ff0000" size="3" face="Monospaced"><b>&gt; </b></font></td>
<td width="100%" valign="top"><font color="#ff0000" size="3" face="Monospaced"><b>int( 4*x-y^2, [x,y]=Region(0..3,0..2) );</b></font></td>
</tr>
</table></p>
<p align="center"><font color="#0000ff" face="Lucida Bright"><img src="images/DoubleIntegrals_6.gif" width="14" height="13" alt="28" align="center">
</font></p>
<p align="left"><font color="#000000" size="3" face="Lucida Bright">You can also ask for the "inert" form here.</font></p>
<p align="left"><table width="100%">
<tr>
<td valign="top"><font color="#ff0000" size="3" face="Monospaced"><b>&gt; </b></font></td>
<td width="100%" valign="top"><font color="#ff0000" size="3" face="Monospaced"><b>int( 4*x-y^2, [x,y]=Region(0..3,0..2), 'inert' );</b></font></td>
</tr>
</table></p>
<p align="center"><font color="#0000ff" face="Lucida Bright"><img src="images/DoubleIntegrals_7.gif" width="128" height="69" alt="Int(Int(4*x-y^2, y = (0 .. 2)), x = (0 .. 3))" align="center">
</font></p>
<p align="left"><font color="#000000" size="3" face="Lucida Bright">The integrals can be taken with variables in either order. Notice that the "outer" integral is listed </font><font color="#000000" size="3" face="Lucida Bright"></font><font color="#000000" size="3" face="Lucida Bright"><i>first</i></font><font color="#000000" size="3" face="Lucida Bright">.</font></p>
<p align="left"><table width="100%">
<tr>
<td valign="top"><font color="#ff0000" size="3" face="Monospaced"><b>&gt; </b></font></td>
<td width="100%" valign="top"><font color="#ff0000" size="3" face="Monospaced"><b>int( 4*x-y^2, [y,x]=Region(0..2,0..3), 'inert' );</b></font></td>
</tr>
</table></p>
<p align="center"><font color="#0000ff" face="Lucida Bright"><img src="images/DoubleIntegrals_8.gif" width="128" height="69" alt="Int(Int(4*x-y^2, x = (0 .. 3)), y = (0 .. 2))" align="center">
</font></p>
<p align="left"><font color="#000000" size="3" face="Lucida Bright">Maple can also do integrals over nonrectangular regions. &nbsp;Some are predefined for you.</font></p>
<p align="left"><table width="100%">
<tr>
<td valign="top"><font color="#ff0000" size="3" face="Monospaced"><b>&gt; </b></font></td>
<td width="100%" valign="top"><font color="#ff0000" size="3" face="Monospaced"><b>int( x*y, [x,y]=Triangle(&lt;0,0&gt;,&lt;2,0&gt;,&lt;2,1&gt;) );</b></font></td>
</tr>
</table></p>
<p align="center"><font color="#0000ff" face="Lucida Bright"><img src="images/DoubleIntegrals_9.gif" width="7" height="33" alt="1/2" align="center">
</font></p>
<p align="left"><table width="100%">
<tr>
<td valign="top"><font color="#ff0000" size="3" face="Monospaced"><b>&gt; </b></font></td>
<td width="100%" valign="top"><font color="#ff0000" size="3" face="Monospaced"><b>int( 1, [x,y]=Circle(&lt;0,0&gt;,4) );</b></font></td>
</tr>
</table></p>
<p align="center"><font color="#0000ff" face="Lucida Bright"><img src="images/DoubleIntegrals_10.gif" width="25" height="15" alt="16*Pi" align="center">
</font></p>
<p align="left"><font color="#000000" size="3" face="Lucida Bright">More generally you need to work out variable limits on the "inner" integral. &nbsp;For example, to integrate over this region:</font></p>
<p align="left"><table width="100%">
<tr>
<td valign="top"><font color="#ff0000" size="3" face="Monospaced"><b>&gt; </b></font></td>
<td width="100%" valign="top"><font color="#ff0000" size="3" face="Monospaced"><b>implicitplot( {x=exp(y),x=2}, x=0..2, y=0..ln(2) );</b></font></td>
</tr>
</table></p>
<p align="center"><img src="images/DoubleIntegrals_11.gif" width="310" height="214" alt="[Plot]" align="center"></p>
<p align="left"><font color="#000000" size="3" face="Lucida Bright">We see that x varies from the value exp(y) to 2, as y varies from 0 to ln(2). &nbsp;Hence we can use</font></p>
<p align="left"><table width="100%">
<tr>
<td valign="top"><font color="#ff0000" size="3" face="Monospaced"><b>&gt; </b></font></td>
<td width="100%" valign="top"><font color="#ff0000" size="3" face="Monospaced"><b>int( f(x,y), [y,x]=Region(0..ln(2),exp(y)..2) );</b></font></td>
</tr>
</table></p>
<p align="center"><font color="#0000ff" face="Lucida Bright"><img src="images/DoubleIntegrals_12.gif" width="132" height="76" alt="int(int(f(x, y), x = (exp(y) .. 2)), y = (0 .. ln(2)))" align="center">
</font></p>
<p align="left"><font color="#000000" size="3" face="Lucida Bright">An alternative is to do y first.</font></p>
<p align="left"><table width="100%">
<tr>
<td valign="top"><font color="#ff0000" size="3" face="Monospaced"><b>&gt; </b></font></td>
<td width="100%" valign="top"><font color="#ff0000" size="3" face="Monospaced"><b>int( f(x,y), [x,y]=Region(1..2,0..ln(x)) );</b></font></td>
</tr>
</table></p>
<p align="center"><font color="#0000ff" face="Lucida Bright"><img src="images/DoubleIntegrals_13.gif" width="130" height="69" alt="int(int(f(x, y), y = (0 .. ln(x))), x = (1 .. 2))" align="center">
</font></p>
<p align="left"><font color="#000000" size="3" face="Lucida Bright">They have to give the same answer!</font></p>
<p align="left"><table width="100%">
<tr>
<td valign="top"><font color="#ff0000" size="3" face="Monospaced"><b>&gt; </b></font></td>
<td width="100%" valign="top"><font color="#ff0000" size="3" face="Monospaced"><b>eval(%,f(x,y)=x*y^2), eval(%%,f(x,y)=x*y^2);</b></font></td>
</tr>
</table></p>
<p align="center"><font color="#0000ff" face="Lucida Bright"><img src="images/DoubleIntegrals_14.gif" width="325" height="33" alt="2/3*ln(2)^3-ln(2)^2+ln(2)-3/8, 2/3*ln(2)^3-ln(2)^2+ln(2)-3/8" align="center">
</font></p>
<dl><a name="MapleAutoBookmark2" />
<p align="left"><font size="5"><b></font><font size="5" face="Lucida Bright">Polar coordinates</b></font></p>
<p align="left"><font color="#000000" size="3" face="Lucida Bright">From Maple's point of view, there is nothing special about polar integrals. &nbsp;You must remember to put the extra factor of </font><font color="#000000" size="3" face="Lucida Bright"></font><font color="#000000" size="3" face="Lucida Bright">r</font><font color="#000000" size="3" face="Lucida Bright"> in the integrand, and you have to change the limits of integration manually. </font></p>
<p align="left"><font color="#000000" size="3" face="Lucida Bright">For example. consider integrating x^2+y^2 over a quarter-ring domain:</font></p>
<p align="left"><table width="100%">
<tr>
<td valign="top"><font color="#ff0000" size="3" face="Monospaced"><b>&gt; </b></font></td>
<td width="100%" valign="top"><font color="#ff0000" size="3" face="Monospaced"><b>p1:=implicitplot( {x^2+y^2=1,x^2+y^2=4}, x=0..2, y=0..2):</font><font color="#ff0000" size="3" face="Monospaced">
<br>p2:=plot([ [0,t,t=1..2],[t,0,t=1..2]],color=red):</font><font color="#ff0000" size="3" face="Monospaced">
<br>display({p1,p2},scaling=constrained,axes=frame);</b></font></td>
</tr>
</table></p>
<p align="center"><img src="images/DoubleIntegrals_15.gif" width="272" height="248" alt="[Plot]" align="center"></p>
<p align="left"><font color="#000000" size="3" face="Lucida Bright">The most natural form of this is in polar coordinates. Note that we have to insert the extra factor of r.</font></p>
<p align="left"><table width="100%">
<tr>
<td valign="top"><font color="#ff0000" size="3" face="Monospaced"><b>&gt; </b></font></td>
<td width="100%" valign="top"><font color="#ff0000" size="3" face="Monospaced"><b>int( r^2*r, [r,theta]=Region(1..2,0..Pi/2), inert );</b></font></td>
</tr>
</table></p>
<p align="center"><font color="#0000ff" face="Lucida Bright"><img src="images/DoubleIntegrals_16.gif" width="102" height="85" alt="Int(Int(r^3, theta = (0 .. 1/2*Pi)), r = (1 .. 2))" align="center">
</font></p>
<p align="left"><table width="100%">
<tr>
<td valign="top"><font color="#ff0000" size="3" face="Monospaced"><b>&gt; </b></font></td>
<td width="100%" valign="top"><font color="#ff0000" size="3" face="Monospaced"><b>value(%);</b></font></td>
</tr>
</table></p>
<p align="center"><font color="#0000ff" face="Lucida Bright"><img src="images/DoubleIntegrals_17.gif" width="25" height="33" alt="15/8*Pi" align="center">
</font></p>
<p align="left"><font color="#000000" size="3" face="Lucida Bright">We could get the same result more awkwardly in rectangular coordinates by breaking into two pieces.</font></p>
<p align="left"><table width="100%">
<tr>
<td valign="top"><font color="#ff0000" size="3" face="Monospaced"><b>&gt; </b></font></td>
<td width="100%" valign="top"><font color="#ff0000" size="3" face="Monospaced"><b>int( x^2+y^2, [x,y]=Region(0..1,sqrt(1-x^2)..sqrt(4-x^2))) + </font><font color="#ff0000" size="3" face="Monospaced">
<br>int( x^2+y^2, [x,y]=Region(1..2,0..sqrt(4-x^2)));</b></font></td>
</tr>
</table></p>
<p align="center"><font color="#0000ff" face="Lucida Bright"><img src="images/DoubleIntegrals_18.gif" width="647" height="38" alt="1/2*3^(1/2)+13/24*Pi-1/4*3^(1/2)*(2-8/9*Pi*3^(1/2))-9/4*3^(1/2)*(1-16/81*Pi*3^(1/2))-3/2*3^(1/2)*(-2+8/27*Pi*3^(1/2))+9/16*3^(1/2)*(-4/3+32/81*Pi*3^(1/2))" align="center">
</font></p>
<p align="left"><table width="100%">
<tr>
<td valign="top"><font color="#ff0000" size="3" face="Monospaced"><b>&gt; </b></font></td>
<td width="100%" valign="top"><font color="#ff0000" size="3" face="Monospaced"><b>simplify(%);</b></font></td>
</tr>
</table></p>
<p align="center"><font color="#0000ff" face="Lucida Bright"><img src="images/DoubleIntegrals_19.gif" width="25" height="33" alt="15/8*Pi" align="center">
</font></p>
<p align="left"><table width="100%">
<tr>
<td valign="top"><font color="#ff0000" size="3" face="Monospaced"><b>&gt; </b></font></td>
<td width="100%" valign="top"><font color="#ff0000" size="3" face="Monospaced"><b></b></font></td>
</tr>
</table></p>
</dl>
<p></p>
<p></p>
</body>
</html>