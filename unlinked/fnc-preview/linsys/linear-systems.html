
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>2.3. Linear systems &#8212; Fundamentals of Numerical Computation</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/proof.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"TeX": {"Macros": {"float": ["\\mathbb{F}"], "real": ["\\mathbb{R}"], "complex": ["\\mathbb{C}"], "nat": ["\\mathbb{N}"], "integer": ["\\mathbb{Z}"], "rmn{([^}]*)}{([^}]*)}": ["\\mathbb{R}^{#1 \\times #2}", 2], "dd{([^}]*)}{([^}]*)}": ["\\frac{d #1}{d #2}", 2], "ddd{([^}]*)}{([^}]*)}": ["\\frac{d^2 #1}{d #2^2}", 2], "pp{([^}]*)}{([^}]*)}": ["\\frac{\\partial #1}{\\partial #2}", 2], "ppp{([^}]*)}{([^}]*)}": ["\\frac{\\partial^2 #1}{\\partial #2^2}", 2], "ppdd{([^}]*)}{([^}]*)}{([^}]*)}": ["\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}", 3], "norm{([^}]*)}": ["\\| #1 \\|", 1], "twonorm{([^}]*)}": ["\\| #1 \\|_2", 1], "onenorm{([^}]*)}": ["\\| #1 \\|_1", 1], "infnorm{([^}]*)}": ["\\| #1 \\|_\\infty", 1], "anynorm{([^}]*)}{([^}]*)}": ["\\| #1 \\|_#2", 2], "innerprod{([^}]*)}{([^}]*)}": ["\\langle #1,#2 \\rangle", 2], "pr{([^}]*)}": ["^{(#1)}", 1], "kron{([^}]*)}{([^}]*)}": ["#1 \\otimes #2", 2], "eye{([^}]*)}": ["\\mathbf{e}_#1", 1], "meye": ["\\mathbf{I}"], "Qhat": ["\\hat{\\mathbf{Q}}"], "Rhat": ["\\hat{\\mathbf{R}}"], "bfalpha": ["\\mathbf{alpha}"], "bfdelta": ["\\mathbf{delta}"], "bfzero": ["\\boldsymbol{0}"], "macheps": ["\\epsilon_\\text{mach}"], "fl": ["\\operatorname{fl}"], "diag": ["\\operatorname{diag}"], "ign": ["\\operatorname{sign}"], "Re": ["\\operatorname{Re}"], "Im": ["\\operatorname{Im}"], "ee": ["\\times 10^"], "lnorm": ["\\|"], "rnorm": ["\\|"], "floor": ["\\lfloor#1\\rfloor", 1], "cI": ["\\mathcal{I}"], "mtx": ["\\operatorname{mtx}"], "myvec": ["\\operatorname{vec}"], "argmin": ["\\operatorname{argmin}"]}}, "HTML-CSS": {"availableFonts": [], "preferredFont": null, "webfont": "Latin-Modern"}, "tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <link rel="shortcut icon" href="../_static/favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="2.4. LU factorization" href="lu.html" />
    <link rel="prev" title="2.2. Computing with matrices" href="matrices.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      <img src="../_static/logo.svg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Fundamentals of Numerical Computation</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../frontmatter.html">
   Home
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Preface
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../preface.html">
   Preface to the Julia edition
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Main text
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../intro/overview.html">
   1. Introduction
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../intro/floating-point.html">
     1.1. Floating-point numbers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../intro/conditioning.html">
     1.2. Problems and conditioning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../intro/algorithms.html">
     1.3. Algorithms
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../intro/stability.html">
     1.4. Stability
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../intro/next.html">
     1.5. Next steps
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="overview.html">
   2. Linear systems of equations
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="polyinterp.html">
     2.1. Polynomial interpolation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="matrices.html">
     2.2. Computing with matrices
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     2.3. Linear systems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="lu.html">
     2.4. LU factorization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="efficiency.html">
     2.5. Efficiency of matrix computations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="pivoting.html">
     2.6. Row pivoting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="norms.html">
     2.7. Vector and matrix norms
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="condition-number.html">
     2.8. Conditioning of linear systems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="structure.html">
     2.9. Exploiting matrix structure
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="next.html">
     2.10. Next steps
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../leastsq/overview.html">
   3. Overdetermined linear systems
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../leastsq/fitting.html">
     3.1. Fitting functions to data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../leastsq/normaleqns.html">
     3.2. The normal equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../leastsq/qr.html">
     3.3. The QR factorization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../leastsq/house.html">
     3.4. Computing QR factorizations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../leastsq/next.html">
     3.5. Next steps
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../nonlineqn/overview.html">
   4. Roots of nonlinear equations
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../nonlineqn/rootproblem.html">
     4.1. The rootfinding problem
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../nonlineqn/fixed-point.html">
     4.2. Fixed point iteration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../nonlineqn/newton.html">
     4.3. Newton’s method
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../nonlineqn/secant.html">
     4.4. Interpolation-based methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../nonlineqn/newtonsys.html">
     4.5. Newton for nonlinear systems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../nonlineqn/quasinewton.html">
     4.6. Quasi-Newton methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../nonlineqn/nlsq.html">
     4.7. Nonlinear least squares
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../nonlineqn/next.html">
     4.8. Next steps
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../localapprox/overview.html">
   5. Piecewise interpolation
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../localapprox/interpolation.html">
     5.1. The interpolation problem
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../localapprox/pwlin.html">
     5.2. Piecewise linear interpolation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../localapprox/splines.html">
     5.3. Cubic splines
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../localapprox/finitediffs.html">
     5.4. Finite differences
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../localapprox/fd-converge.html">
     5.5. Convergence of finite differences
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../localapprox/integration.html">
     5.6. Numerical integration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../localapprox/adaptive.html">
     5.7. Adaptive integration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../localapprox/next.html">
     5.8. Next steps
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../ivp/overview.html">
   6. Initial-value problems for ODEs
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../ivp/basics.html">
     6.1. Basics of IVPs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ivp/euler.html">
     6.2. Euler’s method
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ivp/systems.html">
     6.3. IVP systems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ivp/rk.html">
     6.4. Runge–Kutta methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ivp/adaptive.html">
     6.5. Adaptive Runge–Kutta
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ivp/multistep.html">
     6.6. Multistep methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ivp/implicit.html">
     6.7. Implementation of multistep methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ivp/zerostability.html">
     6.8. Zero-stability of multistep methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ivp/next.html">
     6.9. Next steps
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../matrixanaly/overview.html">
   7. Matrix analysis
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../matrixanaly/insight.html">
     7.1. From matrix to insight
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../matrixanaly/evd.html">
     7.2. Eigenvalue decomposition
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../matrixanaly/svd.html">
     7.3. Singular value decomposition
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../matrixanaly/symm-eig.html">
     7.4. Symmetry and definiteness
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../matrixanaly/dimreduce.html">
     7.5. Dimension reduction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../matrixanaly/next.html">
     7.6. Next steps
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../krylov/overview.html">
   8. Krylov methods in linear algebra
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../krylov/structure.html">
     8.1. Sparsity and structure
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../krylov/power.html">
     8.2. Power iteration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../krylov/inviter.html">
     8.3. Inverse iteration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../krylov/subspace.html">
     8.4. Krylov subspaces
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../krylov/gmres.html">
     8.5. GMRES
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../krylov/minrescg.html">
     8.6. MINRES and conjugate gradients
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../krylov/matrixfree.html">
     8.7. Matrix-free iterations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../krylov/precond.html">
     8.8. Preconditioning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../krylov/next.html">
     8.9. Next steps
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../globalapprox/overview.html">
   9. Global function approximation
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../globalapprox/polynomial.html">
     9.1. Polynomial interpolation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../globalapprox/barycentric.html">
     9.2. The barycentric formula
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../globalapprox/stability.html">
     9.3. Stability of polynomial interpolation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../globalapprox/orthogonal.html">
     9.4. Orthogonal polynomials
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../globalapprox/trig.html">
     9.5. Trigonometric interpolation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../globalapprox/integration.html">
     9.6. Spectrally accurate integration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../globalapprox/improper.html">
     9.7. Improper integrals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../globalapprox/next.html">
     9.8. Next steps
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../bvp/overview.html">
   10. Boundary-value problems
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../bvp/tpbvp.html">
     10.1. Two-point BVP
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../bvp/shooting.html">
     10.2. Shooting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../bvp/diffmats.html">
     10.3. Differentiation matrices
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../bvp/linear.html">
     10.4. Collocation for linear problems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../bvp/nonlinear.html">
     10.5. Nonlinearity and boundary conditions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../bvp/galerkin.html">
     10.6. The Galerkin method
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../bvp/next.html">
     10.7. Next steps
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../diffusion/overview.html">
   11. Diffusion equations
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../diffusion/blackscholes.html">
     11.1. Black–Scholes equation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../diffusion/methodlines.html">
     11.2. The method of lines
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../diffusion/absstab.html">
     11.3. Absolute stability
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../diffusion/stiffness.html">
     11.4. Stiffness
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../diffusion/boundaries.html">
     11.5. Boundaries
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../diffusion/next.html">
     11.6. Next steps
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../advection/overview.html">
   12. Advection equations
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../advection/traffic.html">
     12.1. Traffic flow
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../advection/upwind.html">
     12.2. Upwinding and stability
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../advection/absstab.html">
     12.3. Absolute stability
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../advection/wave.html">
     12.4. The wave equation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../advection/next.html">
     12.5. Next steps
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../twodim/overview.html">
   13. Two-dimensional problems
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
  <label for="toctree-checkbox-13">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../twodim/tensorprod.html">
     13.1. Tensor-product discretizations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../twodim/diffadv.html">
     13.2. Two-dimensional diffusion and advection
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../twodim/laplace.html">
     13.3. Laplace and Poisson equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../twodim/nonlinear.html">
     13.4. Nonlinear elliptic PDEs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../twodim/next.html">
     13.5. Next steps
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Appendices
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../appendix/linear-algebra.html">
   Review of linear algebra
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../appendix/glossary.html">
   Glossary
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../appendix/julia.html">
   Julia cheatsheet
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../refs.html">
   References
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../genindex.html">
   Index
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        <a class="dropdown-buttons"
            href="../_sources/linsys/linear-systems.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download notebook file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/linsys/linear-systems.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/tobydriscoll/tobydriscoll.github.io/master?urlpath=tree/linsys/linear-systems.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#don-t-use-the-inverse">
   Don’t use the inverse
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#triangular-systems">
   Triangular systems
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#implementation">
   Implementation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercises">
   Exercises
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="linear-systems">
<span id="section-linsys-linear-systems"></span><h1><span class="section-number">2.3. </span>Linear systems<a class="headerlink" href="#linear-systems" title="Permalink to this headline">¶</a></h1>
<p>We now attend to the central problem of this chapter: Given a square, <span class="math notranslate nohighlight">\(n\times n\)</span> matrix <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> and an <span class="math notranslate nohighlight">\(n\)</span>-vector <span class="math notranslate nohighlight">\(\mathbf{b}\)</span>, find an <span class="math notranslate nohighlight">\(n\)</span>-vector <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> such that <span class="math notranslate nohighlight">\(\mathbf{A}\mathbf{x}=\mathbf{b}\)</span>. Writing out these equations, we obtain</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{split}
  A_{11}x_1 + A_{12}x_2 + \cdots + A_{1n}x_n &amp;= b_1 \\
  A_{21}x_1 + A_{22}x_2 + \cdots + A_{2n}x_n &amp;= b_2 \\
  \vdots  \\
  A_{n1}x_1 + A_{n2}x_2 + \cdots + A_{nn}x_n &amp;= b_n.
\end{split}\end{split}\]</div>
<p id="index-0">If <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> is invertible, then the mathematical expression of the solution is <span class="math notranslate nohighlight">\(\mathbf{x}=\mathbf{A}^{-1}\mathbf{b}\)</span>, because</p>
<div class="math notranslate nohighlight">
\[\begin{split}
  \mathbf{A}^{-1}\mathbf{b} = \mathbf{A}^{-1} (\mathbf{A} \mathbf{x}) = (\mathbf{A}^{-1}\mathbf{A}) \mathbf{x} = \mathbf{I} \mathbf{x}
  = \mathbf{x}.
\end{split}\]</div>
<p>When <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> is singular, then <span class="math notranslate nohighlight">\(\mathbf{A}\mathbf{x}=\mathbf{b}\)</span> may have no solution or
infinitely many solutions.</p>
<div class="proof proof-type-example" id="id1">
<span id="example-singmatrix"></span><div class="proof-title"> <span class="proof-type">Example 2.3.1</span>  </div><div class="proof-content">
<p>If we define</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{S} =  \begin{bmatrix}
	0 &amp; 1\\0 &amp; 0
\end{bmatrix},\end{split}\]</div>
<p>then it is easy to check that for any real value of <span class="math notranslate nohighlight">\(\alpha\)</span> we have</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{S}
\begin{bmatrix}
	\alpha \\ 1
\end{bmatrix}
=
\begin{bmatrix}
	1 \\ 0
\end{bmatrix}.\end{split}\]</div>
<p>Hence the linear system <span class="math notranslate nohighlight">\(\mathbf{S}\mathbf{x}=\mathbf{b}\)</span> with <span class="math notranslate nohighlight">\(\mathbf{b}=\begin{bmatrix} 1\\0\end{bmatrix}\)</span> has infinitely many solutions. For most other choices of <span class="math notranslate nohighlight">\(\mathbf{b}\)</span> the system has no solution.</p>
</div></div><div class="section" id="don-t-use-the-inverse">
<h2>Don’t use the inverse<a class="headerlink" href="#don-t-use-the-inverse" title="Permalink to this headline">¶</a></h2>
<p>Matrix inverses are indispensable for mathematical discussion and derivations. However, as you may remember from a linear algebra course, they are not trivial to compute from the entries of the original matrix. Julia does have a command <code class="docutils literal notranslate"><span class="pre">inv</span></code> that finds the inverse of a matrix, but it is almost never the best means to solving a problem. In particular, for solving a linear system of equations, finding the inverse is slower than the standard algorithm.</p>
<p id="index-1">As demonstrated in <a class="reference internal" href="polyinterp.html#demo-interp-vander"><span class="std std-numref">Demo 2.1.3</span></a>, a linear system of equations can be solved by a <code class="docutils literal notranslate"><span class="pre">backslash</span></code>  (the <code class="docutils literal notranslate"><span class="pre">\</span></code> symbol, not to be confused with the slash <code class="docutils literal notranslate"><span class="pre">/</span></code> used in web addresses).</p>
<div class="proof proof-type-demo" id="id2">
<span id="demo-systems-backslash"></span><div class="proof-title"> <span class="proof-type">Demo 2.3.2</span>  </div><div class="proof-content">
</div></div><div class='demo'><p>For a square matrix <span class="math notranslate nohighlight">\(A\)</span>, the command <code class="docutils literal notranslate"><span class="pre">A\b</span></code> is mathematically equivalent to <span class="math notranslate nohighlight">\(A^{-1}b\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="mi">0</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="mi">2</span> <span class="mi">2</span> <span class="mi">1</span><span class="p">;</span> <span class="o">-</span><span class="mi">1</span> <span class="o">-</span><span class="mi">3</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3×3 Matrix{Int64}:
  1   0  -1
  2   2   1
 -1  -3   0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3-element Vector{Int64}:
 1
 2
 3
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">A</span><span class="o">\</span><span class="n">b</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3-element Vector{Float64}:
  2.1428571428571432
 -1.7142857142857144
  1.1428571428571428
</pre></div>
</div>
</div>
</div>
<p id="index-2">One way to check the answer is to compute a quantity known as the <strong>residual</strong>. It is (ideally) close to machine precision (relative to the elements in the solution).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">residual</span> <span class="o">=</span> <span class="n">b</span> <span class="o">-</span> <span class="n">A</span><span class="o">*</span><span class="n">x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3-element Vector{Float64}:
 -4.440892098500626e-16
 -4.440892098500626e-16
  0.0
</pre></div>
</div>
</div>
</div>
<p>If the matrix <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> is singular, you may get an error.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="mi">1</span><span class="p">;</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">A</span><span class="o">\</span><span class="n">b</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span>LAPACKException(1)

Stacktrace:
 [1] chklapackerror(ret::Int64)
   @ LinearAlgebra.LAPACK /Users/julia/buildbot/worker/package_macos64/build/usr/share/julia/stdlib/v1.6/LinearAlgebra/src/lapack.jl:38
 [2] trtrs!(uplo::Char, trans::Char, diag::Char, A::Matrix{Float64}, B::Vector{Float64})
   @ LinearAlgebra.LAPACK /Users/julia/buildbot/worker/package_macos64/build/usr/share/julia/stdlib/v1.6/LinearAlgebra/src/lapack.jl:3426
 [3] ldiv!
   @ /Users/julia/buildbot/worker/package_macos64/build/usr/share/julia/stdlib/v1.6/LinearAlgebra/src/triangular.jl:739 [inlined]
 [4] \(A::UpperTriangular{Int64, Matrix{Int64}}, B::Vector{Int64})
   @ LinearAlgebra /Users/julia/buildbot/worker/package_macos64/build/usr/share/julia/stdlib/v1.6/LinearAlgebra/src/triangular.jl:1673
 [5] \(A::Matrix{Int64}, B::Vector{Int64})
   @ LinearAlgebra /Users/julia/buildbot/worker/package_macos64/build/usr/share/julia/stdlib/v1.6/LinearAlgebra/src/generic.jl:1134
 [6] top-level scope
   @ In[6]:3
 [7] eval
   @ ./boot.jl:360 [inlined]
 [8] include_string(mapexpr::typeof(REPL.softscope), mod::Module, code::String, filename::String)
   @ Base ./loading.jl:1094
</pre></div>
</div>
</div>
</div>
<div class="sphinx-bs container pb-4 docutils">
<div class="row docutils">
<div class="d-flex col-7 left-side docutils">
<div class="card w-100 border-0 shadow-none docutils">
<div class="card-body docutils">
<p class="card-text">The error message here is admittedly cryptic. In this case we can check that the rank of <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> is less than its number of columns, indicating singularity.</p>
</div>
</div>
</div>
<div class="d-flex col-5 right-side docutils">
<div class="card w-100 shadow-none comment docutils">
<div class="card-body docutils">
<p class="card-text">The function <code class="docutils literal notranslate"><span class="pre">rank</span></code> computes the rank of a matrix. However, it is numerically unstable for matrices that are nearly singular, in a sense to be defined in a later section.</p>
</div>
</div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">rank</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1
</pre></div>
</div>
</div>
</div>
<p>A linear system with a singular matrix might have no solution or infinitely many solutions, but in either case, backslash will fail. Moreover, detecting singularity is a lot like checking whether two floating-point numbers are <em>exactly</em> equal: because of roundoff, it could be missed. In <a class="reference internal" href="condition-number.html#section-linsys-condition-number"><span class="std std-numref">Section 2.8</span></a> we’ll find a robust way to fully describe the situation.</p>
</div></div>
<div class="section" id="triangular-systems">
<h2>Triangular systems<a class="headerlink" href="#triangular-systems" title="Permalink to this headline">¶</a></h2>
<p id="index-3">The solution process is especially easy to demonstrate for a system with a <strong>triangular matrix</strong>. For example, consider the lower triangular system</p>
<div class="math notranslate nohighlight">
\[\begin{split}  \begin{bmatrix}
    4 &amp; 0 &amp; 0 &amp; 0 \\
    3 &amp; -1 &amp; 0 &amp; 0 \\
    -1 &amp; 0 &amp; 3 &amp; 0 \\
    1 &amp; -1 &amp; -1 &amp; 2
  \end{bmatrix} \mathbf{x} =
  \begin{bmatrix}
    8 \\ 5 \\ 0 \\ 1
  \end{bmatrix}.\end{split}\]</div>
<p>The first row of this system states simply that <span class="math notranslate nohighlight">\(4x_1=8\)</span>, which is easily solved as <span class="math notranslate nohighlight">\(x_1=8/4=2\)</span>. Now, the second row states that <span class="math notranslate nohighlight">\(3x_1-x_2=5\)</span>. As <span class="math notranslate nohighlight">\(x_1\)</span> is already known, it can be replaced to find that <span class="math notranslate nohighlight">\(x_2 = -(5-3\cdot 2)=1\)</span>. Similarly, the third row gives <span class="math notranslate nohighlight">\(x_3=(0+1\cdot 2)/3 = 2/3\)</span>, and the last row yields <span class="math notranslate nohighlight">\(x_4=(1-1\cdot 2 + 1\cdot 1 + 1\cdot 2/3)/2 = 1/3\)</span>. Hence the solution is</p>
<div class="math notranslate nohighlight">
\[\begin{split}  \mathbf{x} =
  \begin{bmatrix} 2 \\ 1 \\ 2/3 \\ 1/3
  \end{bmatrix}.\end{split}\]</div>
<p id="index-4">The process just described is called <strong>forward substitution</strong>. In the <span class="math notranslate nohighlight">\(4\times 4\)</span> lower triangular case of <span class="math notranslate nohighlight">\(\mathbf{L}\mathbf{x}=\mathbf{b}\)</span> it leads to the formulas</p>
<div class="math notranslate nohighlight" id="equation-forwardsub">
<span class="eqno">(2.3.1)<a class="headerlink" href="#equation-forwardsub" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{split}
  x_1 &amp;= \frac{b_1}{L_{11}} \\
  x_2 &amp;= \frac{b_2 - L_{21}x_1}{L_{22}} \\
  x_3 &amp;= \frac{b_3 - L_{31}x_1 - L_{32}x_2}{L_{33}} \\
  x_4 &amp;= \frac{b_4 - L_{41}x_1 - L_{42}x_2 - L_{43}x_3}{L_{44}}.
\end{split}\end{split}\]</div>
<p id="index-5">For upper triangular systems <span class="math notranslate nohighlight">\(\mathbf{U}\mathbf{x}=\mathbf{b}\)</span> an analogous process of <strong>backward substitution</strong> begins by solving for the last component <span class="math notranslate nohighlight">\(x_n=b_n/U_{nn}\)</span> and working backward. For the <span class="math notranslate nohighlight">\(4\times 4\)</span> case we have</p>
<div class="math notranslate nohighlight">
\[\begin{split}  \begin{bmatrix}
    U_{11} &amp; U_{12} &amp; U_{13} &amp; U_{14} \\
    0 &amp; U_{22} &amp; U_{23} &amp; U_{24} \\
    0 &amp; 0 &amp; U_{33} &amp; U_{34} \\
    0 &amp; 0 &amp; 0 &amp; U_{44}
  \end{bmatrix} \mathbf{x} =
  \begin{bmatrix}
    b_1 \\ b_2 \\ b_3 \\ b_4
  \end{bmatrix}.\end{split}\]</div>
<p>Solving the system backward, starting with <span class="math notranslate nohighlight">\(x_4\)</span> first and then proceeding in descending order, gives</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{split}
  x_4 &amp;= \frac{b_4}{U_{44}} \\
  x_3 &amp;= \frac{b_3 - U_{34}x_4}{U_{33}} \\
  x_2 &amp;= \frac{b_2 - U_{23}x_3 - U_{24}x_4}{U_{22}} \\
  x_1 &amp;= \frac{b_1 - U_{12}x_2 - U_{13}x_3 - U_{14}x_4}{U_{11}}.
\end{split}\end{split}\]</div>
<p>It should be clear that forward or backward substitution fails if, and only if, one of the diagonal entries of the system matrix is zero. We have essentially proved the following theorem.</p>
<div class="proof proof-type-theorem" id="id3">
<span id="theorem-triangle-invert"></span><div class="proof-title"> <span class="proof-type">Theorem 2.3.3</span>  <span class="proof-title-name">: &nbsp;Triangular singularity</span>  </div><div class="proof-content">
<p>A triangular matrix is singular if and only if at least one of its diagonal elements is zero.</p>
</div></div></div>
<div class="section" id="implementation">
<h2>Implementation<a class="headerlink" href="#implementation" title="Permalink to this headline">¶</a></h2>
<p>Consider how to implement the sequential process implied by equation <a class="reference internal" href="#equation-forwardsub">(2.3.1)</a>. It seems clear that we want to loop through the elements of <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> in order. Within each iteration of that loop, we have an expression whose length depends on the iteration number. One way we could do this would be with a nested loop:</p>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="mi">1</span><span class="o">:</span><span class="mi">4</span>
    <span class="n">s</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">j</span> <span class="k">in</span> <span class="mi">1</span><span class="o">:</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
    <span class="k">end</span>
    <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">s</span><span class="p">)</span> <span class="o">/</span> <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">]</span>
<span class="k">end</span>
</pre></div>
</div>
<p id="index-6">A briefer version of the inner loop over <code class="docutils literal notranslate"><span class="pre">j</span></code> is the expression</p>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">sum</span><span class="p">(</span> <span class="n">L</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="k">in</span> <span class="mi">1</span><span class="o">:</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span> <span class="p">)</span>
</pre></div>
</div>
<p>However, when <code class="docutils literal notranslate"><span class="pre">i</span></code> equals 1, the range <code class="docutils literal notranslate"><span class="pre">1:i-1</span></code> is empty and the sum causes an error. To avoid this we can handle this case before the <code class="docutils literal notranslate"><span class="pre">i</span></code> loop begins, and start that loop at 2. This is the approach taken in <a class="reference internal" href="#function-forwardsub"><span class="std std-numref">Function 2.3.4</span></a>.</p>
<div class="proof proof-type-function" id="id4">
<span id="function-forwardsub"></span><div class="proof-title"> <span class="proof-type">Function 2.3.4</span>  <span class="proof-title-name">: &nbsp;forwardsub</span>  </div><div class="proof-content">
<p><strong>Forward substitution to solve a lower-triangular linear system</strong></p>
<div class="highlight-julia1 notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="s">&quot;&quot;&quot;</span>
<span class="s">    forwardsub(L,b)</span>

<span class="s">Solve the lower-triangular linear system with matrix `L` and</span>
<span class="s">right-hand side vector `b`.</span>
<span class="s">&quot;&quot;&quot;</span>
<span class="k">function</span> <span class="nf">forwardsub</span><span class="p">(</span><span class="nv">L</span><span class="p">,</span><span class="nv">b</span><span class="p">)</span>
    <span class="nv">n</span> <span class="o">=</span> <span class="nb">size</span><span class="p">(</span><span class="nv">L</span><span class="p">,</span><span class="m">1</span><span class="p">)</span>
    <span class="nv">x</span> <span class="o">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="nv">n</span><span class="p">)</span>
    <span class="nv">x</span><span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="o">=</span> <span class="nv">b</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="o">/</span><span class="nv">L</span><span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">]</span>
    <span class="k">for</span> <span class="nv">i</span> <span class="k">in</span> <span class="m">2</span><span class="o">:</span><span class="nv">n</span>
        <span class="nv">s</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span> <span class="nv">L</span><span class="p">[</span><span class="nv">i</span><span class="p">,</span><span class="nv">j</span><span class="p">]</span><span class="o">*</span><span class="nv">x</span><span class="p">[</span><span class="nv">j</span><span class="p">]</span> <span class="k">for</span> <span class="nv">j</span> <span class="k">in</span> <span class="m">1</span><span class="o">:</span><span class="nv">i</span><span class="o">-</span><span class="m">1</span> <span class="p">)</span>
        <span class="nv">x</span><span class="p">[</span><span class="nv">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span> <span class="nv">b</span><span class="p">[</span><span class="nv">i</span><span class="p">]</span> <span class="o">-</span> <span class="nv">s</span> <span class="p">)</span> <span class="o">/</span> <span class="nv">L</span><span class="p">[</span><span class="nv">i</span><span class="p">,</span><span class="nv">i</span><span class="p">]</span>
    <span class="k">end</span>
    <span class="k">return</span> <span class="nv">x</span>
<span class="k">end</span>
</pre></div>
</td></tr></table></div>
</div></div><p>The implementation of backward substitution is much like forward substitution and is given in <a class="reference internal" href="#function-backsub"><span class="std std-numref">Function 2.3.5</span></a>.</p>
<div class="proof proof-type-function" id="id5">
<span id="function-backsub"></span><div class="proof-title"> <span class="proof-type">Function 2.3.5</span>  <span class="proof-title-name">: &nbsp;backsub</span>  </div><div class="proof-content">
<p><strong>Backward substitution to solve an upper-triangular linear system</strong></p>
<div class="highlight-julia1 notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="s">&quot;&quot;&quot;</span>
<span class="s">    backsub(U,b)</span>

<span class="s">Solve the upper-triangular linear system with matrix `U` and</span>
<span class="s">right-hand side vector `b`.</span>
<span class="s">&quot;&quot;&quot;</span>
<span class="k">function</span> <span class="nf">backsub</span><span class="p">(</span><span class="nv">U</span><span class="p">,</span><span class="nv">b</span><span class="p">)</span>
    <span class="nv">n</span> <span class="o">=</span> <span class="nb">size</span><span class="p">(</span><span class="nv">U</span><span class="p">,</span><span class="m">1</span><span class="p">)</span>
    <span class="nv">x</span> <span class="o">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="nv">n</span><span class="p">)</span>
    <span class="nv">x</span><span class="p">[</span><span class="nv">n</span><span class="p">]</span> <span class="o">=</span> <span class="nv">b</span><span class="p">[</span><span class="nv">n</span><span class="p">]</span><span class="o">/</span><span class="nv">U</span><span class="p">[</span><span class="nv">n</span><span class="p">,</span><span class="nv">n</span><span class="p">]</span>
    <span class="k">for</span> <span class="nv">i</span> <span class="k">in</span> <span class="nv">n</span><span class="o">-</span><span class="m">1</span><span class="o">:-</span><span class="m">1</span><span class="o">:</span><span class="m">1</span>
        <span class="nv">s</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span> <span class="nv">U</span><span class="p">[</span><span class="nv">i</span><span class="p">,</span><span class="nv">j</span><span class="p">]</span><span class="o">*</span><span class="nv">x</span><span class="p">[</span><span class="nv">j</span><span class="p">]</span> <span class="k">for</span> <span class="nv">j</span> <span class="k">in</span> <span class="nv">i</span><span class="o">+</span><span class="m">1</span><span class="o">:</span><span class="nv">n</span> <span class="p">)</span>
        <span class="nv">x</span><span class="p">[</span><span class="nv">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span> <span class="nv">b</span><span class="p">[</span><span class="nv">i</span><span class="p">]</span> <span class="o">-</span> <span class="nv">s</span> <span class="p">)</span> <span class="o">/</span> <span class="nv">U</span><span class="p">[</span><span class="nv">i</span><span class="p">,</span><span class="nv">i</span><span class="p">]</span>
    <span class="k">end</span>
    <span class="k">return</span> <span class="nv">x</span>
<span class="k">end</span>
</pre></div>
</td></tr></table></div>
</div></div><div class="proof proof-type-demo" id="id6">
<span id="demo-systems-triangular"></span><div class="proof-title"> <span class="proof-type">Demo 2.3.6</span>  </div><div class="proof-content">
</div></div><div class='demo'><div class="sphinx-bs container pb-4 docutils" id="index-7">
<div class="row docutils">
<div class="d-flex col-7 left-side docutils">
<div class="card w-100 border-0 shadow-none docutils">
<div class="card-body docutils">
<p class="card-text">It’s easy to get just the lower triangular part of any matrix using the <code class="docutils literal notranslate"><span class="pre">tril</span></code> function.</p>
</div>
</div>
</div>
<div class="d-flex col-5 right-side docutils">
<div class="card w-100 shadow-none comment docutils">
<div class="card-body docutils">
<p class="card-text">Use <code class="docutils literal notranslate"><span class="pre">tril</span></code> to return a matrix that zeros out everything above the main diagonal. The <code class="docutils literal notranslate"><span class="pre">triu</span></code> function zeros out below the diagonal.</p>
</div>
</div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">rand</span><span class="p">(</span><span class="mf">1.</span><span class="o">:</span><span class="mf">9.</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="n">L</span> <span class="o">=</span> <span class="n">tril</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5×5 Matrix{Float64}:
 6.0  0.0  0.0  0.0  0.0
 1.0  3.0  0.0  0.0  0.0
 8.0  5.0  5.0  0.0  0.0
 9.0  7.0  1.0  4.0  0.0
 4.0  5.0  1.0  8.0  4.0
</pre></div>
</div>
</div>
</div>
<p>We’ll set up and solve a linear system with this matrix.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">ones</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">FNC</span><span class="o">.</span><span class="n">forwardsub</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5-element Vector{Float64}:
  0.16666666666666666
  0.2777777777777778
 -0.34444444444444444
 -0.525
  0.8722222222222223
</pre></div>
</div>
</div>
</div>
<p>It’s not clear how accurate this answer is. However, the residual, while not zero, is comparable to <span class="math notranslate nohighlight">\(\macheps\)</span> in size, as we would hope.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">-</span> <span class="n">L</span><span class="o">*</span><span class="n">x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5-element Vector{Float64}:
 0.0
 0.0
 0.0
 0.0
 0.0
</pre></div>
</div>
</div>
</div>
<div class="sphinx-bs container pb-4 docutils" id="index-8">
<div class="row docutils">
<div class="d-flex col-7 left-side docutils">
<div class="card w-100 border-0 shadow-none docutils">
<div class="card-body docutils">
<p class="card-text">Next we’ll engineer a problem to which we know the exact answer. Use <code class="docutils literal notranslate"><span class="pre">\alpha</span></code> <kbd>Tab</kbd> and <code class="docutils literal notranslate"><span class="pre">\beta</span></code> <kbd>Tab</kbd> to get the Greek letters.</p>
</div>
</div>
</div>
<div class="d-flex col-5 right-side docutils">
<div class="card w-100 shadow-none comment docutils">
<div class="card-body docutils">
<p class="card-text">The notation <code class="docutils literal notranslate"><span class="pre">0=&gt;ones(5)</span></code> creates a <code class="docutils literal notranslate"><span class="pre">Pair</span></code>. In <code class="docutils literal notranslate"><span class="pre">diagm</span></code>, pairs indicate the position of a diagonal and the elements that are to be placed on it.</p>
</div>
</div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">α</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">;</span>
<span class="n">β</span> <span class="o">=</span> <span class="mf">2.2</span><span class="p">;</span>
<span class="n">U</span> <span class="o">=</span> <span class="n">diagm</span><span class="p">(</span> <span class="mi">0</span><span class="o">=&gt;</span><span class="n">ones</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="mi">1</span><span class="o">=&gt;</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span>
<span class="n">U</span><span class="p">[</span><span class="mi">1</span><span class="p">,[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span> <span class="n">α</span><span class="o">-</span><span class="n">β</span><span class="p">,</span> <span class="n">β</span> <span class="p">]</span>
<span class="n">U</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5×5 Matrix{Float64}:
 1.0  -1.0   0.0  -1.9   2.2
 0.0   1.0  -1.0   0.0   0.0
 0.0   0.0   1.0  -1.0   0.0
 0.0   0.0   0.0   1.0  -1.0
 0.0   0.0   0.0   0.0   1.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">x_exact</span> <span class="o">=</span> <span class="n">ones</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="n">α</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5-element Vector{Float64}:
 0.3
 0.0
 0.0
 0.0
 1.0
</pre></div>
</div>
</div>
</div>
<p>Now we use backward substitution to solve for <code class="docutils literal notranslate"><span class="pre">x</span></code>, and compare to the exact solution we know already.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">FNC</span><span class="o">.</span><span class="n">backsub</span><span class="p">(</span><span class="n">U</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
<span class="n">err</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">x_exact</span>
</pre></div>
</div>
<p>Everything seems OK here. But another example, with a different value for <span class="math notranslate nohighlight">\(\beta\)</span>, is more troubling.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">α</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">;</span>
<span class="n">β</span> <span class="o">=</span> <span class="mf">1e12</span><span class="p">;</span>
<span class="n">U</span> <span class="o">=</span> <span class="n">diagm</span><span class="p">(</span> <span class="mi">0</span><span class="o">=&gt;</span><span class="n">ones</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="mi">1</span><span class="o">=&gt;</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span>
<span class="n">U</span><span class="p">[</span><span class="mi">1</span><span class="p">,[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span> <span class="n">α</span><span class="o">-</span><span class="n">β</span><span class="p">,</span> <span class="n">β</span> <span class="p">]</span>
<span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="n">α</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">FNC</span><span class="o">.</span><span class="n">backsub</span><span class="p">(</span><span class="n">U</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
<span class="n">err</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">x_exact</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5-element Vector{Float64}:
 -4.882812499995559e-5
  0.0
  0.0
  0.0
  0.0
</pre></div>
</div>
</div>
</div>
<p>It’s not so good to get four digits of accuracy after starting with sixteen! The source of the error is not hard to track down. Solving for <span class="math notranslate nohighlight">\(x_1\)</span> performs <span class="math notranslate nohighlight">\((\alpha-\beta)+\beta\)</span> in the first row. Since <span class="math notranslate nohighlight">\(|\alpha|\)</span> is so much smaller than <span class="math notranslate nohighlight">\(|\beta|\)</span>, this a recipe for losing digits to subtractive cancellation.</p>
</div><p>The example in <a class="reference internal" href="#demo-systems-triangular"><span class="std std-numref">Demo 2.3.6</span></a> is our first clue that linear system problems may have large condition numbers, making inaccurate solutions inevitable in floating-point arithmetic. We will learn how to spot such problems in <a class="reference internal" href="condition-number.html#section-linsys-condition-number"><span class="std std-numref">Section 2.8</span></a>. Before reaching that point, however, we need to discuss how to solve general linear systems, not just triangular ones.</p>
</div>
<div class="section" id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">¶</a></h2>
<ol>
<li><p>✍ Find a vector <span class="math notranslate nohighlight">\(\mathbf{b}\)</span> such that the system <span class="math notranslate nohighlight">\(\begin{bmatrix} 0&amp;1\\0&amp;0 \end{bmatrix} \mathbf{x}=\mathbf{b}\)</span> has no solution.</p>
</li>
<li id="problem-linear-systems-triangular"><p>✍ Solve the following triangular systems by hand.</p>
<p><strong>(a)</strong> <span class="math notranslate nohighlight">\(\displaystyle \begin{aligned}
   -2x_1  &amp;= -4 \\
     x_1  - x_2        &amp;= 2 \\
    3x_1 + 2x_2  + x_3 &amp;= 1
   \end{aligned} \quad\)</span>
<strong>(b)</strong> <span class="math notranslate nohighlight">\(\displaystyle \begin{bmatrix}
     4 &amp; 0 &amp; 0 &amp; 0 \\
     1 &amp; -2 &amp; 0 &amp; 0 \\
     -1 &amp; 4 &amp; 4 &amp; 0 \\
     2 &amp; -5 &amp; 5 &amp; 1
   \end{bmatrix} \mathbf{x} = \begin{bmatrix}
     -4 \\ 1 \\ -3 \\ 5
   \end{bmatrix}\quad\)</span>
<strong>(c)</strong> <span class="math notranslate nohighlight">\(\displaystyle \begin{aligned}
    3x_1 +  2x_2  +  x_3      &amp;= 1 \\
            x_2   -  x_3      &amp;= 2 \\
                     2 x_3    &amp;= -4
   \end{aligned}\)</span></p>
</li>
<li><p>⌨ Use <a class="reference internal" href="#function-forwardsub"><span class="std std-numref">Function 2.3.4</span></a> or <a class="reference internal" href="#function-backsub"><span class="std std-numref">Function 2.3.5</span></a> to solve each system from the preceding exercise. Verify that the solution is correct by computing <span class="math notranslate nohighlight">\(\mathbf{L}\mathbf{x}\)</span> and subtracting <span class="math notranslate nohighlight">\(\mathbf{b}\)</span>.</p></li>
<li><p>⌨  Use <a class="reference internal" href="#function-backsub"><span class="std std-numref">Function 2.3.5</span></a> to solve the following systems.  Verify that the solution is correct by computing <span class="math notranslate nohighlight">\(\mathbf{U}\mathbf{x}\)</span> and subtracting <span class="math notranslate nohighlight">\(\mathbf{b}\)</span>.</p>
<p><strong>(a)</strong> <span class="math notranslate nohighlight">\(\;\begin{bmatrix}
   3 &amp; 1 &amp; 0  \\
   0 &amp; -1 &amp; -2  \\
   0 &amp; 0 &amp; 3  \\
 \end{bmatrix} \mathbf{x} = \begin{bmatrix}
   1 \\ 1 \\ 6
 \end{bmatrix}\qquad\)</span>
<strong>(b)</strong> <span class="math notranslate nohighlight">\(\;\begin{bmatrix}
   3 &amp; 1 &amp; 0 &amp; 6 \\
   0 &amp; -1 &amp; -2 &amp; 7 \\
   0 &amp; 0 &amp; 3 &amp; 4 \\
   0 &amp; 0 &amp; 0 &amp; 5
 \end{bmatrix} \mathbf{x} = \begin{bmatrix}
   4 \\ 1 \\ 1 \\ 5
 \end{bmatrix}\)</span></p>
</li>
<li id="problem-linear-systems-lumpstring"><p>Suppose a string is stretched with tension <span class="math notranslate nohighlight">\(\tau\)</span> horizontally between two anchors at <span class="math notranslate nohighlight">\(x=0\)</span> and <span class="math notranslate nohighlight">\(x=1\)</span>. At each of the <span class="math notranslate nohighlight">\(n-1\)</span> equally spaced positions <span class="math notranslate nohighlight">\(x_k=k/n\)</span>, <span class="math notranslate nohighlight">\(k=1,\ldots,n-1\)</span>, we attach a little mass <span class="math notranslate nohighlight">\(m_i\)</span> and allow the string to come to equilibrium. This causes vertical displacement of the string. Let <span class="math notranslate nohighlight">\(q_k\)</span> be the amount of displacement at <span class="math notranslate nohighlight">\(x_k\)</span>. If the displacements are not too large, then an approximate force balance equation is</p>
<div class="math notranslate nohighlight">
\[n \tau (q_k - q_{k-1}) + n\tau (q_k - q_{k+1}) =
m_k g, \qquad k=1,\ldots,n-1,\]</div>
<p>where <span class="math notranslate nohighlight">\(g=-9.8\)</span> m/s<span class="math notranslate nohighlight">\(^2\)</span> is the acceleration due to gravity, and we define <span class="math notranslate nohighlight">\(q_0=0\)</span> and <span class="math notranslate nohighlight">\(q_n=0\)</span> due to the anchors. This defines a linear system for <span class="math notranslate nohighlight">\(q_1,\ldots,q_{n-1}\)</span>.</p>
<p><strong>(a)</strong> ✍ Show that the force balance equations can be written as a linear system <span class="math notranslate nohighlight">\(\mathbf{A}\mathbf{q}=\mathbf{f}\)</span>, where <span class="math notranslate nohighlight">\(\mathbf{q}\)</span> is a vector of the unknown displacements and <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> is a tridiagonal matrix, i.e., <span class="math notranslate nohighlight">\(A_{ij}=0\)</span> if <span class="math notranslate nohighlight">\(|i-j|&gt;1\)</span>) of size <span class="math notranslate nohighlight">\((n-1)\times(n-1)\)</span>.</p>
<p><strong>(b)</strong> ⌨  Let <span class="math notranslate nohighlight">\(\tau=10\)</span> N, and <span class="math notranslate nohighlight">\(m_k=(1/10n)\)</span> kg for every <span class="math notranslate nohighlight">\(k\)</span>. Using backslash, find the displacements when <span class="math notranslate nohighlight">\(n=8\)</span> and <span class="math notranslate nohighlight">\(n=40\)</span>, and superimpose plots of <span class="math notranslate nohighlight">\(\mathbf{q}\)</span> over <span class="math notranslate nohighlight">\(0\le x \le 1\)</span> for the two cases. (Be sure to include the zero values at <span class="math notranslate nohighlight">\(x=0\)</span> and <span class="math notranslate nohighlight">\(x=1\)</span> in your plots.)</p>
<p><strong>(c)</strong> ⌨  Repeat (b) for the case <span class="math notranslate nohighlight">\(m_k = (k/5n^2)\)</span> kg.</p>
</li>
<li id="problem-systemsinverse"><p>⌨  If <span class="math notranslate nohighlight">\(\mathbf{B}\in\mathbb{R}^{n \times p}\)</span>, has columns <span class="math notranslate nohighlight">\(\mathbf{b}_1,\ldots,\mathbf{b}_p\)</span>, then we can pose <span class="math notranslate nohighlight">\(p\)</span> linear systems at once by writing <span class="math notranslate nohighlight">\(\mathbf{A} \mathbf{X} = \mathbf{B}\)</span>, where <span class="math notranslate nohighlight">\(\mathbf{X}\)</span> is <span class="math notranslate nohighlight">\(n\times p\)</span>. Specifically, this equation implies <span class="math notranslate nohighlight">\(\mathbf{A} \mathbf{x}_j = \mathbf{b}_j\)</span> for <span class="math notranslate nohighlight">\(j=1,\ldots,p\)</span>.</p>
<p><strong>(a)</strong> Modify <a class="reference internal" href="#function-forwardsub"><span class="std std-numref">Function 2.3.4</span></a> and <a class="reference internal" href="#function-backsub"><span class="std std-numref">Function 2.3.5</span></a> so that they solve the case where the second input is <span class="math notranslate nohighlight">\(n\times p\)</span> for <span class="math notranslate nohighlight">\(p\ge 1\)</span>.</p>
<p><strong>(b)</strong> If <span class="math notranslate nohighlight">\(\mathbf{A} \mathbf{X}=\mathbf{I}\)</span>, then <span class="math notranslate nohighlight">\(\mathbf{X}=\mathbf{A}^{-1}\)</span>. Use this fact to write a function <code class="docutils literal notranslate"><span class="pre">ltinverse</span></code> that uses your modified <strong>forwardsub</strong> to compute the inverse of a lower triangular matrix. Test your function on at least two nontrivial matrices. (We remind you here that this is just an exercise; matrix inverses are rarely a good idea in numerical practice!)</p>
</li>
<li id="problem-ls-triangillcond"><p>⌨ <a class="reference internal" href="#demo-systems-triangular"><span class="std std-numref">Demo 2.3.6</span></a> showed solutions of <span class="math notranslate nohighlight">\(\mathbf{A}\mathbf{x}=\mathbf{b}\)</span>, where</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{A} = \begin{bmatrix} 1 &amp; -1 &amp; 0 &amp; \alpha-\beta &amp; \beta \\ 0 &amp; 1 &amp; -1 &amp;
  0 &amp; 0 \\ 0 &amp; 0 &amp; 1 &amp; -1 &amp; 0 \\ 0 &amp; 0 &amp; 0 &amp; 1 &amp; -1  \\ 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1
\end{bmatrix}, \quad
\mathbf{b} = \begin{bmatrix} \alpha \\ 0 \\ 0 \\ 0 \\ 1 \end{bmatrix}.\end{split}\]</div>
<p>Use <a class="reference internal" href="#function-backsub"><span class="std std-numref">Function 2.3.5</span></a> to solve with <span class="math notranslate nohighlight">\(\alpha=0.1\)</span> and <span class="math notranslate nohighlight">\(\beta=10,100,10^3,\ldots,10^{12}\)</span>, tabulating the values of <span class="math notranslate nohighlight">\(\beta\)</span> and <span class="math notranslate nohighlight">\(|x_1-1|\)</span>. (This kind of behavior is explained in <a class="reference internal" href="condition-number.html#section-linsys-condition-number"><span class="std std-numref">Section 2.8</span></a>.)</p>
</li>
</ol>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "julia-fast"
        },
        kernelOptions: {
            kernelName: "julia-fast",
            path: "./linsys"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'julia-fast'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="matrices.html" title="previous page"><span class="section-number">2.2. </span>Computing with matrices</a>
    <a class='right-next' id="next-link" href="lu.html" title="next page"><span class="section-number">2.4. </span>LU factorization</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Tobin A. Driscoll and Richard J. Braun<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>