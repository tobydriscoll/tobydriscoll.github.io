
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>2.9. Exploiting matrix structure &#8212; Fundamentals of Numerical Computation</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/proof.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"TeX": {"Macros": {"float": ["\\mathbb{F}"], "real": ["\\mathbb{R}"], "complex": ["\\mathbb{C}"], "nat": ["\\mathbb{N}"], "integer": ["\\mathbb{Z}"], "rmn{([^}]*)}{([^}]*)}": ["\\mathbb{R}^{#1 \\times #2}", 2], "dd{([^}]*)}{([^}]*)}": ["\\frac{d #1}{d #2}", 2], "ddd{([^}]*)}{([^}]*)}": ["\\frac{d^2 #1}{d #2^2}", 2], "pp{([^}]*)}{([^}]*)}": ["\\frac{\\partial #1}{\\partial #2}", 2], "ppp{([^}]*)}{([^}]*)}": ["\\frac{\\partial^2 #1}{\\partial #2^2}", 2], "ppdd{([^}]*)}{([^}]*)}{([^}]*)}": ["\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}", 3], "norm{([^}]*)}": ["\\| #1 \\|", 1], "twonorm{([^}]*)}": ["\\| #1 \\|_2", 1], "onenorm{([^}]*)}": ["\\| #1 \\|_1", 1], "infnorm{([^}]*)}": ["\\| #1 \\|_\\infty", 1], "anynorm{([^}]*)}{([^}]*)}": ["\\| #1 \\|_#2", 2], "innerprod{([^}]*)}{([^}]*)}": ["\\langle #1,#2 \\rangle", 2], "pr{([^}]*)}": ["^{(#1)}", 1], "kron{([^}]*)}{([^}]*)}": ["#1 \\otimes #2", 2], "eye{([^}]*)}": ["\\mathbf{e}_#1", 1], "meye": ["\\mathbf{I}"], "Qhat": ["\\hat{\\mathbf{Q}}"], "Rhat": ["\\hat{\\mathbf{R}}"], "bfalpha": ["\\mathbf{alpha}"], "bfdelta": ["\\mathbf{delta}"], "bfzero": ["\\boldsymbol{0}"], "macheps": ["\\epsilon_\\text{mach}"], "fl": ["\\operatorname{fl}"], "diag": ["\\operatorname{diag}"], "ign": ["\\operatorname{sign}"], "Re": ["\\operatorname{Re}"], "Im": ["\\operatorname{Im}"], "ee": ["\\times 10^"], "lnorm": ["\\|"], "rnorm": ["\\|"], "floor": ["\\lfloor#1\\rfloor", 1], "cI": ["\\mathcal{I}"], "mtx": ["\\operatorname{mtx}"], "myvec": ["\\operatorname{vec}"], "argmin": ["\\operatorname{argmin}"]}}, "HTML-CSS": {"availableFonts": [], "preferredFont": null, "webfont": "Latin-Modern"}, "tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <link rel="shortcut icon" href="../_static/favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="2.10. Next steps" href="next.html" />
    <link rel="prev" title="2.8. Conditioning of linear systems" href="condition-number.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      <img src="../_static/logo.svg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Fundamentals of Numerical Computation</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../frontmatter.html">
   Home
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Preface
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../preface.html">
   Preface to the Julia edition
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Main text
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../intro/overview.html">
   1. Introduction
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../intro/floating-point.html">
     1.1. Floating-point numbers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../intro/conditioning.html">
     1.2. Problems and conditioning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../intro/algorithms.html">
     1.3. Algorithms
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../intro/stability.html">
     1.4. Stability
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../intro/next.html">
     1.5. Next steps
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="overview.html">
   2. Linear systems of equations
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="polyinterp.html">
     2.1. Polynomial interpolation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="matrices.html">
     2.2. Computing with matrices
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="linear-systems.html">
     2.3. Linear systems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="lu.html">
     2.4. LU factorization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="efficiency.html">
     2.5. Efficiency of matrix computations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="pivoting.html">
     2.6. Row pivoting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="norms.html">
     2.7. Vector and matrix norms
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="condition-number.html">
     2.8. Conditioning of linear systems
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     2.9. Exploiting matrix structure
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="next.html">
     2.10. Next steps
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../leastsq/overview.html">
   3. Overdetermined linear systems
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../leastsq/fitting.html">
     3.1. Fitting functions to data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../leastsq/normaleqns.html">
     3.2. The normal equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../leastsq/qr.html">
     3.3. The QR factorization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../leastsq/house.html">
     3.4. Computing QR factorizations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../leastsq/next.html">
     3.5. Next steps
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../nonlineqn/overview.html">
   4. Roots of nonlinear equations
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../nonlineqn/rootproblem.html">
     4.1. The rootfinding problem
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../nonlineqn/fixed-point.html">
     4.2. Fixed point iteration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../nonlineqn/newton.html">
     4.3. Newton’s method
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../nonlineqn/secant.html">
     4.4. Interpolation-based methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../nonlineqn/newtonsys.html">
     4.5. Newton for nonlinear systems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../nonlineqn/quasinewton.html">
     4.6. Quasi-Newton methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../nonlineqn/nlsq.html">
     4.7. Nonlinear least squares
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../nonlineqn/next.html">
     4.8. Next steps
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../localapprox/overview.html">
   5. Piecewise interpolation
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../localapprox/interpolation.html">
     5.1. The interpolation problem
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../localapprox/pwlin.html">
     5.2. Piecewise linear interpolation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../localapprox/splines.html">
     5.3. Cubic splines
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../localapprox/finitediffs.html">
     5.4. Finite differences
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../localapprox/fd-converge.html">
     5.5. Convergence of finite differences
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../localapprox/integration.html">
     5.6. Numerical integration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../localapprox/adaptive.html">
     5.7. Adaptive integration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../localapprox/next.html">
     5.8. Next steps
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../ivp/overview.html">
   6. Initial-value problems for ODEs
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../ivp/basics.html">
     6.1. Basics of IVPs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ivp/euler.html">
     6.2. Euler’s method
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ivp/systems.html">
     6.3. IVP systems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ivp/rk.html">
     6.4. Runge–Kutta methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ivp/adaptive.html">
     6.5. Adaptive Runge–Kutta
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ivp/multistep.html">
     6.6. Multistep methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ivp/implicit.html">
     6.7. Implementation of multistep methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ivp/zerostability.html">
     6.8. Zero-stability of multistep methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ivp/next.html">
     6.9. Next steps
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../matrixanaly/overview.html">
   7. Matrix analysis
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../matrixanaly/insight.html">
     7.1. From matrix to insight
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../matrixanaly/evd.html">
     7.2. Eigenvalue decomposition
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../matrixanaly/svd.html">
     7.3. Singular value decomposition
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../matrixanaly/symm-eig.html">
     7.4. Symmetry and definiteness
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../matrixanaly/dimreduce.html">
     7.5. Dimension reduction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../matrixanaly/next.html">
     7.6. Next steps
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../krylov/overview.html">
   8. Krylov methods in linear algebra
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../krylov/structure.html">
     8.1. Sparsity and structure
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../krylov/power.html">
     8.2. Power iteration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../krylov/inviter.html">
     8.3. Inverse iteration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../krylov/subspace.html">
     8.4. Krylov subspaces
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../krylov/gmres.html">
     8.5. GMRES
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../krylov/minrescg.html">
     8.6. MINRES and conjugate gradients
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../krylov/matrixfree.html">
     8.7. Matrix-free iterations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../krylov/precond.html">
     8.8. Preconditioning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../krylov/next.html">
     8.9. Next steps
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../globalapprox/overview.html">
   9. Global function approximation
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../globalapprox/polynomial.html">
     9.1. Polynomial interpolation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../globalapprox/barycentric.html">
     9.2. The barycentric formula
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../globalapprox/stability.html">
     9.3. Stability of polynomial interpolation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../globalapprox/orthogonal.html">
     9.4. Orthogonal polynomials
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../globalapprox/trig.html">
     9.5. Trigonometric interpolation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../globalapprox/integration.html">
     9.6. Spectrally accurate integration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../globalapprox/improper.html">
     9.7. Improper integrals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../globalapprox/next.html">
     9.8. Next steps
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../bvp/overview.html">
   10. Boundary-value problems
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../bvp/tpbvp.html">
     10.1. Two-point BVP
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../bvp/shooting.html">
     10.2. Shooting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../bvp/diffmats.html">
     10.3. Differentiation matrices
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../bvp/linear.html">
     10.4. Collocation for linear problems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../bvp/nonlinear.html">
     10.5. Nonlinearity and boundary conditions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../bvp/galerkin.html">
     10.6. The Galerkin method
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../bvp/next.html">
     10.7. Next steps
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../diffusion/overview.html">
   11. Diffusion equations
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../diffusion/blackscholes.html">
     11.1. Black–Scholes equation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../diffusion/methodlines.html">
     11.2. The method of lines
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../diffusion/absstab.html">
     11.3. Absolute stability
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../diffusion/stiffness.html">
     11.4. Stiffness
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../diffusion/boundaries.html">
     11.5. Boundaries
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../diffusion/next.html">
     11.6. Next steps
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../advection/overview.html">
   12. Advection equations
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../advection/traffic.html">
     12.1. Traffic flow
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../advection/upwind.html">
     12.2. Upwinding and stability
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../advection/absstab.html">
     12.3. Absolute stability
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../advection/wave.html">
     12.4. The wave equation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../advection/next.html">
     12.5. Next steps
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../twodim/overview.html">
   13. Two-dimensional problems
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
  <label for="toctree-checkbox-13">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../twodim/tensorprod.html">
     13.1. Tensor-product discretizations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../twodim/diffadv.html">
     13.2. Two-dimensional diffusion and advection
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../twodim/laplace.html">
     13.3. Laplace and Poisson equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../twodim/nonlinear.html">
     13.4. Nonlinear elliptic PDEs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../twodim/next.html">
     13.5. Next steps
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Appendices
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../appendix/linear-algebra.html">
   Review of linear algebra
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../appendix/glossary.html">
   Glossary
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../appendix/julia.html">
   Julia cheatsheet
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../refs.html">
   References
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../genindex.html">
   Index
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        <a class="dropdown-buttons"
            href="../_sources/linsys/structure.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download notebook file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/linsys/structure.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/tobydriscoll/tobydriscoll.github.io/master?urlpath=tree/linsys/structure.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#banded-matrices">
   Banded matrices
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#symmetric-matrices">
   Symmetric matrices
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#symmetric-positive-definite-matrices">
   Symmetric positive definite matrices
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercises">
   Exercises
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="exploiting-matrix-structure">
<span id="section-linsys-structure"></span><h1><span class="section-number">2.9. </span>Exploiting matrix structure<a class="headerlink" href="#exploiting-matrix-structure" title="Permalink to this headline">¶</a></h1>
<p>A common situation in computation is that a problem has certain properties or structure that can be used to get a faster or more accurate solution. There are many properties of a matrix that can affect LU factorization. For example, an <span class="math notranslate nohighlight">\(n \times n\)</span> matrix <span class="math notranslate nohighlight">\(A\)</span> is <strong>diagonally dominant</strong> if</p>
<div class="math notranslate nohighlight" id="equation-diag-dominant">
<span class="eqno">(2.9.1)<a class="headerlink" href="#equation-diag-dominant" title="Permalink to this equation">¶</a></span>\[\begin{split}  |A_{ii}| &gt; \sum_{\substack{j=1\\ j \neq i}}^{n} |A_{ij}|, \hskip 0.25in \text{for each } i=1,\ldots,n.\end{split}\]</div>
<p>It turns out that a diagonally dominant matrix is guaranteed to be invertible, and row pivoting is not required for stability.</p>
<p>We next consider three important types of matrices that cause the LU factorization to be specialized in some important way.</p>
<div class="section" id="banded-matrices">
<h2>Banded matrices<a class="headerlink" href="#banded-matrices" title="Permalink to this headline">¶</a></h2>
<div class="proof proof-type-definition" id="id2">
<span id="index-0"></span><div class="proof-title"> <span class="proof-type">Definition 2.9.1</span>  <span class="proof-title-name">: &nbsp;Bandwidth</span>  </div><div class="proof-content">
<p>A matrix <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> has <strong>upper bandwidth</strong> <span class="math notranslate nohighlight">\(b_u\)</span> if <span class="math notranslate nohighlight">\(j-i &gt; b_u\)</span> implies <span class="math notranslate nohighlight">\(A_{ij}=0\)</span>, and <strong>lower bandwidth</strong> <span class="math notranslate nohighlight">\(b_\ell\)</span> if <span class="math notranslate nohighlight">\(i-j &gt; b_\ell\)</span> implies <span class="math notranslate nohighlight">\(A_{ij}=0\)</span>. We say the total <strong>bandwidth</strong> is <span class="math notranslate nohighlight">\(b_u+b_\ell+1\)</span>. When <span class="math notranslate nohighlight">\(b_u=b_\ell=1\)</span>, we have the important case of a <strong>tridiagonal matrix</strong>.</p>
</div></div><div class="proof proof-type-demo" id="id3">
<span id="demo-structure-banded"></span><div class="proof-title"> <span class="proof-type">Demo 2.9.2</span>  </div><div class="proof-content">
</div></div><div class='demo'><div class="sphinx-bs container pb-4 docutils" id="index-1">
<div class="row docutils">
<div class="d-flex col-7 left-side docutils">
<div class="card w-100 border-0 shadow-none docutils">
<div class="card-body docutils">
<p class="card-text">Here is a small tridiagonal matrix. Note that there is one fewer element on the super- and subdiagonals than on the main diagonal.</p>
</div>
</div>
</div>
<div class="d-flex col-5 right-side docutils">
<div class="card w-100 shadow-none comment docutils">
<div class="card-body docutils">
<p class="card-text">Use <code class="docutils literal notranslate"><span class="pre">fill</span></code> to create an array of a given size, with each element equal to a provided value.</p>
</div>
</div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">diagm</span><span class="p">(</span> <span class="o">-</span><span class="mi">1</span><span class="o">=&gt;</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="o">=&gt;</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="mi">1</span><span class="o">=&gt;</span><span class="n">fill</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>6×6 Matrix{Int64}:
 2  -1   0   0   0   0
 4   2  -1   0   0   0
 0   3   0  -1   0   0
 0   0   2   2  -1   0
 0   0   0   1   1  -1
 0   0   0   0   0   2
</pre></div>
</div>
</div>
</div>
<div class="sphinx-bs container pb-4 docutils" id="index-2">
<div class="row docutils">
<div class="d-flex col-7 left-side docutils">
<div class="card w-100 border-0 shadow-none docutils">
<div class="card-body docutils">
<p class="card-text">We can extract the elements on any diagonal using the <code class="docutils literal notranslate"><span class="pre">diag</span></code> function. The main or central diagonal is numbered zero, above and to the right of that is positive, and below and to the left is negative.</p>
</div>
</div>
</div>
<div class="d-flex col-5 right-side docutils">
<div class="card w-100 shadow-none comment docutils">
<div class="card-body docutils">
<p class="card-text">The <code class="docutils literal notranslate"><span class="pre">diag</span></code> function extracts the elements from a specified diagonal of a matrix.</p>
</div>
</div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="nd">@show</span> <span class="n">diag_main</span> <span class="o">=</span> <span class="n">diag</span><span class="p">(</span><span class="n">A</span><span class="p">);</span>
<span class="nd">@show</span> <span class="n">diag_minusone</span> <span class="o">=</span> <span class="n">diag</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>diag_main = diag(A) = [2, 2, 0, 2, 1, 2]
diag_minusone = diag(A, -1) = [4, 3, 2, 1, 0]
</pre></div>
</div>
</div>
</div>
<p>The lower and upper bandwidths of <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> are repeated in the factors from the unpivoted LU factorization.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">L</span><span class="p">,</span><span class="n">U</span> <span class="o">=</span> <span class="n">FNC</span><span class="o">.</span><span class="n">lufact</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="n">L</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>6×6 LowerTriangular{Float64, Matrix{Float64}}:
 1.0   ⋅     ⋅        ⋅         ⋅    ⋅ 
 2.0  1.0    ⋅        ⋅         ⋅    ⋅ 
 0.0  0.75  1.0       ⋅         ⋅    ⋅ 
 0.0  0.0   2.66667  1.0        ⋅    ⋅ 
 0.0  0.0   0.0      0.214286  1.0   ⋅ 
 0.0  0.0   0.0      0.0       0.0  1.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">U</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>6×6 UpperTriangular{Float64, Matrix{Float64}}:
 2.0  -1.0   0.0    0.0       0.0       0.0
  ⋅    4.0  -1.0    0.0       0.0       0.0
  ⋅     ⋅    0.75  -1.0       0.0       0.0
  ⋅     ⋅     ⋅     4.66667  -1.0       0.0
  ⋅     ⋅     ⋅      ⋅        1.21429  -1.0
  ⋅     ⋅     ⋅      ⋅         ⋅        2.0
</pre></div>
</div>
</div>
</div>
</div><p id="index-3">If row pivoting is not used, the <span class="math notranslate nohighlight">\(\mathbf{L}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{U}\)</span> factors preserve the lower and upper bandwidths of <span class="math notranslate nohighlight">\(\mathbf{A}\)</span>. This fact implies computational savings in both the factorization and the triangular substitutions, because the zeros appear predictably and we can skip multiplication and addition with them.</p>
<div class="proof proof-type-observation" id="id4">
<div class="proof-title"> <span class="proof-type">Observation 2.9.3</span>  </div><div class="proof-content">
<p>The number of flops needed by LU factorization without pivoting is <span class="math notranslate nohighlight">\(O(b_u b_\ell n)\)</span> when the upper and lower bandwidths are <span class="math notranslate nohighlight">\(b_u\)</span> and <span class="math notranslate nohighlight">\(b_\ell\)</span>.</p>
</div></div><p id="index-4">In order to exploit the savings offered by sparsity, we would need to make modifications to <a class="reference internal" href="lu.html#function-lufact"><span class="std std-numref">Function 2.4.6</span></a> and the triangular substitution routines. Alternatively, we can get Julia to take advantage of the structure automatically by converting the matrix into a special type called <strong>sparse</strong>. Sparse matrices are covered in more detail in Chapters 7 and 8.</p>
<div class="proof proof-type-demo" id="id5">
<span id="demo-structure-timing"></span><div class="proof-title"> <span class="proof-type">Demo 2.9.4</span>  </div><div class="proof-content">
</div></div><div class='demo'><p>If we use an ordinary or <em>dense</em> matrix, then there’s no way to exploit a banded structure such as tridiagonality.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">diagm</span><span class="p">(</span><span class="mi">0</span><span class="o">=&gt;</span><span class="mi">1</span><span class="o">:</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="o">=&gt;</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="o">:-</span><span class="mi">1</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">=&gt;</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<span class="n">lu</span><span class="p">(</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>  <span class="c"># force compilation</span>
<span class="nd">@time</span> <span class="n">lu</span><span class="p">(</span><span class="n">A</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  8.819808 seconds (5 allocations: 763.016 MiB, 0.07% gc time)
</pre></div>
</div>
</div>
</div>
<p>If instead we construct a proper <em>sparse</em> matrix, though, the speedup can be dramatic.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">spdiagm</span><span class="p">(</span><span class="mi">0</span><span class="o">=&gt;</span><span class="mi">1</span><span class="o">:</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="o">=&gt;</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="o">:-</span><span class="mi">1</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">=&gt;</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<span class="n">lu</span><span class="p">(</span><span class="n">A</span><span class="p">);</span>    <span class="c"># compile for sparse case</span>
<span class="nd">@time</span> <span class="n">lu</span><span class="p">(</span><span class="n">A</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  0.006120 seconds (65 allocations: 9.766 MiB)
</pre></div>
</div>
</div>
</div>
<p>You can also see above that far less memory was used in the sparse case.</p>
</div></div>
<div class="section" id="symmetric-matrices">
<h2>Symmetric matrices<a class="headerlink" href="#symmetric-matrices" title="Permalink to this headline">¶</a></h2>
<div class="proof proof-type-definition" id="id6">
<span id="index-5"></span><div class="proof-title"> <span class="proof-type">Definition 2.9.5</span>  <span class="proof-title-name">: &nbsp;Symmetric matrix</span>  </div><div class="proof-content">
<p>A square matrix <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> satisfying <span class="math notranslate nohighlight">\(\mathbf{A}^T = \mathbf{A}\)</span> is called <strong>symmetric</strong>.</p>
</div></div><p>Symmetric matrices arise frequently in applications because many types of interactions, such as gravitation and social-network befriending, are inherently symmetric. Symmetry in linear algebra simplifies many properties and algorithms. As a rule of thumb, if your matrix has symmetry, you want to exploit and preserve it.</p>
<p>In <span class="math notranslate nohighlight">\(\mathbf{A}=\mathbf{L}\mathbf{U}\)</span> we arbitrarily required the diagonal elements of <span class="math notranslate nohighlight">\(\mathbf{L}\)</span>, but not <span class="math notranslate nohighlight">\(\mathbf{U}\)</span>, to be one. That breaks symmetry, so we need to modify the goal to</p>
<div class="math notranslate nohighlight">
\[
\mathbf{A}=\mathbf{L}\mathbf{D}\mathbf{L}^T,
\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{L}\)</span> is unit lower triangular and <span class="math notranslate nohighlight">\(\mathbf{D}\)</span> is diagonal. To find an algorithm for this, we begin by generalizing <a class="reference internal" href="lu.html#equation-matrixouter">(2.4.2)</a> a bit.</p>
<div class="proof proof-type-formula" id="id7">
<div class="proof-title"> <span class="proof-type">Formula 2.9.6</span>  <span class="proof-title-name">: &nbsp;Linear combination of outer products</span>  </div><div class="proof-content">
<p>Let <span class="math notranslate nohighlight">\(\mathbf{D}\)</span> be an <span class="math notranslate nohighlight">\(n\times n\)</span> diagonal matrix with diagonal elements <span class="math notranslate nohighlight">\(d_1,d_2,\ldots,d_n\)</span>, and suppose <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{B}\)</span> are <span class="math notranslate nohighlight">\(n\times n\)</span> as well. Write the columns of <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> as <span class="math notranslate nohighlight">\(\mathbf{a}_1,\dots,\mathbf{a}_n\)</span> and the rows of <span class="math notranslate nohighlight">\(\mathbf{B}\)</span> as <span class="math notranslate nohighlight">\(\mathbf{b}_1^T,\dots,\mathbf{b}_n^T\)</span>. Then</p>
<div class="math notranslate nohighlight" id="equation-matrixouter3">
<span class="eqno">(2.9.2)<a class="headerlink" href="#equation-matrixouter3" title="Permalink to this equation">¶</a></span>\[\mathbf{A}\mathbf{D}\mathbf{B} = \sum_{k=1}^n d_k \mathbf{a}_k \mathbf{b}_k^T.\]</div>
</div></div><p>Let’s derive the LDL<span class="math notranslate nohighlight">\(^T\)</span> factorization for a small example.</p>
<div class="proof proof-type-demo" id="id8">
<span id="demo-structure-symm"></span><div class="proof-title"> <span class="proof-type">Demo 2.9.7</span>  </div><div class="proof-content">
</div></div><div class='demo'><p>We begin with a symmetric <span class="math notranslate nohighlight">\(\mathbf{A}\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">A₁</span> <span class="o">=</span> <span class="p">[</span>  <span class="mi">2</span>     <span class="mi">4</span>     <span class="mi">4</span>     <span class="mi">2</span>
        <span class="mi">4</span>     <span class="mi">5</span>     <span class="mi">8</span>    <span class="o">-</span><span class="mi">5</span>
        <span class="mi">4</span>     <span class="mi">8</span>     <span class="mi">6</span>     <span class="mi">2</span>
        <span class="mi">2</span>    <span class="o">-</span><span class="mi">5</span>     <span class="mi">2</span>   <span class="o">-</span><span class="mi">26</span> <span class="p">];</span>
</pre></div>
</div>
</div>
</div>
<p>We won’t use pivoting, so the pivot element is at position (1,1). This will become the first element on the diagonal of <span class="math notranslate nohighlight">\(\mathbf{D}\)</span>. Then we divide by that pivot to get the first column of <span class="math notranslate nohighlight">\(\mathbf{L}\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">L</span> <span class="o">=</span> <span class="n">diagm</span><span class="p">(</span><span class="n">ones</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">A₁</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">L</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">A₁</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">A₂</span> <span class="o">=</span> <span class="n">A₁</span> <span class="o">-</span> <span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">L</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">L</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4×4 Matrix{Float64}:
 0.0   0.0   0.0    0.0
 0.0  -3.0   0.0   -9.0
 0.0   0.0  -2.0   -2.0
 0.0  -9.0  -2.0  -28.0
</pre></div>
</div>
</div>
</div>
<p>We are now set up the same way for the submatrix in rows and columns 2–4.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">A₂</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="n">L</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">A₂</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="n">d</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">A₃</span> <span class="o">=</span> <span class="n">A₂</span> <span class="o">-</span> <span class="n">d</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">L</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">L</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4×4 Matrix{Float64}:
 0.0  0.0   0.0   0.0
 0.0  0.0   0.0   0.0
 0.0  0.0  -2.0  -2.0
 0.0  0.0  -2.0  -1.0
</pre></div>
</div>
</div>
</div>
<p>We continue working our way down the diagonal.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">A₃</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
<span class="n">L</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">A₃</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span><span class="o">/</span><span class="n">d</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="n">A₄</span> <span class="o">=</span> <span class="n">A₃</span> <span class="o">-</span> <span class="n">d</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">L</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">L</span><span class="p">[</span><span class="o">:</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span><span class="o">&#39;</span>
<span class="n">d</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">A₄</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>
<span class="nd">@show</span> <span class="n">d</span><span class="p">;</span>
<span class="n">L</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>d = [2.0, -3.0, -2.0, 1.0]
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4×4 Matrix{Float64}:
 1.0  -0.0  -0.0  0.0
 2.0   1.0  -0.0  0.0
 2.0  -0.0   1.0  0.0
 1.0   3.0   1.0  1.0
</pre></div>
</div>
</div>
</div>
<p>We have arrived at the targeted factorization.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">A₁</span> <span class="o">-</span> <span class="n">L</span><span class="o">*</span><span class="n">diagm</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">*</span><span class="n">L</span><span class="o">&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4×4 Matrix{Float64}:
 0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0
</pre></div>
</div>
</div>
</div>
</div><p>In practice we don’t actually have to carry out any arithmetic in the upper triangle of <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> as we work, since the operations are always the mirror image of those in the lower triangle. As a result, it can be shown that LDL<span class="math notranslate nohighlight">\(^T\)</span> factorization takes about half as much work as the standard LU.</p>
<div class="proof proof-type-observation" id="id9">
<div class="proof-title"> <span class="proof-type">Observation 2.9.8</span>  </div><div class="proof-content">
<p>LDL<span class="math notranslate nohighlight">\(^T\)</span> factorization on an <span class="math notranslate nohighlight">\(n \times n\)</span> symmetric matrix, when successful, takes <span class="math notranslate nohighlight">\(\sim \frac{1}{3}n^3\)</span> flops.</p>
</div></div><p>Just as pivoting is necessary to stabilize LU factorization, the LDL<span class="math notranslate nohighlight">\(^T\)</span> factorization without pivoting may be unstable or even fail to exist. We won’t go into the details, because our interest is in specializing the factorization to matrices that also possess another important property.</p>
</div>
<div class="section" id="symmetric-positive-definite-matrices">
<span id="sec-spd"></span><h2>Symmetric positive definite matrices<a class="headerlink" href="#symmetric-positive-definite-matrices" title="Permalink to this headline">¶</a></h2>
<p>Suppose that <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> is <span class="math notranslate nohighlight">\(n\times n\)</span> and <span class="math notranslate nohighlight">\(\mathbf{x}\in\mathbb{R}^n\)</span>. Observe that <span class="math notranslate nohighlight">\(\mathbf{x}^T\mathbf{A}\mathbf{x}\)</span> is the product of <span class="math notranslate nohighlight">\(1\times n\)</span>, <span class="math notranslate nohighlight">\(n\times n\)</span>, and <span class="math notranslate nohighlight">\(n\times 1\)</span> matrices, so it is a scalar, sometimes referred to as a <strong>quadratic form</strong>. It can be expressed as</p>
<div class="math notranslate nohighlight" id="equation-quadratic-form">
<span class="eqno">(2.9.3)<a class="headerlink" href="#equation-quadratic-form" title="Permalink to this equation">¶</a></span>\[  \mathbf{x}^T\mathbf{A}\mathbf{x} = \sum_{i=1}^n \sum_{j=1}^n A_{ij}x_ix_j.\]</div>
<span class="target" id="index-6"></span><div class="proof proof-type-definition" id="id10">
<span id="index-7"></span><div class="proof-title"> <span class="proof-type">Definition 2.9.9</span>  <span class="proof-title-name">: &nbsp;Symmetric positive definite matrix</span>  </div><div class="proof-content">
<p>A real <span class="math notranslate nohighlight">\(n\times n\)</span> matrix <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> is called a <strong>symmetric positive definite matrix</strong> (or SPD matrix) if it is symmetric and, for all nonzero <span class="math notranslate nohighlight">\(\mathbf{x}\in\mathbb{R}^n\)</span>,</p>
<div class="math notranslate nohighlight" id="equation-spd-def">
<span class="eqno">(2.9.4)<a class="headerlink" href="#equation-spd-def" title="Permalink to this equation">¶</a></span>\[  \mathbf{x}^T \mathbf{A} \mathbf{x} &gt; 0.\]</div>
</div></div><p>The definiteness property is usually difficult to check directly from the definition. There are some equivalent conditions, though. For instance, a symmetric matrix is positive definite if and only if its eigenvalues are all real positive numbers. SPD matrices have important properties and appear in applications in which the definiteness is known for theoretical reasons.</p>
<p>Let us consider what definiteness means to the LDL<span class="math notranslate nohighlight">\(^T\)</span> factorization. We compute</p>
<div class="math notranslate nohighlight">
\[  0 &lt; \mathbf{x}^T\mathbf{A}\mathbf{x} = \mathbf{x}^T \mathbf{L} \mathbf{D} \mathbf{L}^T \mathbf{x} = \mathbf{z}^T \mathbf{D} \mathbf{z},\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{z}=\mathbf{L}^T \mathbf{x}\)</span>. Note that since <span class="math notranslate nohighlight">\(\mathbf{L}\)</span> is unit lower triangular, it is nonsingular, so <span class="math notranslate nohighlight">\(\mathbf{x}=\mathbf{L}^{-T}\mathbf{z}\)</span>. By taking <span class="math notranslate nohighlight">\(\mathbf{z}=\mathbf{e}_k\)</span> for <span class="math notranslate nohighlight">\(k=1,\ldots,n\)</span>, we can read the equalities from right to left and conclude that <span class="math notranslate nohighlight">\(D_{kk}&gt;0\)</span> for all <span class="math notranslate nohighlight">\(k\)</span>. That permits us to write a kind of square root formula:<a class="footnote-reference brackets" href="#sqrt" id="id1">1</a></p>
<div class="math notranslate nohighlight" id="equation-diag-sqrt">
<span class="eqno">(2.9.5)<a class="headerlink" href="#equation-diag-sqrt" title="Permalink to this equation">¶</a></span>\[\begin{split}  \mathbf{D} =
  \begin{bmatrix}
    D_{11} &amp;        &amp;        &amp; \\
           &amp; D_{22} &amp;        &amp; \\
           &amp;        &amp; \ddots &amp; \\
           &amp;        &amp;        &amp; D_{nn}
  \end{bmatrix}
=   \begin{bmatrix}
    \sqrt{D_{11}} &amp;        &amp;        &amp; \\
           &amp; \sqrt{D_{22}} &amp;        &amp; \\
           &amp;        &amp; \ddots &amp; \\
           &amp;        &amp;        &amp; \sqrt{D_{nn}}
  \end{bmatrix}^{\,2}
= \bigl( \mathbf{D}^{1/2} \bigr)^2.\end{split}\]</div>
<p>Now we have <span class="math notranslate nohighlight">\(\mathbf{A}=\mathbf{L}\mathbf{D}^{1/2}\mathbf{D}^{1/2}\mathbf{L}^T= \mathbf{R}^T \mathbf{R}\)</span>, where <span class="math notranslate nohighlight">\(\mathbf{R} =\mathbf{D}^{1/2}\mathbf{L}^T\)</span> is an upper triangular matrix whose diagonal entries are positive.</p>
<span class="target" id="index-8"></span><div class="proof proof-type-definition" id="id11">
<span id="index-9"></span><div class="proof-title"> <span class="proof-type">Definition 2.9.10</span>  <span class="proof-title-name">: &nbsp;Cholesky factorization</span>  </div><div class="proof-content">
<p>Any SPD matrix <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> may be factored as</p>
<div class="math notranslate nohighlight">
\[
\mathbf{A} = \mathbf{R}^T \mathbf{R},
\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{R}\)</span> is an upper triangular matrix with positive diagonal elements. This is called the <strong>Cholesky factorization</strong>.</p>
</div></div><p>While the unpivoted LDL<span class="math notranslate nohighlight">\(^T\)</span> factorization is not stable and not even always possible, in the SPD case one can prove that pivoting is not necessary for the existence nor the stability of the Cholesky factorization.</p>
<div class="proof proof-type-observation" id="id12">
<div class="proof-title"> <span class="proof-type">Observation 2.9.11</span>  </div><div class="proof-content">
<p>Cholesky factorization of an <span class="math notranslate nohighlight">\(n \times n\)</span> SPD matrix takes <span class="math notranslate nohighlight">\(\sim \frac{1}{3}n^3\)</span> flops.</p>
</div></div><p>The speed and stability of the Cholesky factorization make it the top choice for solving linear systems with SPD matrices. As a side benefit, the Cholesky algorithm fails (in the form of an imaginary square root or division by zero) if and only if the matrix <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> is not positive definite. This is often the best way to test the definiteness of a symmetric matrix about which nothing else is known.</p>
<div class="proof proof-type-demo" id="id13">
<span id="demo-structure-cholesky"></span><div class="proof-title"> <span class="proof-type">Demo 2.9.12</span>  </div><div class="proof-content">
</div></div><div class='demo'><p>A randomly chosen matrix is extremely unlikely to be symmetric. However, there is a simple way to symmetrize one.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">rand</span><span class="p">(</span><span class="mf">1.0</span><span class="o">:</span><span class="mf">9.0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">A</span> <span class="o">+</span> <span class="n">A</span><span class="o">&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4×4 Matrix{Float64}:
 16.0  9.0   8.0   7.0
  9.0  8.0   7.0   8.0
  8.0  7.0   2.0  14.0
  7.0  8.0  14.0   2.0
</pre></div>
</div>
</div>
</div>
<div class="sphinx-bs container pb-4 docutils" id="index-10">
<div class="row docutils">
<div class="d-flex col-7 left-side docutils">
<div class="card w-100 border-0 shadow-none docutils">
<div class="card-body docutils">
<p class="card-text">Similarly, a random symmetric matrix is unlikely to be positive definite. The Cholesky algorithm always detects a non-PD matrix by quitting with an error.</p>
</div>
</div>
</div>
<div class="d-flex col-5 right-side docutils">
<div class="card w-100 shadow-none comment docutils">
<div class="card-body docutils">
<p class="card-text">The <code class="docutils literal notranslate"><span class="pre">cholesky</span></code> function computes a Cholesky factorization if possible, or throws an error for a non-positive-definite matrix. However, it does <em>not</em> check for symmetry.</p>
</div>
</div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">cholesky</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>    <span class="c"># throws an error</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="ne">PosDefException</span>: matrix is not positive definite; Cholesky factorization failed.

<span class="ne">Stacktrace</span>:
 <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="n">checkpositivedefinite</span>
   <span class="o">@</span> <span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">julia</span><span class="o">/</span><span class="n">buildbot</span><span class="o">/</span><span class="n">worker</span><span class="o">/</span><span class="n">package_macos64</span><span class="o">/</span><span class="n">build</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">julia</span><span class="o">/</span><span class="n">stdlib</span><span class="o">/</span><span class="n">v1</span><span class="mf">.6</span><span class="o">/</span><span class="n">LinearAlgebra</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">factorization</span><span class="o">.</span><span class="n">jl</span><span class="p">:</span><span class="mi">18</span> <span class="p">[</span><span class="n">inlined</span><span class="p">]</span>
 <span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="n">cholesky</span><span class="o">!(</span>A::Hermitian<span class="o">{</span>Float64, Matrix<span class="o">{</span>Float64<span class="o">}}</span>, ::Val<span class="o">{</span>false<span class="o">}</span><span class="p">;</span> check::Bool<span class="o">)</span>
   <span class="o">@</span> <span class="n">LinearAlgebra</span> <span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">julia</span><span class="o">/</span><span class="n">buildbot</span><span class="o">/</span><span class="n">worker</span><span class="o">/</span><span class="n">package_macos64</span><span class="o">/</span><span class="n">build</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">julia</span><span class="o">/</span><span class="n">stdlib</span><span class="o">/</span><span class="n">v1</span><span class="mf">.6</span><span class="o">/</span><span class="n">LinearAlgebra</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">cholesky</span><span class="o">.</span><span class="n">jl</span><span class="p">:</span><span class="mi">253</span>
 <span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="n">cholesky</span><span class="o">!(</span>A::Matrix<span class="o">{</span>Float64<span class="o">}</span>, ::Val<span class="o">{</span>false<span class="o">}</span><span class="p">;</span> check::Bool<span class="o">)</span>
   <span class="o">@</span> <span class="n">LinearAlgebra</span> <span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">julia</span><span class="o">/</span><span class="n">buildbot</span><span class="o">/</span><span class="n">worker</span><span class="o">/</span><span class="n">package_macos64</span><span class="o">/</span><span class="n">build</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">julia</span><span class="o">/</span><span class="n">stdlib</span><span class="o">/</span><span class="n">v1</span><span class="mf">.6</span><span class="o">/</span><span class="n">LinearAlgebra</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">cholesky</span><span class="o">.</span><span class="n">jl</span><span class="p">:</span><span class="mi">285</span>
 <span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="c1">#cholesky#130</span>
   <span class="o">@</span> <span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">julia</span><span class="o">/</span><span class="n">buildbot</span><span class="o">/</span><span class="n">worker</span><span class="o">/</span><span class="n">package_macos64</span><span class="o">/</span><span class="n">build</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">julia</span><span class="o">/</span><span class="n">stdlib</span><span class="o">/</span><span class="n">v1</span><span class="mf">.6</span><span class="o">/</span><span class="n">LinearAlgebra</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">cholesky</span><span class="o">.</span><span class="n">jl</span><span class="p">:</span><span class="mi">378</span> <span class="p">[</span><span class="n">inlined</span><span class="p">]</span>
 <span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="n">cholesky</span> <span class="p">(</span><span class="n">repeats</span> <span class="mi">2</span> <span class="n">times</span><span class="p">)</span>
   <span class="o">@</span> <span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">julia</span><span class="o">/</span><span class="n">buildbot</span><span class="o">/</span><span class="n">worker</span><span class="o">/</span><span class="n">package_macos64</span><span class="o">/</span><span class="n">build</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">julia</span><span class="o">/</span><span class="n">stdlib</span><span class="o">/</span><span class="n">v1</span><span class="mf">.6</span><span class="o">/</span><span class="n">LinearAlgebra</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">cholesky</span><span class="o">.</span><span class="n">jl</span><span class="p">:</span><span class="mi">378</span> <span class="p">[</span><span class="n">inlined</span><span class="p">]</span>
 <span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="n">top</span><span class="o">-</span><span class="n">level</span> <span class="n">scope</span>
   <span class="o">@</span> <span class="n">In</span><span class="p">[</span><span class="mi">14</span><span class="p">]:</span><span class="mi">1</span>
 <span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="nb">eval</span>
   <span class="o">@</span> <span class="o">./</span><span class="n">boot</span><span class="o">.</span><span class="n">jl</span><span class="p">:</span><span class="mi">360</span> <span class="p">[</span><span class="n">inlined</span><span class="p">]</span>
 <span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="n">include_string</span><span class="p">(</span><span class="n">mapexpr</span><span class="p">::</span><span class="n">typeof</span><span class="p">(</span><span class="n">REPL</span><span class="o">.</span><span class="n">softscope</span><span class="p">),</span> <span class="n">mod</span><span class="p">::</span><span class="n">Module</span><span class="p">,</span> <span class="n">code</span><span class="p">::</span><span class="n">String</span><span class="p">,</span> <span class="n">filename</span><span class="p">::</span><span class="n">String</span><span class="p">)</span>
   <span class="o">@</span> <span class="n">Base</span> <span class="o">./</span><span class="n">loading</span><span class="o">.</span><span class="n">jl</span><span class="p">:</span><span class="mi">1094</span>
</pre></div>
</div>
</div>
</div>
<p>It’s not hard to manufacture an SPD matrix to try out the Cholesky factorization.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">B</span> <span class="o">=</span> <span class="n">A</span><span class="o">&#39;*</span><span class="n">A</span>
<span class="n">cf</span> <span class="o">=</span> <span class="n">cholesky</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Cholesky{Float64, Matrix{Float64}}
U factor:
4×4 UpperTriangular{Float64, Matrix{Float64}}:
 11.1803  6.0821   7.51319   8.13929
   ⋅      2.82984  4.34795  -0.531479
   ⋅       ⋅       1.62707  -5.4338
   ⋅       ⋅        ⋅        0.971286
</pre></div>
</div>
</div>
</div>
<p>What’s returned is a factorization object. Another step is required to extract the factor as a matrix:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">R</span> <span class="o">=</span> <span class="n">cf</span><span class="o">.</span><span class="n">U</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4×4 UpperTriangular{Float64, Matrix{Float64}}:
 11.1803  6.0821   7.51319   8.13929
   ⋅      2.82984  4.34795  -0.531479
   ⋅       ⋅       1.62707  -5.4338
   ⋅       ⋅        ⋅        0.971286
</pre></div>
</div>
</div>
</div>
<p>Here we validate the factorization:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">opnorm</span><span class="p">(</span><span class="n">R</span><span class="o">&#39;*</span><span class="n">R</span> <span class="o">-</span> <span class="n">B</span><span class="p">)</span> <span class="o">/</span> <span class="n">opnorm</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4.7988414529272745e-17
</pre></div>
</div>
</div>
</div>
</div></div>
<div class="section" id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">¶</a></h2>
<ol>
<li><p>✍  For each matrix, use <a class="reference internal" href="#equation-diag-dominant">(2.9.1)</a> to determine whether it is diagonally dominant.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{A} =
\begin{bmatrix}
3  &amp; 1  &amp; 0 &amp; 1  \\
0  &amp; -2 &amp; 0 &amp; 1  \\
-1 &amp; 0  &amp; 4 &amp; -1 \\
0  &amp; 0  &amp; 0 &amp; 6
\end{bmatrix},
\quad
\mathbf{B} =
\begin{bmatrix}
1  &amp; 0  &amp; 0  &amp; 0 &amp; 0  \\
0  &amp; 1  &amp; 0  &amp; 0 &amp; 0  \\
0  &amp; 0  &amp; 1  &amp; 0 &amp; 0  \\
0  &amp; 0  &amp; 0  &amp; 1 &amp; 0  \\
0  &amp; 0  &amp; 0  &amp; 0 &amp; 0
\end{bmatrix}
\quad \mathbf{C} =
\begin{bmatrix}
2  &amp; -1 &amp; 0  &amp; 0      \\
-1 &amp; 2  &amp; -1 &amp; 0      \\
0  &amp; -1 &amp; 2  &amp; -1     \\
0  &amp; 0  &amp; -1 &amp; 2
\end{bmatrix}.\end{split}\]</div>
</li>
<li><p>⌨ For each matrix, use inspection or <code class="docutils literal notranslate"><span class="pre">cholesky</span></code> in Julia to determine whether it is SPD.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{A} =
\begin{bmatrix}
1 &amp; 0 &amp; -1 \\ 0 &amp; 4 &amp; 5 \\ -1 &amp; 5 &amp; 10
\end{bmatrix},
\qquad
\mathbf{B} =
\begin{bmatrix}
1 &amp; 0 &amp; 1 \\ 0 &amp; 4 &amp; 5 \\ -1 &amp; 5 &amp; 10
\end{bmatrix},
\qquad
\mathbf{C} =
\begin{bmatrix}
1 &amp; 0 &amp; 1 \\ 0 &amp; 4 &amp; 5 \\ 1 &amp; 5 &amp; 1
\end{bmatrix}.\end{split}\]</div>
</li>
<li><p>✍ Show that the diagonal entries of a symmetric positive definite matrix are positive numbers. (Hint: Apply certain special cases of <a class="reference internal" href="#equation-spd-def">(2.9.4)</a>.)</p></li>
<li><p>⌨ Using <a class="reference internal" href="lu.html#function-lufact"><span class="std std-numref">Function 2.4.6</span></a> as a guide, write a function</p>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span> <span class="n">luband</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">upper</span><span class="p">,</span><span class="n">lower</span><span class="p">)</span>
</pre></div>
</div>
<p>that accepts upper and lower bandwidth values and returns LU factors (without pivoting) in a way that avoids doing arithmetic using the locations that are known to stay zero. (Hint: Refer to the more efficient form of <code class="docutils literal notranslate"><span class="pre">lufact</span></code> given in <a class="reference internal" href="efficiency.html#section-linsys-efficiency"><span class="std std-numref">Section 2.5</span></a>.)</p>
<p>Test your function on the matrix with elements</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    A_{ij} = \begin{cases} \frac{1}{i+j}, &amp; -1 \le i-j \le 2,\\ 
    0, &amp; \text{otherwise.} \end{cases}
    \end{split}\]</div>
</li>
<li><p>⌨ The <code class="docutils literal notranslate"><span class="pre">Tridiagonal</span></code> matrix type invokes a specialized algorithm for solving a linear system.</p>
<p><strong>(a)</strong> Set <code class="docutils literal notranslate"><span class="pre">n=1000</span></code> and <code class="docutils literal notranslate"><span class="pre">t=0</span></code>.  In a loop that runs 50 times, generate a linear system via</p>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">triu</span><span class="p">(</span> <span class="n">tril</span><span class="p">(</span><span class="n">rand</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">),</span><span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
<p>Using <code class="docutils literal notranslate"><span class="pre">&#64;elapsed</span></code>, increment <code class="docutils literal notranslate"><span class="pre">t</span></code> by the time it takes to perform <code class="docutils literal notranslate"><span class="pre">A\b</span></code>. Print out the final value of <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p>
<p><strong>(b)</strong> Repeat the experiment of part (a), but generate the matrix via</p>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">Tridiagonal</span><span class="p">(</span><span class="n">rand</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">))</span>
</pre></div>
</div>
<p>What is the ratio of running times for part (a) and (b)?</p>
<p><strong>(c)</strong> Now perform the experiment of part (b) for <span class="math notranslate nohighlight">\(n=1000,1200,1400,\ldots,3000\)</span>, keeping the total time for each value of <span class="math notranslate nohighlight">\(n\)</span> in a vector. Plot running time as a function of <span class="math notranslate nohighlight">\(n\)</span> on a log–log scale. Is the time most like <span class="math notranslate nohighlight">\(O(n)\)</span>, <span class="math notranslate nohighlight">\(O(n^2)\)</span>, or <span class="math notranslate nohighlight">\(O(n^3)\)</span>? (If the answer is unclear, try increasing the number of solves per value of <span class="math notranslate nohighlight">\(n\)</span> to 100 or more.)</p>
</li>
<li id="problem-ataisspd"><p>✍ Prove that if <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> is any real invertible square matrix, then <span class="math notranslate nohighlight">\(\mathbf{A}^T\mathbf{A}\)</span> is SPD. (Hint: First show that <span class="math notranslate nohighlight">\(\mathbf{x}^T\mathbf{A}^T\mathbf{A}\mathbf{x} \ge 0\)</span> for all <span class="math notranslate nohighlight">\(\mathbf{x}\)</span>. Then explain why zero is ruled out if <span class="math notranslate nohighlight">\(\mathbf{x}\neq \boldsymbol{0}\)</span>.)</p></li>
</ol>
<hr class="footnotes docutils" />
<dl class="footnote brackets">
<dt class="label" id="sqrt"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>Except for this diagonal, positive definite case, it’s not trivial to define the square root of a matrix, so don’t generalize the notation used here.</p>
</dd>
</dl>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "julia-fast"
        },
        kernelOptions: {
            kernelName: "julia-fast",
            path: "./linsys"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'julia-fast'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="condition-number.html" title="previous page"><span class="section-number">2.8. </span>Conditioning of linear systems</a>
    <a class='right-next' id="next-link" href="next.html" title="next page"><span class="section-number">2.10. </span>Next steps</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Tobin A. Driscoll and Richard J. Braun<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>