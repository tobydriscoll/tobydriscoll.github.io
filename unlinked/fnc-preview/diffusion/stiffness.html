
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>11.4. Stiffness &#8212; Fundamentals of Numerical Computation</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/proof.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"TeX": {"Macros": {"float": ["\\mathbb{F}"], "real": ["\\mathbb{R}"], "complex": ["\\mathbb{C}"], "nat": ["\\mathbb{N}"], "integer": ["\\mathbb{Z}"], "rmn{([^}]*)}{([^}]*)}": ["\\mathbb{R}^{#1 \\times #2}", 2], "dd{([^}]*)}{([^}]*)}": ["\\frac{d #1}{d #2}", 2], "ddd{([^}]*)}{([^}]*)}": ["\\frac{d^2 #1}{d #2^2}", 2], "pp{([^}]*)}{([^}]*)}": ["\\frac{\\partial #1}{\\partial #2}", 2], "ppp{([^}]*)}{([^}]*)}": ["\\frac{\\partial^2 #1}{\\partial #2^2}", 2], "ppdd{([^}]*)}{([^}]*)}{([^}]*)}": ["\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}", 3], "norm{([^}]*)}": ["\\| #1 \\|", 1], "twonorm{([^}]*)}": ["\\| #1 \\|_2", 1], "onenorm{([^}]*)}": ["\\| #1 \\|_1", 1], "infnorm{([^}]*)}": ["\\| #1 \\|_\\infty", 1], "anynorm{([^}]*)}{([^}]*)}": ["\\| #1 \\|_#2", 2], "innerprod{([^}]*)}{([^}]*)}": ["\\langle #1,#2 \\rangle", 2], "pr{([^}]*)}": ["^{(#1)}", 1], "kron{([^}]*)}{([^}]*)}": ["#1 \\otimes #2", 2], "eye{([^}]*)}": ["\\mathbf{e}_#1", 1], "meye": ["\\mathbf{I}"], "Qhat": ["\\hat{\\mathbf{Q}}"], "Rhat": ["\\hat{\\mathbf{R}}"], "bfalpha": ["\\mathbf{alpha}"], "bfdelta": ["\\mathbf{delta}"], "bfzero": ["\\boldsymbol{0}"], "macheps": ["\\epsilon_\\text{mach}"], "fl": ["\\operatorname{fl}"], "diag": ["\\operatorname{diag}"], "ign": ["\\operatorname{sign}"], "Re": ["\\operatorname{Re}"], "Im": ["\\operatorname{Im}"], "ee": ["\\times 10^"], "lnorm": ["\\|"], "rnorm": ["\\|"], "floor": ["\\lfloor#1\\rfloor", 1], "cI": ["\\mathcal{I}"], "mtx": ["\\operatorname{mtx}"], "myvec": ["\\operatorname{vec}"], "argmin": ["\\operatorname{argmin}"]}}, "HTML-CSS": {"availableFonts": [], "preferredFont": null, "webfont": "Latin-Modern"}, "tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <link rel="shortcut icon" href="../_static/favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="11.5. Boundaries" href="boundaries.html" />
    <link rel="prev" title="11.3. Absolute stability" href="absstab.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      <img src="../_static/logo.svg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Fundamentals of Numerical Computation</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../frontmatter.html">
   Home
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Preface
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../preface.html">
   Preface to the Julia edition
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Main text
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../intro/overview.html">
   1. Introduction
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../intro/floating-point.html">
     1.1. Floating-point numbers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../intro/conditioning.html">
     1.2. Problems and conditioning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../intro/algorithms.html">
     1.3. Algorithms
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../intro/stability.html">
     1.4. Stability
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../intro/next.html">
     1.5. Next steps
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../linsys/overview.html">
   2. Linear systems of equations
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../linsys/polyinterp.html">
     2.1. Polynomial interpolation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../linsys/matrices.html">
     2.2. Computing with matrices
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../linsys/linear-systems.html">
     2.3. Linear systems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../linsys/lu.html">
     2.4. LU factorization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../linsys/efficiency.html">
     2.5. Efficiency of matrix computations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../linsys/pivoting.html">
     2.6. Row pivoting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../linsys/norms.html">
     2.7. Vector and matrix norms
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../linsys/condition-number.html">
     2.8. Conditioning of linear systems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../linsys/structure.html">
     2.9. Exploiting matrix structure
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../linsys/next.html">
     2.10. Next steps
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../leastsq/overview.html">
   3. Overdetermined linear systems
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../leastsq/fitting.html">
     3.1. Fitting functions to data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../leastsq/normaleqns.html">
     3.2. The normal equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../leastsq/qr.html">
     3.3. The QR factorization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../leastsq/house.html">
     3.4. Computing QR factorizations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../leastsq/next.html">
     3.5. Next steps
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../nonlineqn/overview.html">
   4. Roots of nonlinear equations
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../nonlineqn/rootproblem.html">
     4.1. The rootfinding problem
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../nonlineqn/fixed-point.html">
     4.2. Fixed point iteration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../nonlineqn/newton.html">
     4.3. Newton’s method
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../nonlineqn/secant.html">
     4.4. Interpolation-based methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../nonlineqn/newtonsys.html">
     4.5. Newton for nonlinear systems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../nonlineqn/quasinewton.html">
     4.6. Quasi-Newton methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../nonlineqn/nlsq.html">
     4.7. Nonlinear least squares
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../nonlineqn/next.html">
     4.8. Next steps
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../localapprox/overview.html">
   5. Piecewise interpolation
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../localapprox/interpolation.html">
     5.1. The interpolation problem
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../localapprox/pwlin.html">
     5.2. Piecewise linear interpolation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../localapprox/splines.html">
     5.3. Cubic splines
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../localapprox/finitediffs.html">
     5.4. Finite differences
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../localapprox/fd-converge.html">
     5.5. Convergence of finite differences
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../localapprox/integration.html">
     5.6. Numerical integration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../localapprox/adaptive.html">
     5.7. Adaptive integration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../localapprox/next.html">
     5.8. Next steps
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../ivp/overview.html">
   6. Initial-value problems for ODEs
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../ivp/basics.html">
     6.1. Basics of IVPs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ivp/euler.html">
     6.2. Euler’s method
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ivp/systems.html">
     6.3. IVP systems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ivp/rk.html">
     6.4. Runge–Kutta methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ivp/adaptive.html">
     6.5. Adaptive Runge–Kutta
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ivp/multistep.html">
     6.6. Multistep methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ivp/implicit.html">
     6.7. Implementation of multistep methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ivp/zerostability.html">
     6.8. Zero-stability of multistep methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ivp/next.html">
     6.9. Next steps
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../matrixanaly/overview.html">
   7. Matrix analysis
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../matrixanaly/insight.html">
     7.1. From matrix to insight
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../matrixanaly/evd.html">
     7.2. Eigenvalue decomposition
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../matrixanaly/svd.html">
     7.3. Singular value decomposition
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../matrixanaly/symm-eig.html">
     7.4. Symmetry and definiteness
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../matrixanaly/dimreduce.html">
     7.5. Dimension reduction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../matrixanaly/next.html">
     7.6. Next steps
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../krylov/overview.html">
   8. Krylov methods in linear algebra
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../krylov/structure.html">
     8.1. Sparsity and structure
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../krylov/power.html">
     8.2. Power iteration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../krylov/inviter.html">
     8.3. Inverse iteration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../krylov/subspace.html">
     8.4. Krylov subspaces
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../krylov/gmres.html">
     8.5. GMRES
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../krylov/minrescg.html">
     8.6. MINRES and conjugate gradients
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../krylov/matrixfree.html">
     8.7. Matrix-free iterations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../krylov/precond.html">
     8.8. Preconditioning
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../krylov/next.html">
     8.9. Next steps
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../globalapprox/overview.html">
   9. Global function approximation
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../globalapprox/polynomial.html">
     9.1. Polynomial interpolation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../globalapprox/barycentric.html">
     9.2. The barycentric formula
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../globalapprox/stability.html">
     9.3. Stability of polynomial interpolation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../globalapprox/orthogonal.html">
     9.4. Orthogonal polynomials
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../globalapprox/trig.html">
     9.5. Trigonometric interpolation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../globalapprox/integration.html">
     9.6. Spectrally accurate integration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../globalapprox/improper.html">
     9.7. Improper integrals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../globalapprox/next.html">
     9.8. Next steps
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../bvp/overview.html">
   10. Boundary-value problems
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../bvp/tpbvp.html">
     10.1. Two-point BVP
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../bvp/shooting.html">
     10.2. Shooting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../bvp/diffmats.html">
     10.3. Differentiation matrices
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../bvp/linear.html">
     10.4. Collocation for linear problems
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../bvp/nonlinear.html">
     10.5. Nonlinearity and boundary conditions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../bvp/galerkin.html">
     10.6. The Galerkin method
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../bvp/next.html">
     10.7. Next steps
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="overview.html">
   11. Diffusion equations
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="blackscholes.html">
     11.1. Black–Scholes equation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="methodlines.html">
     11.2. The method of lines
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="absstab.html">
     11.3. Absolute stability
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     11.4. Stiffness
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="boundaries.html">
     11.5. Boundaries
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="next.html">
     11.6. Next steps
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../advection/overview.html">
   12. Advection equations
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../advection/traffic.html">
     12.1. Traffic flow
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../advection/upwind.html">
     12.2. Upwinding and stability
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../advection/absstab.html">
     12.3. Absolute stability
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../advection/wave.html">
     12.4. The wave equation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../advection/next.html">
     12.5. Next steps
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../twodim/overview.html">
   13. Two-dimensional problems
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
  <label for="toctree-checkbox-13">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../twodim/tensorprod.html">
     13.1. Tensor-product discretizations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../twodim/diffadv.html">
     13.2. Two-dimensional diffusion and advection
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../twodim/laplace.html">
     13.3. Laplace and Poisson equations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../twodim/nonlinear.html">
     13.4. Nonlinear elliptic PDEs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../twodim/next.html">
     13.5. Next steps
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Appendices
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../appendix/linear-algebra.html">
   Review of linear algebra
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../appendix/glossary.html">
   Glossary
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../appendix/julia.html">
   Julia cheatsheet
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../refs.html">
   References
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../genindex.html">
   Index
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        <a class="dropdown-buttons"
            href="../_sources/diffusion/stiffness.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download notebook file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/diffusion/stiffness.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/tobydriscoll/tobydriscoll.github.io/master?urlpath=tree/diffusion/stiffness.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#linearization">
   Linearization
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#freezing-time">
   Freezing time
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#multiple-time-scales">
   Multiple time scales
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-stability">
   A-stability
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercises">
   Exercises
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="stiffness">
<span id="section-diffusion-stiffness"></span><h1><span class="section-number">11.4. </span>Stiffness<a class="headerlink" href="#stiffness" title="Permalink to this headline">¶</a></h1>
<p>In <a class="reference internal" href="absstab.html#section-diffusion-absstab"><span class="std std-numref">Section 11.3</span></a> we analyzed time step constraints for the semidiscrete heat equation, <span class="math notranslate nohighlight">\(\mathbf{u}'=\mathbf{D}_{xx}\mathbf{u}\)</span>, in terms of stability regions and the eigenvalues <span class="math notranslate nohighlight">\(\lambda_j\)</span> of the matrix. Since all the eigenvalues are negative and real, the one farthest from the origin, at about <span class="math notranslate nohighlight">\(-4/h^2\)</span>, determines the specific time step restriction. For an explicit method (or any method with a finite intersection with the negative real axis), the conclusion is <span class="math notranslate nohighlight">\(\tau=O(h^2)\)</span>.</p>
<p>For the Euler and backward Euler solvers, stability is not the only cause of a severely limited time step. Both methods are first-order accurate, with truncation errors that are <span class="math notranslate nohighlight">\(O(\tau)\)</span>. Since the spatial discretization we chose is second-order accurate, then we should choose <span class="math notranslate nohighlight">\(\tau=O(h^2)\)</span> for accuracy as well as stability.</p>
<p>This calculus changes for second-order IVP solvers. When both time and space are discretized at second order, the total truncation error is <span class="math notranslate nohighlight">\(O(h^2+\tau^2)\)</span>, so it makes sense to use <span class="math notranslate nohighlight">\(\tau=O(h)\)</span> for accuracy reasons alone. Therefore, a stability restriction of <span class="math notranslate nohighlight">\(\tau=O(h^2)\)</span> is much more strict.</p>
<p id="index-0">Problems for which the time step is dictated by stability rather than accuracy are referred to as <strong>stiff</strong>. Stiffness is not a binary condition but a spectrum. It can arise in nonlinear problems and in problems having nothing to do with diffusion. Except for the mildest instances of stiffness, an implicit time stepping method is the best choice.</p>
<div class="section" id="linearization">
<h2>Linearization<a class="headerlink" href="#linearization" title="Permalink to this headline">¶</a></h2>
<p>Why should the model equation <span class="math notranslate nohighlight">\(y'=\lambda y\)</span> of absolute stability have wide relevance? Through diagonalization, it is easily generalized to  <span class="math notranslate nohighlight">\(\mathbf{u}'=\mathbf{A} \mathbf{u}\)</span> for a constant matrix <span class="math notranslate nohighlight">\(\mathbf{A}\)</span>. But that is still a severely limited type of problem.</p>
<p>Consider a general vector nonlinear system</p>
<div class="math notranslate nohighlight" id="equation-stiffsystem">
<span class="eqno">(11.4.1)<a class="headerlink" href="#equation-stiffsystem" title="Permalink to this equation">¶</a></span>\[\mathbf{u}'=\mathbf{f}(t,\mathbf{u}).\]</div>
<p>The key to making a connection with absolute stability is to look not at an exact solution but to <em>perturbations</em> of one. Such perturbations always exist in real numerical solutions, such as those due to roundoff error, for example. But if we assume the perturbations are tiny, then we can use linear approximations to describe their evolution. If we conclude from such an approximation that the perturbation may grow without bound, then we must seriously question the value of the numerical solution.</p>
<p>Let’s introduce more precision into the discussion. Suppose that <span class="math notranslate nohighlight">\(\hat{\mathbf{u}}(t)\)</span> is an exact solution that we wish to track, and that a perturbation has pushed us to a nearby solution curve <span class="math notranslate nohighlight">\(\hat{\mathbf{u}}(t) + \mathbf{v}(t)\)</span>. Substituting this solution into the governing ODE and appealing to a multidimensional Taylor series, we derive</p>
<div class="math notranslate nohighlight">
\[\begin{split}[\hat{\mathbf{u}}(t) + \mathbf{v}(t)]' &amp;= \mathbf{f}\bigl(t,\hat{\mathbf{u}}(t) + \mathbf{v}(t)\bigr) \\
\hat{\mathbf{u}}'(t) + \mathbf{v}'(t) &amp;= \mathbf{f}\left(t, \hat{\mathbf{u}}(t)\right) + \mathbf{J}(t) \mathbf{v}(t) + O\bigl( \|\mathbf{v}(t)\|^2 \bigr).\end{split}\]</div>
<p id="index-1">We have introduced the Jacobian matrix <span class="math notranslate nohighlight">\(\mathbf{J}\)</span>, with entries</p>
<div class="math notranslate nohighlight" id="equation-odejacobian">
<span class="eqno">(11.4.2)<a class="headerlink" href="#equation-odejacobian" title="Permalink to this equation">¶</a></span>\[J_{ij} = \frac{\partial f_i}{\partial u_j}(t,\hat{\mathbf{u}}(t)).\]</div>
<p>By dropping the higher-order terms, which are negligible at least initially, we derive a linear ODE for the evolution of the perturbation.</p>
<div class="proof proof-type-definition" id="id2">
<span id="definition-stiffness-linearization"></span><span id="index-2"></span><div class="proof-title"> <span class="proof-type">Definition 11.4.1</span>  <span class="proof-title-name">: &nbsp;Linearization of an ODE</span>  </div><div class="proof-content">
<p>A <strong>linearization</strong> of system <a class="reference internal" href="#equation-stiffsystem">(11.4.1)</a> at an exact solution <span class="math notranslate nohighlight">\(\hat{\mathbf{u}}(t)\)</span> is</p>
<div class="math notranslate nohighlight" id="equation-odelinearization">
<span class="eqno">(11.4.3)<a class="headerlink" href="#equation-odelinearization" title="Permalink to this equation">¶</a></span>\[\mathbf{v}'(t) = \mathbf{J}(t) \mathbf{v}(t),\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{v}(t)\)</span> is a perturbation to the exact solution, and <span class="math notranslate nohighlight">\(\mathbf{J}\)</span> is the Jacobian matrix <a class="reference internal" href="#equation-odejacobian">(11.4.2)</a>.</p>
</div></div><div class="proof proof-type-example" id="id3">
<span id="example-stiffness-oregon"></span><span id="index-3"></span><div class="proof-title"> <span class="proof-type">Example 11.4.2</span>  </div><div class="proof-content">
<p>The <strong>Oregonator</strong> is a well-known ODE system modeling a chemical oscillator and is given by</p>
<div class="math notranslate nohighlight" id="equation-oregonator">
<span class="eqno">(11.4.4)<a class="headerlink" href="#equation-oregonator" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{split}
u_1'  &amp; = s[u_2(1-u_1) + u_1(1-q u_1)] \\
u_2'  &amp; = s^{-1}(u_3-u_2-u_1u_2)      \\
u_3'  &amp; = w(u_1-u_3),
\end{split}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(s\)</span>, <span class="math notranslate nohighlight">\(q\)</span>, and <span class="math notranslate nohighlight">\(w\)</span> are constants. Linearization about an exact (albeit unknown) solution <span class="math notranslate nohighlight">\(\hat{\mathbf{u}}(t)\)</span> leads to the Jacobian</p>
<div class="math notranslate nohighlight" id="equation-oregonator-jac">
<span class="eqno">(11.4.5)<a class="headerlink" href="#equation-oregonator-jac" title="Permalink to this equation">¶</a></span>\[\begin{split}\mathbf{J} (t) =
\begin{bmatrix}
  s(1 -\hat{u}_2 - 2q\hat{u}_1) &amp; s(1-\hat{u}_1)  &amp; 0             \\
  -\hat{u}_2/s          &amp; -(1+\hat{u}_1)/s &amp; 1/s           \\
  w                  &amp; 0             &amp; -w
\end{bmatrix}.\end{split}\]</div>
</div></div></div>
<div class="section" id="freezing-time">
<h2>Freezing time<a class="headerlink" href="#freezing-time" title="Permalink to this headline">¶</a></h2>
<p>While <a class="reference internal" href="#equation-odelinearization">(11.4.3)</a> is linear, the Jacobian matrix in it is time-dependent, which makes analysis difficult. If a perturbation is introduced at a moment <span class="math notranslate nohighlight">\(t=t_\star\)</span>, we freeze the Jacobian there and consider</p>
<div class="math notranslate nohighlight">
\[\mathbf{v}'=\mathbf{A}\mathbf{v}, \quad \mathbf{A}=\mathbf{J}(t_\star).\]</div>
<p>This equation is of the type we used in <a class="reference internal" href="absstab.html#section-diffusion-absstab"><span class="std std-numref">Section 11.3</span></a> to discuss the absolute stability of IVP solvers. This suggests the following.</p>
<div class="proof proof-type-observation">
<div class="proof-title"> <span class="proof-type">Observation </span>  <span class="proof-title-name">: &nbsp;Rule of thumb for absolute stability</span>  </div><div class="proof-content">
<p>The eigenvalues of the Jacobian appearing in the linearization about an exact solution, after scaling by the time step <span class="math notranslate nohighlight">\(\tau\)</span>, must lie in the stability region of the IVP solver.</p>
</div></div><p>We have not stated a theorem here, because we made several approximations and assumptions along the way that are not trivial to quantify. Nevertheless, if the rule of thumb is violated, we should expect perturbations to the exact solution to grow significantly with time, eventually rendering the numerical solution useless. Note that roundoff error is constantly introducing perturbations, so the rule of thumb applies along the entire trajectory of the numerical solution.</p>
<div class="proof proof-type-demo" id="id4">
<span id="demo-stiffness-oregon"></span><div class="proof-title"> <span class="proof-type">Demo 11.4.3</span>  </div><div class="proof-content">
</div></div><div class='demo'><p>In <a class="reference internal" href="#example-stiffness-oregon"><span class="std std-numref">Example 11.4.2</span></a> we derived a Jacobian matrix for the Oregonator model. Here is a numerical solution of the ODE.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="k">function</span> <span class="n">ode</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>
    <span class="n">s</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">q</span> <span class="o">=</span> <span class="n">p</span>
    <span class="n">f</span> <span class="o">=</span> <span class="p">[</span> 
        <span class="n">s</span><span class="o">*</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">q</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">])),</span>
        <span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="n">u</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">/</span><span class="n">s</span><span class="p">,</span>   
        <span class="n">w</span><span class="o">*</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">u</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
        <span class="p">]</span>
    <span class="k">return</span> <span class="n">f</span>
<span class="k">end</span>

<span class="n">s</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">q</span> <span class="o">=</span> <span class="mf">77.27</span><span class="p">,</span><span class="mf">.161</span><span class="p">,</span><span class="mf">8.375e-6</span>
<span class="n">oregon</span> <span class="o">=</span> <span class="n">ODEProblem</span><span class="p">(</span><span class="n">ode</span><span class="p">,[</span><span class="mf">1.</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">500.</span><span class="p">),[</span><span class="n">s</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">q</span><span class="p">])</span>
<span class="n">sol</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">oregon</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">sol</span><span class="p">,</span><span class="n">yscale</span><span class="o">=</span><span class="ss">:log10</span><span class="p">,</span><span class="n">legend</span><span class="o">=</span><span class="ss">:none</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s">&quot;Solution of the Oregonator&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/stiffness_2_0.svg" src="../_images/stiffness_2_0.svg" /></div>
</div>
<p>At each value of the numerical solution, we can compute the eigenvalues of the Jacobian. Here we plot all of those eigenvalues in the complex plane.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="p">,</span><span class="n">u</span> <span class="o">=</span> <span class="n">sol</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="o">:</span><span class="mi">2</span><span class="o">:</span><span class="k">end</span><span class="p">],</span><span class="n">sol</span><span class="o">.</span><span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="o">:</span><span class="mi">2</span><span class="o">:</span><span class="k">end</span><span class="p">]</span>
<span class="n">λ</span> <span class="o">=</span> <span class="n">fill</span><span class="p">(</span><span class="mf">0.0</span><span class="nb">im</span><span class="p">,</span><span class="n">length</span><span class="p">(</span><span class="n">t</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span>
<span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">u</span><span class="p">)</span> <span class="k">in</span> <span class="n">enumerate</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
    <span class="n">J</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">s</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">u</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="mi">2</span><span class="n">q</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="n">s</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>        <span class="mi">0</span> 
         <span class="o">-</span><span class="n">u</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="n">s</span>       <span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="n">s</span>     <span class="mi">1</span><span class="o">/</span><span class="n">s</span> 
            <span class="n">w</span>               <span class="mi">0</span>           <span class="o">-</span><span class="n">w</span>
        <span class="p">]</span>
    <span class="n">λ</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="o">:</span><span class="p">]</span> <span class="o">.=</span> <span class="n">eigvals</span><span class="p">(</span><span class="n">J</span><span class="p">)</span>
<span class="k">end</span>

<span class="n">scatter</span><span class="p">(</span><span class="n">real</span><span class="p">(</span><span class="n">λ</span><span class="p">),</span><span class="n">imag</span><span class="p">(</span><span class="n">λ</span><span class="p">),</span><span class="n">t</span><span class="p">,</span>
    <span class="n">xaxis</span><span class="o">=</span><span class="p">(</span><span class="s">&quot;Re(λ)&quot;</span><span class="p">,</span><span class="mi">25000</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="o">:</span><span class="mi">2</span><span class="o">:-</span><span class="mi">1</span><span class="p">)),</span><span class="n">ylabel</span><span class="o">=</span><span class="s">&quot;Im(λ)&quot;</span><span class="p">,</span><span class="n">zlabel</span><span class="o">=</span><span class="s">&quot;t&quot;</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s">&quot;Oregonator eigenvalues&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/stiffness_4_0.svg" src="../_images/stiffness_4_0.svg" /></div>
</div>
<p>You can see that there is one eigenvalue that ranges over a wide portion of the negative real axis and dominates stability considerations.</p>
</div></div>
<div class="section" id="multiple-time-scales">
<h2>Multiple time scales<a class="headerlink" href="#multiple-time-scales" title="Permalink to this headline">¶</a></h2>
<p>The solution to <span class="math notranslate nohighlight">\(y' = \lambda y\)</span>, <span class="math notranslate nohighlight">\(y(0)=1\)</span> is <span class="math notranslate nohighlight">\(\exp(\lambda t)\)</span>. If <span class="math notranslate nohighlight">\(\lambda\)</span> is real, this solution grows or decays by a factor of <span class="math notranslate nohighlight">\(e\)</span> <span class="math notranslate nohighlight">\(t=1/|\lambda|\)</span>. If <span class="math notranslate nohighlight">\(\lambda = i\omega\)</span> is imaginary, then the solution has sines and cosines of frequency <span class="math notranslate nohighlight">\(\omega\)</span>. A complex <span class="math notranslate nohighlight">\(\lambda\)</span> combines these effects.</p>
<div class="proof proof-type-observation">
<div class="proof-title"> <span class="proof-type">Observation </span>  </div><div class="proof-content">
<p>We may regard <span class="math notranslate nohighlight">\(|\lambda|^{-1}\)</span>, which has units of time, as a characteristic time scale of dynamics due to eigenvalue <span class="math notranslate nohighlight">\(\lambda\)</span>.</p>
</div></div><p>A Jacobian matrix with eigenvalues at different orders of magnitude therefore implies multiple time scales that the IVP solver needs to cope with. Say <span class="math notranslate nohighlight">\(|\lambda_1|\gg |\lambda_2|\)</span>. Any explicit integrator will have a bounded stability region and therefore impose a time step restriction proportional to <span class="math notranslate nohighlight">\(|\lambda_1|^{-1}\)</span>. Any good adaptive integrator will obey such a restriction naturally to control the error. But to observe the “slow” part of the solution, the simulation must go on for a time on the order of <span class="math notranslate nohighlight">\(|\lambda_2|^{-1}\)</span>, which is much longer.</p>
<p>In <a class="reference internal" href="#demo-stiffness-oregon"><span class="std std-numref">Demo 11.4.3</span></a>, for example, you can see a combination of fast changes and slow evolution.</p>
<div class="proof proof-type-demo" id="id5">
<span id="demo-stiffness-explicit"></span><div class="proof-title"> <span class="proof-type">Demo 11.4.4</span>  </div><div class="proof-content">
</div></div><div class='demo'><p>The <code class="docutils literal notranslate"><span class="pre">Rodas4P</span></code> solver is good for stiff problems, and needs few time steps to solve the Oregonator from <a class="reference internal" href="#demo-stiffness-oregon"><span class="std std-numref">Demo 11.4.3</span></a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">oregon</span> <span class="o">=</span> <span class="n">remake</span><span class="p">(</span><span class="n">oregon</span><span class="p">,</span><span class="n">tspan</span><span class="o">=</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">25.</span><span class="p">))</span>
<span class="n">sol</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">oregon</span><span class="p">,</span><span class="n">Rodas4P</span><span class="p">())</span>
<span class="n">println</span><span class="p">(</span><span class="s">&quot;Number of time steps for Rodas4P: </span><span class="si">$</span><span class="p">(</span><span class="n">length</span><span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">t</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="s">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number of time steps for Rodas4P: 127
</pre></div>
</div>
</div>
</div>
<p>But if we apply <a class="reference internal" href="../ivp/adaptive.html#function-rk23"><span class="std std-numref">Function 6.5.2</span></a> to the problem, the step size will be made small enough to cope with the large negative eigenvalue.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">t</span><span class="p">,</span><span class="n">u</span> <span class="o">=</span> <span class="n">FNC</span><span class="o">.</span><span class="n">rk23</span><span class="p">(</span><span class="n">oregon</span><span class="p">,</span><span class="mf">1e-4</span><span class="p">)</span>
<span class="n">println</span><span class="p">(</span><span class="s">&quot;Number of time steps for RK23: </span><span class="si">$</span><span class="p">(</span><span class="n">length</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="s">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number of time steps for RK23: 20773
</pre></div>
</div>
</div>
</div>
<p>Starting from the eigenvalues of the Jacobian matrix, we can find an effective <span class="math notranslate nohighlight">\(\zeta(t)\)</span> by multiplying with the local time step size.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">λ</span> <span class="o">=</span> <span class="n">fill</span><span class="p">(</span><span class="mf">1.0</span><span class="nb">im</span><span class="p">,</span><span class="n">length</span><span class="p">(</span><span class="n">t</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span>
<span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">u</span><span class="p">)</span> <span class="k">in</span> <span class="n">enumerate</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
    <span class="n">J</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">s</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">u</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="mi">2</span><span class="n">q</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="n">s</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>        <span class="mi">0</span> 
         <span class="o">-</span><span class="n">u</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="n">s</span>       <span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="n">s</span>     <span class="mi">1</span><span class="o">/</span><span class="n">s</span> 
            <span class="n">w</span>               <span class="mi">0</span>           <span class="o">-</span><span class="n">w</span>
        <span class="p">]</span>
    <span class="n">λ</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="o">:</span><span class="p">]</span> <span class="o">.=</span> <span class="n">eigvals</span><span class="p">(</span><span class="n">J</span><span class="p">)</span>
<span class="k">end</span>

<span class="n">ζ</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">.*</span><span class="n">λ</span><span class="p">[</span><span class="mi">1</span><span class="o">:</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">:</span><span class="p">]</span>
<span class="n">scatter</span><span class="p">(</span><span class="n">real</span><span class="p">(</span><span class="n">ζ</span><span class="p">),</span><span class="n">imag</span><span class="p">(</span><span class="n">ζ</span><span class="p">),</span><span class="n">m</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">xlabel</span><span class="o">=</span><span class="s">&quot;Re(ζ)&quot;</span><span class="p">,</span><span class="n">ylabel</span><span class="o">=</span><span class="s">&quot;Im(ζ)&quot;</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s">&quot;Oregonator stability&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/stiffness_10_0.svg" src="../_images/stiffness_10_0.svg" /></div>
</div>
<p>Roughly speaking, the <span class="math notranslate nohighlight">\(\zeta\)</span> values stay within or close to the RK2 stability region in <a class="reference internal" href="absstab.html#figure-stabreg-bd-rk"><span class="std std-numref">Fig. 11.3.2</span></a>. Momentary departures from the region are possible, but time stepping repeatedly in that situation would cause instability.</p>
</div></div>
<div class="section" id="a-stability">
<h2>A-stability<a class="headerlink" href="#a-stability" title="Permalink to this headline">¶</a></h2>
<p>In general, the larger the stability region, the more generous the stability time step restriction will be. In the specific context of a semidiscretization of the heat equation, we observed that the eigenvalues of the Jacobian reached a distance <span class="math notranslate nohighlight">\(O(h^{-2})\)</span> on the negative real axis. Consequently, any stability region that is bounded in the negative real direction will have a <span class="math notranslate nohighlight">\(\tau=O(h^2)\)</span> restriction; only the leading constant will change.</p>
<p>Hence it is desirable in stiff problems generally, and diffusion problems in particular, to have a stability region that is unbounded in at least the negative real direction.</p>
<div class="proof proof-type-definition" id="id6">
<span id="index-4"></span><div class="proof-title"> <span class="proof-type">Definition 11.4.5</span>  <span class="proof-title-name">: &nbsp;A(<span class="math notranslate nohighlight">\(\alpha\)</span>)- and A-stability</span>  </div><div class="proof-content">
<p>A stability region that includes a sector of angle <span class="math notranslate nohighlight">\(\alpha\)</span> in either direction from the negative real axis is called <strong>A(<span class="math notranslate nohighlight">\(\alpha\)</span>)-stable</strong>. A time stepping method whose stability region contains the entire left half-plane is called <strong>A-stable</strong>.</p>
</div></div><p>For the heat equation, A(<span class="math notranslate nohighlight">\(\alpha\)</span>)-stability for any <span class="math notranslate nohighlight">\(\alpha&gt;0\)</span> suffices for unconditional stability.</p>
<p>An A-stable method has a stability region that includes all eigenvalues having nonpositive real part. In other words, all perturbations which ought to be bounded in time actually are. When an A-stable method is used, time step size can be based on accuracy considerations alone.</p>
<p id="index-5">Referring to <a class="reference internal" href="absstab.html#figure-stabreg-ab-am"><span class="std std-numref">Fig. 11.3.1</span></a> and <a class="reference internal" href="absstab.html#figure-stabreg-bd-rk"><span class="std std-numref">Fig. 11.3.2</span></a>, the backward Euler (AM1) and trapezoid (AM2) formulas are the only A-stable methods we have encountered. In fact, more accurate A-stable methods are not easy to come by.</p>
<div class="proof proof-type-theorem" id="id7">
<span id="index-6"></span><div class="proof-title"> <span class="proof-type">Theorem 11.4.6</span>  <span class="proof-title-name">: &nbsp;Second Dahlquist stability barrier</span>  </div><div class="proof-content">
<p>An A-stable linear multistep method must be implicit and have order of accuracy no greater than 2.</p>
</div></div><p>Hence the trapezoid formula is as accurate as we can hope for in the family of A-stable linear multistep methods. The situation with Runge–Kutta methods is a little different, but not a great deal more favorable; we do not go into the details.</p>
</div>
<div class="section" id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">¶</a></h2>
<ol>
<li><p>✍ Write the mechanical oscillator <span class="math notranslate nohighlight">\(x''+cx'+kx=0\)</span> as a first-order linear system, <span class="math notranslate nohighlight">\(\mathbf{u}'=\mathbf{A}\mathbf{u}\)</span>. Show that if <span class="math notranslate nohighlight">\(c=k+1\)</span>, this system is stiff as <span class="math notranslate nohighlight">\(k\to\infty\)</span>.</p></li>
<li><p>This exercise is about the IVP <span class="math notranslate nohighlight">\(u'=\cos(t) - 200(u-\sin(t))\)</span>, <span class="math notranslate nohighlight">\(u(0)=0\)</span>.</p>
<p><strong>(a)</strong> ✍ Show that <span class="math notranslate nohighlight">\(u(t) = \sin(t)\)</span> is the exact solution, and find the linearization about this solution.</p>
<p><strong>(b)</strong> ✍ Find the lone eigenvalue of the Jacobian. What other time scale is also relevant in the solution?</p>
<p><strong>(c)</strong> ⌨ Use <a class="reference internal" href="../ivp/implicit.html#function-ab4"><span class="std std-numref">Function 6.7.1</span></a> (<code class="docutils literal notranslate"><span class="pre">ab4</span></code>) to solve the IVP over <span class="math notranslate nohighlight">\(t\in[0,\pi/2]\)</span> with <span class="math notranslate nohighlight">\(n=800,850,900,\ldots,1200\)</span> steps. By comparing to the exact solution, show that the method gets either no accurate digits or at least 11 accurate digits.</p>
</li>
<li><p>In <a class="reference internal" href="../ivp/systems.html#example-systems-coupledpendula"><span class="std std-numref">Example 6.3.5</span></a> we derived the following system for two pendulums hanging from a rod:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
      u_1' &amp;= u_3 \\
      u_2' &amp;= u_4 \\
      u_3' &amp;= -\gamma u_3 - \frac{g}{L}\sin u_1 + k(u_2-u_1) \\
      u_4' &amp;= -\gamma u_4 - \frac{g}{L}\sin u_2 + k(u_1-u_2).
    \end{align*}\]</div>
<p><strong>(a)</strong> ✍ Use the approximation <span class="math notranslate nohighlight">\(\sin x \approx x\)</span> to write the problem as a linear system.</p>
<p><strong>(b)</strong> ⌨ Compute the eigenvalues of the linear system with <span class="math notranslate nohighlight">\(\gamma=0.1\)</span>, <span class="math notranslate nohighlight">\(g/L=1\)</span>, and <span class="math notranslate nohighlight">\(k=10^d\)</span> for <span class="math notranslate nohighlight">\(d=0,1,\ldots,5\)</span>. How fast does the ratio of largest to smallest eigenvalue (in magnitude) grow, as a function of <span class="math notranslate nohighlight">\(k\)</span>?</p>
</li>
<li><p>The equation <span class="math notranslate nohighlight">\(u'=u^2-u^3\)</span> is a simple model for combustion of a flame ball in microgravity. (This problem is adapted from section 7.9 of <span id="id1">[<a class="reference internal" href="../refs.html#id47">Mol10</a>]</span>.) After “ignition,” the exact solution rapidly approaches 1.</p>
<p><strong>(a)</strong> ⌨ Solve the problem with initial condition <span class="math notranslate nohighlight">\(u(0) =0.001\)</span> for <span class="math notranslate nohighlight">\(0\le t \le 2000\)</span>, using <a class="reference internal" href="../ivp/rk.html#function-rk4"><span class="std std-numref">Function 6.4.4</span></a> with <span class="math notranslate nohighlight">\(n=2000\)</span> steps. Plot the solution.</p>
<p><strong>(b)</strong> ✍ Find the <span class="math notranslate nohighlight">\(1\times 1\)</span> Jacobian of this system, and use it with <a class="reference internal" href="absstab.html#figure-stabreg-bd-rk"><span class="std std-numref">Fig. 11.3.2</span></a> to derive an upper bound on the time step of RK4 when <span class="math notranslate nohighlight">\(u=1\)</span>.</p>
<p><strong>(c)</strong> ⌨ Repeat part (a) with <span class="math notranslate nohighlight">\(n=200,300,\ldots,1000\)</span>, and make a table of the error at the final time, assuming the exact solution is 1. How do the results relate to part (b)?</p>
</li>
<li id="index-7"><p>The <em>van der Pol equation</em> is a famous nonlinear oscillator given by</p>
<div class="math notranslate nohighlight" id="equation-vanderpol">
<span class="eqno">(11.4.6)<a class="headerlink" href="#equation-vanderpol" title="Permalink to this equation">¶</a></span>\[  y'' - \mu(1-y^2)y' + y = 0,\]</div>
<p>where <span class="math notranslate nohighlight">\(\mu\ge 1\)</span> is a constant.</p>
<p><strong>(a)</strong> ✍ Write the equation as a first-order system and find its Jacobian.</p>
<p><strong>(b)</strong> ✍ Find the eigenvalues of the Jacobian when <span class="math notranslate nohighlight">\(y=\pm 2\)</span> and <span class="math notranslate nohighlight">\(y'=0\)</span>.</p>
<p><strong>(c)</strong> ⌨ Solve the problem <code class="docutils literal notranslate"><span class="pre">solve</span></code> with <span class="math notranslate nohighlight">\(\mu=500\)</span>, <span class="math notranslate nohighlight">\(y(0) = y'(0) = 1\)</span>, for <span class="math notranslate nohighlight">\(0\le t \le 2000\)</span>. Plot <span class="math notranslate nohighlight">\(y(t)\)</span> as a function of <span class="math notranslate nohighlight">\(t\)</span>.</p>
<p><strong>(d)</strong> ⌨ Define <span class="math notranslate nohighlight">\(M(t)\)</span> as the minimum (i. e., most negative) real part of the eigenvalues of the Jacobian using the computed solution at time <span class="math notranslate nohighlight">\(t\)</span>. Evaluate <span class="math notranslate nohighlight">\(M\)</span> for each <span class="math notranslate nohighlight">\(t=0,2,4,6,\ldots,2000\)</span>, and plot <span class="math notranslate nohighlight">\(M(t)\)</span>. Explain how your plot relates to parts (b) and (c).</p>
</li>
</ol>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "julia-1.6"
        },
        kernelOptions: {
            kernelName: "julia-1.6",
            path: "./diffusion"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'julia-1.6'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="absstab.html" title="previous page"><span class="section-number">11.3. </span>Absolute stability</a>
    <a class='right-next' id="next-link" href="boundaries.html" title="next page"><span class="section-number">11.5. </span>Boundaries</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Tobin A. Driscoll and Richard J. Braun<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>