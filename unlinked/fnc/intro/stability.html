

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Stability &#8212; Fundamentals of Numerical Computation</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/sphinx-book-theme.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/mystnb.js"></script>
    <script src="../_static/proof.js"></script>
    <script src="../_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .secondtoggle, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"TeX": {"Macros": {"float": ["\\mathbb{F}"], "real": ["\\mathbb{R}"], "complex": ["\\mathbb{C}"], "nat": ["\\mathbb{N}"], "integer": ["\\mathbb{Z}"], "rmn{([^}]*)}{([^}]*)}": ["\\mathbb{R}^{#1 \\times #2}", 2], "dd{([^}]*)}{([^}]*)}": ["\\frac{d #1}{d #2}", 2], "ddd{([^}]*)}{([^}]*)}": ["\\frac{d^2 #1}{d #2^2}", 2], "pp{([^}]*)}{([^}]*)}": ["\\frac{\\partial #1}{\\partial #2}", 2], "ppp{([^}]*)}{([^}]*)}": ["\\frac{\\partial^2 #1}{\\partial #2^2}", 2], "ppdd{([^}]*)}{([^}]*)}{([^}]*)}": ["\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}", 3], "norm{([^}]*)}": ["\\| #1 \\|", 1], "twonorm{([^}]*)}": ["\\| #1 \\|_2", 1], "onenorm{([^}]*)}": ["\\| #1 \\|_1", 1], "infnorm{([^}]*)}": ["\\| #1 \\|_\\infty", 1], "anynorm{([^}]*)}{([^}]*)}": ["\\| #1 \\|_#2", 2], "innerprod{([^}]*)}{([^}]*)}": ["\\langle #1,#2 \\rangle", 2], "pr{([^}]*)}": ["^{(#1)}", 1], "kron{([^}]*)}{([^}]*)}": ["#1 \\otimes #2", 2], "eye{([^}]*)}": ["\\mathbf{e}_#1", 1], "meye": ["\\mathbf{I}"], "Qhat": ["\\hat{\\mathbf{Q}}"], "Rhat": ["\\hat{\\mathbf{R}}"], "bfalpha": ["\\mathbf{alpha}"], "bfdelta": ["\\mathbf{delta}"], "bfzero": ["\\boldsymbol{0}"], "macheps": ["\\epsilon_\\text{mach}"], "fl": ["\\operatorname{fl}"], "diag": ["\\operatorname{diag}"], "ign": ["\\operatorname{sign}"], "Re": ["\\operatorname{Re}"], "Im": ["\\operatorname{Im}"], "ee": ["\\times 10^"], "lnorm": ["\\|"], "rnorm": ["\\|"], "floor": ["\\lfloor#1\\rfloor", 1]}}})</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Square linear systems" href="../linsys/overview.html" />
    <link rel="prev" title="Algorithms" href="algorithms.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Fundamentals of Numerical Computation</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  
  <ul class="nav sidenav_l1">
  <li class="">
    <a href="../frontmatter.html">Front matter</a>
  </li>
  <li class="active">
    <a href="overview.html">Introduction</a>
  <ul class="nav sidenav_l2">
    <li class="">
      <a href="floating-point.html">Floating-point numbers</a>
    </li>
    <li class="">
      <a href="conditioning.html">Problems and conditioning</a>
    </li>
    <li class="">
      <a href="algorithms.html">Algorithms</a>
    </li>
    <li class="active">
      <a href="">Stability</a>
    </li>
  </ul>
  </li>
  <li class="">
    <a href="../linsys/overview.html">Square linear systems</a>
  </li>
  <li class="">
    <a href="../leastsq/overview.html">Overdetermined linear systems</a>
  </li>
  <li class="">
    <a href="../nonlineqn/overview.html">Roots of nonlinear equations</a>
  </li>
  <li class="">
    <a href="../localapprox/overview.html">Piecewise interpolation</a>
  </li>
  <li class="">
    <a href="../ivp/overview.html">Initial-value problems for ODEs</a>
  </li>
  <li class="">
    <a href="../appendix/linear-algebra.html">Review: Linear algebra</a>
  </li>
  <li class="">
    <a href="../appendix/demos.html">All demo notebooks</a>
  </li>
  <li class="">
    <a href="../genindex.html">Index</a>
  </li>
</ul>
</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse" data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu" aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation" title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
            <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i class="fas fa-download"></i></button>

            
            <div class="dropdown-buttons">
                <!-- ipynb file if we had a myst markdown file -->
                
                <!-- Download raw file -->
                <a class="dropdown-buttons" href="../_sources/intro/stability.md.txt"><button type="button" class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip" data-placement="left">.md</button></a>
                <!-- Download PDF via print -->
                <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF" onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
            </div>
            
        </div>

        <!-- Edit this page -->
        

        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->
        
    </div>
    <div class="d-none d-md-block col-md-2 bd-toc show">
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#case-study" class="nav-link">Case study</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#backward-error" class="nav-link">Backward error</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#exercises" class="nav-link">Exercises</a>
        </li>
    
    </ul>
</nav>


    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="stability">
<h1>Stability<a class="headerlink" href="#stability" title="Permalink to this headline">Â¶</a></h1>
<p>If we solve a problem using a computer algorithm and see a large error in the result, we might suspect poor conditioning in the original mathematical problem. But algorithms can also be sources of errors. When error in the result of an algorithm exceeds what conditioning can explain, we call the algorithm <a class="reference internal" href="overview.html#term-unstable"><span class="xref std std-term">unstable</span></a>.</p>
<div class="section" id="case-study">
<h2>Case study<a class="headerlink" href="#case-study" title="Permalink to this headline">Â¶</a></h2>
<p>In <a class="reference internal" href="conditioning.html#sec-conditioning-multidim"><span class="std std-ref">Multidimensional problems</span></a> we showed that finding the roots of a quadratic polynomial <span class="math notranslate nohighlight">\(ax^2 + b x+c\)</span> is poorly conditioned if and only if the roots are close to each other relative to their size. Thus, for the polynomial</p>
<div class="math notranslate nohighlight" id="equation-quadunstable">
<span class="eqno">(20)<a class="headerlink" href="#equation-quadunstable" title="Permalink to this equation">Â¶</a></span>\[p(x) = (x-10^6)(x-10^{-6}) = x^2 - (10^6+10^{-6})x + 1,\]</div>
<p>finding roots is a very well conditioned problem. An obvious algorithm for finding those roots is to directly apply the quadratic formula:</p>
<div class="math notranslate nohighlight" id="equation-quadform">
<span class="eqno">(21)<a class="headerlink" href="#equation-quadform" title="Permalink to this equation">Â¶</a></span>\[x_1 = \frac{-b + \sqrt{b^2-4ac}}{2a}, \qquad
x_2 = \frac{-b - \sqrt{b^2-4ac}}{2a}.\]</div>
<div class="proof proof-type-demo">

    <div class="proof-title">
        <span class="proof-type">Demo </span>
        
    </div><div class="proof-content">
<p><a class="reference internal" href="demos/stability-quadbad.html"><span class="doc">Instability of the quadratic formula</span></a></p>
</div></div><p id="index-0"><a class="reference internal" href="demos/stability-quadbad.html"><span class="doc">Instability of the quadratic formula</span></a> suggests that the venerable quadratic formula is an <em>unstable</em> means of computing roots in finite precision. The roots themselves were not sensitive to the data or arithmeticâitâs the specific computational path we chose that caused the huge growth in errors. We can confirm this conclusion by finding a different path that avoids subtractive cancellation. A little algebra using <a class="reference internal" href="#equation-quadform">(21)</a> confirms the additional formula <span class="math notranslate nohighlight">\(x_1x_2=c/a\)</span>.  So given one root <span class="math notranslate nohighlight">\(r\)</span>, we compute the other root using <span class="math notranslate nohighlight">\(c/(ar)\)</span>, which has only multiplication and division and therefore creates no numerical trouble.</p>
<div class="proof proof-type-demo">

    <div class="proof-title">
        <span class="proof-type">Demo </span>
        
    </div><div class="proof-content">
<p><a class="reference internal" href="demos/stability-quadgood.html"><span class="doc">Stable alternative to the quadratic formula</span></a></p>
</div></div><div class="margin sidebar">
<p class="sidebar-title"></p>
<p>The sensitivity of the target problem is governed only by its condition number, but the sensitivity of an algorithm depends on the condition numbers of all of its steps.</p>
</div>
<p>Both algorithms for calculating roots are equivalent when using real numbers and exact arithmetic. When perturbations are introduced into each intermediate value, though, their effects may depend dramatically on the specific sequence of steps taken. The sensitivity of the target problem <span class="math notranslate nohighlight">\(f(x)\)</span> is governed only by <span class="math notranslate nohighlight">\(\kappa_f\)</span>, but the sensitivity of an algorithm depends on the condition numbers of all of its steps. In this example, the direct application of the quadratic formula included a poorly conditioned stepâsubtractive cancellationâthat can be avoided.</p>
<p>This situation may sound hopelessly complicated. But the elementary operations we take for granted are quite well conditioned in most circumstances. The glaring exceptions occur when <span class="math notranslate nohighlight">\(|f(x)|\)</span> is much smaller than <span class="math notranslate nohighlight">\(|x|\)</span>, which is not inherently hard to detect; however, not all such situations create sensitivity. A practical characterization of instability is that results are much less accurate than the conditioning of the problem suggests. Typically one should apply an algorithm to test problems whose answers are well known, or for which other programs are known to work well, in order to spot likely instabilities. In the rest of this book we will see some specific ways in which instability is manifested for different types of problems.</p>
</div>
<div class="section" id="backward-error">
<h2>Backward error<a class="headerlink" href="#backward-error" title="Permalink to this headline">Â¶</a></h2>
<p>In the presence of poor conditioning, even a good algorithm <span class="math notranslate nohighlight">\(\tilde{f}\)</span> for a problem <span class="math notranslate nohighlight">\(f\)</span> may not have a small error <span class="math notranslate nohighlight">\(|\tilde{f}(x)-f(x)|/|f(x)|\)</span>. Just the act of rounding the data to floating point may introduce a large change in the result. There is another way to characterize the error that can be a useful alternative measurement, as illustrated in <a class="reference internal" href="#fig-backwarderror"><span class="std std-numref">Fig. 1</span></a>.</p>
<div class="figure align-default" id="fig-backwarderror">
<img alt="../_images/backwarderror.svg" src="../_images/backwarderror.svg" /><p class="caption"><span class="caption-number">Fig. 1 </span><span class="caption-text">Illustration of backward error.</span><a class="headerlink" href="#fig-backwarderror" title="Permalink to this image">Â¶</a></p>
</div>
<p>Let <span class="math notranslate nohighlight">\(\tilde{y} = \tilde{f}(x)\)</span> be a computed result for the original data <span class="math notranslate nohighlight">\(x\)</span>. If there is a value <span class="math notranslate nohighlight">\(\tilde{x}\)</span> such that</p>
<div class="math notranslate nohighlight" id="equation-backwarderror">
<span class="eqno">(22)<a class="headerlink" href="#equation-backwarderror" title="Permalink to this equation">Â¶</a></span>\[f(\tilde{x}) = \tilde{y} = \tilde{f}(x),\]</div>
<p>then we call <span class="math notranslate nohighlight">\(|\tilde{x}-x|/|x|\)</span> the (relative) <a class="reference internal" href="overview.html#term-backward-error"><span class="xref std std-term">backward error</span></a> of the result. Instead of asking, âHow close is to the true answer is your answer?â, backward error asks, âHow close to the true question is the question you answered?â</p>
<div class="proof proof-type-demo">

    <div class="proof-title">
        <span class="proof-type">Demo </span>
        
    </div><div class="proof-content">
<p><a class="reference internal" href="demos/stability-roots.html"><span class="doc">Polynomial roots</span></a></p>
</div></div><div class="margin sidebar">
<p class="sidebar-title"></p>
<p>In an ill-conditioned problem, we can only hope for small backward error, not small error.</p>
</div>
<p>Small backward error is the best we can hope for in a poorly conditioned problem. Without getting into the formal details, know that if an algorithm always produces small backward errors, then it is stable. But the converse is not always true: some stable algorithms may produce a large backward error.</p>
<div class="proof proof-type-example" id="id1">
<span id="example-not-backward-stable"></span>
    <div class="proof-title">
        <span class="proof-type">Example 8</span>
        
    </div><div class="proof-content">
<p>One stable algorithm that is not backward stable is floating point evaluation for our old standby, <span class="math notranslate nohighlight">\(f(x)=x+1\)</span>. If <span class="math notranslate nohighlight">\(|x|&lt;\epsilon_\text{mach}/2\)</span>, then the computed result is <span class="math notranslate nohighlight">\(\tilde{f}(x)=1\)</span>, since there are no floating point numbers between <span class="math notranslate nohighlight">\(1\)</span> and <span class="math notranslate nohighlight">\(1+\epsilon_\text{mach}\)</span>. Hence the only possible choice for a real number <span class="math notranslate nohighlight">\(\tilde{x}\)</span> satisfying <a class="reference internal" href="#equation-backwarderror">(22)</a> is <span class="math notranslate nohighlight">\(\tilde{x}=0\)</span>. But then <span class="math notranslate nohighlight">\(|\tilde{x}-x|/|x|=1\)</span>, which indicates 100% backward error!</p>
</div></div></div>
<div class="section" id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">Â¶</a></h2>
<ol>
<li><p>The function</p>
<div class="math notranslate nohighlight">
\[f(x)=\frac{1-\cos x}{\sin x}\]</div>
<p>has a mathematically equivalent expression,</p>
<div class="math notranslate nohighlight">
\[\hat{f}(x) = = \frac{2\sin^2(x/2)}{\sin(x)}.\]</div>
<p><strong>(a)</strong> âï¸ Show that the relative condition numbers for these functions are the same. (You might want to use computer algebra to help; try simplifying their ratio to 1.)</p>
<p><strong>(b)</strong> âï¸ Estimate the number of digits lost to subtractive cancellation in the numerator of <span class="math notranslate nohighlight">\(f\)</span> when <span class="math notranslate nohighlight">\(x=10^{-6}\)</span>.</p>
<p><strong>(c)</strong> âï¸ The formula for <span class="math notranslate nohighlight">\(\hat{f}\)</span> uses only multiplication, division, and evaluation of the sine function; any potential loss of accuracy would be due to evaluating sin. Find</p>
<div class="math notranslate nohighlight">
\[\lim_{x\to 0} \kappa_\text{sin}(x).\]</div>
<p>d. â¨ï¸ Apply <span class="math notranslate nohighlight">\(f\)</span> and <span class="math notranslate nohighlight">\(\hat{f}\)</span> for <span class="math notranslate nohighlight">\(x=10^{-6}\)</span> and compute their relative difference.</p>
</li>
<li><p>Let <span class="math notranslate nohighlight">\(f(x) = (e^x-1)/x\)</span>.</p>
<p><strong>(a)</strong> âï¸ Find the condition number <span class="math notranslate nohighlight">\(\kappa_f(x)\)</span>. What is the maximum of <span class="math notranslate nohighlight">\(\kappa_f(x)\)</span> over <span class="math notranslate nohighlight">\(-1\le x \le 1\)</span>?</p>
<p><strong>(b)</strong> â¨ï¸  Use the âobviousâ algorithm</p>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">x</span>
</pre></div>
</div>
<p>to compute <span class="math notranslate nohighlight">\(f(x)\)</span> at <span class="math notranslate nohighlight">\(x=10^{-2},10^{-3},10^{-4},\ldots,10^{-11}\)</span>.</p>
<p><strong>(c)</strong> â¨ï¸ Use the first 8 terms of the Taylor series</p>
<div class="math notranslate nohighlight">
\[f(x) = 1 + \frac{1}{2!}x + \frac{1}{3!}x^2 + \frac{1}{4!}x^3 + \cdots\]</div>
<p>to create a second algorithm, and evaluate it at the same set of points.</p>
<p><strong>(d)</strong> â¨ï¸  Make a table of the relative difference between the two algorithms as a function of <span class="math notranslate nohighlight">\(x\)</span>. Which algorithm is more accurate, and why?</p>
</li>
<li><p>â¨ï¸ The function</p>
<div class="math notranslate nohighlight">
\[x = \cosh(y) = \frac{e^t + e^{-t}}{2}\]</div>
<p>can be inverted to yield a formula for <span class="math notranslate nohighlight">\(\operatorname{acosh}(x)\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-acosh">
<span class="eqno">(23)<a class="headerlink" href="#equation-acosh" title="Permalink to this equation">Â¶</a></span>\[y = \log\bigl(x-\sqrt{x^2-1}\bigr).\]</div>
<p>For the steps below, define <span class="math notranslate nohighlight">\(y_i=10^{-4i}\)</span> and <span class="math notranslate nohighlight">\(x_i=\cosh(y_i)\)</span> for <span class="math notranslate nohighlight">\(i=1,\dots,4\)</span>. Hence <span class="math notranslate nohighlight">\(y_i=\operatorname{acosh}(x_i)\)</span>.</p>
<p><strong>(a)</strong> Find the relative condition number of evaluating <span class="math notranslate nohighlight">\(f(x) = \operatorname{acosh}(x)\)</span>. (You can use <a class="reference internal" href="#equation-acosh">(23)</a>) or look up a formula for <span class="math notranslate nohighlight">\(f'\)</span> in a calculus book.)  Evaluate <span class="math notranslate nohighlight">\(\kappa_f\)</span> at all the <span class="math notranslate nohighlight">\(x_i\)</span>. You will find that the problem is well-conditioned at these inputs.</p>
<p><strong>(b)</strong> Use <a class="reference internal" href="#equation-acosh">(23)</a> to approximate <span class="math notranslate nohighlight">\(f(x_i)\)</span> for all <span class="math notranslate nohighlight">\(i\)</span>. Compute the relative accuracy of the results. What is the source of the observed inaccuracy?</p>
<p><strong>(c)</strong> An alternative fornula is</p>
<div class="math notranslate nohighlight" id="equation-acosh2">
<span class="eqno">(24)<a class="headerlink" href="#equation-acosh2" title="Permalink to this equation">Â¶</a></span>\[t = -2\log\left(\sqrt{\frac{x+1}{2}} + \sqrt{\frac{x-1}{2}}\right).\]</div>
<p>Apply <a class="reference internal" href="#equation-acosh2">(24)</a> to approximate <span class="math notranslate nohighlight">\(f(x_i)\)</span> for all <span class="math notranslate nohighlight">\(i\)</span>, again computing the relative accuracy of the results.</p>
</li>
<li><p>â¨ï¸ (Continuation of <a class="reference internal" href="algorithms.html#problem-samplevar"><span class="std std-ref">a previous problem</span></a>. Adapted from \cite{NHigham96}.) One problem with the formula <a class="reference internal" href="algorithms.html#equation-samplevar">(19)</a> for sample variance is that one computes a sum for <span class="math notranslate nohighlight">\(\overline{x}\)</span>, then another sum to find <span class="math notranslate nohighlight">\(s^2\)</span>. Some statistics textbooks quote a one-pass formula</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{split}
s^2 &amp;= \frac{1}{n-1} \left( u - \tfrac{1}{n}v^2 \right),\\
u &amp; = \sum_{i=1}^n x_i^2, \\
v &amp;= \sum_{i=1}^n x_i.
\end{split}\end{split}\]</div>
<p>âOne-passâ means that both <span class="math notranslate nohighlight">\(u\)</span> and <span class="math notranslate nohighlight">\(v\)</span> can be computed in a single loop. Try this formula for the two datasets</p>
<div class="highlight-julia notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span> <span class="mf">1e6</span><span class="p">,</span> <span class="mi">1</span><span class="o">+</span><span class="mf">1e6</span><span class="p">,</span> <span class="mi">2</span><span class="o">+</span><span class="mf">1e6</span><span class="p">]</span>
<span class="n">x</span> <span class="o">=</span> <span class="p">[</span> <span class="mf">1e9</span><span class="p">,</span> <span class="mi">1</span><span class="o">+</span><span class="mf">1e9</span><span class="p">,</span> <span class="mi">2</span><span class="o">+</span><span class="mf">1e9</span><span class="p">]</span>
</pre></div>
</div>
<p>computing the relative difference from the output of your earlier <code class="docutils literal notranslate"><span class="pre">samplevar</span></code> function. Explain the results.</p>
</li>
</ol>
</div>
</div>


              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="algorithms.html" title="previous page">Algorithms</a>
    <a class='right-next' id="next-link" href="../linsys/overview.html" title="next page">Square linear systems</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Tobin A. Driscoll and Richard J. Braun<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="../_static/js/index.js"></script>
    
  </body>
</html>