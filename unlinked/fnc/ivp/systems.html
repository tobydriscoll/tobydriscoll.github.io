

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Systems of differential equations &#8212; Fundamentals of Numerical Computation</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/sphinx-book-theme.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/mystnb.js"></script>
    <script src="../_static/proof.js"></script>
    <script src="../_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .secondtoggle, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"TeX": {"Macros": {"float": ["\\mathbb{F}"], "real": ["\\mathbb{R}"], "complex": ["\\mathbb{C}"], "nat": ["\\mathbb{N}"], "integer": ["\\mathbb{Z}"], "rmn{([^}]*)}{([^}]*)}": ["\\mathbb{R}^{#1 \\times #2}", 2], "dd{([^}]*)}{([^}]*)}": ["\\frac{d #1}{d #2}", 2], "ddd{([^}]*)}{([^}]*)}": ["\\frac{d^2 #1}{d #2^2}", 2], "pp{([^}]*)}{([^}]*)}": ["\\frac{\\partial #1}{\\partial #2}", 2], "ppp{([^}]*)}{([^}]*)}": ["\\frac{\\partial^2 #1}{\\partial #2^2}", 2], "ppdd{([^}]*)}{([^}]*)}{([^}]*)}": ["\\frac{\\partial^2 #1}{\\partial #2 \\partial #3}", 3], "norm{([^}]*)}": ["\\| #1 \\|", 1], "twonorm{([^}]*)}": ["\\| #1 \\|_2", 1], "onenorm{([^}]*)}": ["\\| #1 \\|_1", 1], "infnorm{([^}]*)}": ["\\| #1 \\|_\\infty", 1], "anynorm{([^}]*)}{([^}]*)}": ["\\| #1 \\|_#2", 2], "innerprod{([^}]*)}{([^}]*)}": ["\\langle #1,#2 \\rangle", 2], "pr{([^}]*)}": ["^{(#1)}", 1], "kron{([^}]*)}{([^}]*)}": ["#1 \\otimes #2", 2], "eye{([^}]*)}": ["\\mathbf{e}_#1", 1], "meye": ["\\mathbf{I}"], "Qhat": ["\\hat{\\mathbf{Q}}"], "Rhat": ["\\hat{\\mathbf{R}}"], "bfalpha": ["\\mathbf{alpha}"], "bfdelta": ["\\mathbf{delta}"], "bfzero": ["\\boldsymbol{0}"], "macheps": ["\\epsilon_\\text{mach}"], "fl": ["\\operatorname{fl}"], "diag": ["\\operatorname{diag}"], "ign": ["\\operatorname{sign}"], "Re": ["\\operatorname{Re}"], "Im": ["\\operatorname{Im}"], "ee": ["\\times 10^"], "lnorm": ["\\|"], "rnorm": ["\\|"], "floor": ["\\lfloor#1\\rfloor", 1]}}})</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Runge–Kutta methods" href="rk.html" />
    <link rel="prev" title="Euler’s method" href="euler.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Fundamentals of Numerical Computation</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  
  <ul class="nav sidenav_l1">
  <li class="">
    <a href="../frontmatter.html">Front matter</a>
  </li>
  <li class="">
    <a href="../intro/overview.html">Introduction</a>
  </li>
  <li class="">
    <a href="../linsys/overview.html">Square linear systems</a>
  </li>
  <li class="">
    <a href="../leastsq/overview.html">Overdetermined linear systems</a>
  </li>
  <li class="">
    <a href="../nonlineqn/overview.html">Roots of nonlinear equations</a>
  </li>
  <li class="">
    <a href="../localapprox/overview.html">Piecewise interpolation</a>
  </li>
  <li class="active">
    <a href="overview.html">Initial-value problems for ODEs</a>
  <ul class="nav sidenav_l2">
    <li class="">
      <a href="basics.html">Basics of IVPs</a>
    </li>
    <li class="">
      <a href="euler.html">Euler’s method</a>
    </li>
    <li class="active">
      <a href="">Systems of differential equations</a>
    </li>
    <li class="">
      <a href="rk.html">Runge–Kutta methods</a>
    </li>
    <li class="">
      <a href="adaptive.html">Adaptive Runge–Kutta</a>
    </li>
    <li class="">
      <a href="multistep.html">Multistep methods</a>
    </li>
    <li class="">
      <a href="implicit.html">Implementation of multistep methods</a>
    </li>
    <li class="">
      <a href="zerostability.html">Zero-stability of multistep methods</a>
    </li>
  </ul>
  </li>
  <li class="">
    <a href="../appendix/linear-algebra.html">Review: Linear algebra</a>
  </li>
  <li class="">
    <a href="../appendix/demos.html">All demo notebooks</a>
  </li>
  <li class="">
    <a href="../genindex.html">Index</a>
  </li>
</ul>
</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse" data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu" aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation" title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
            <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i class="fas fa-download"></i></button>

            
            <div class="dropdown-buttons">
                <!-- ipynb file if we had a myst markdown file -->
                
                <!-- Download raw file -->
                <a class="dropdown-buttons" href="../_sources/ivp/systems.md.txt"><button type="button" class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip" data-placement="left">.md</button></a>
                <!-- Download PDF via print -->
                <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF" onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
            </div>
            
        </div>

        <!-- Edit this page -->
        

        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->
        
    </div>
    <div class="d-none d-md-block col-md-2 bd-toc show">
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#transformation-of-high-order-systems" class="nav-link">Transformation of high-order systems</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#methods-for-ivp-systems" class="nav-link">Methods for IVP systems</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#new-demo-needed-here" class="nav-link">new demo needed here</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#exercises" class="nav-link">Exercises</a>
        </li>
    
    </ul>
</nav>


    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="systems-of-differential-equations">
<h1>Systems of differential equations<a class="headerlink" href="#systems-of-differential-equations" title="Permalink to this headline">¶</a></h1>
<p>Before we improve on Euler’s method, we will address a straightforward but critically important generalization of the problem. Very few applications involve an initial-value problem with just a single dependent variable. Most of the time there are multiple unknowns and a system of equations to define them.</p>
<div class="proof proof-type-example" id="id1">

    <div class="proof-title">
        <span class="proof-type">Example 63</span>
        
    </div><div class="proof-content">
<p>Variations of the following model are commonly seen in ecology and epidemiology:</p>
<div class="math notranslate nohighlight" id="equation-predprey">
<span class="eqno">(175)<a class="headerlink" href="#equation-predprey" title="Permalink to this equation">¶</a></span>\[\begin{split}  \begin{split}
    \frac{d y}{d t} &amp;= y(1-\alpha y) - \frac{yz}{1+\beta y} \\
    \frac{d z}{d t} &amp;= -z + \frac{yz}{1+\beta y},
  \end{split}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\alpha\)</span> and <span class="math notranslate nohighlight">\(\beta\)</span> are positive constants. This model is a system of two differential equations for the unknown functions <span class="math notranslate nohighlight">\(y(t)\)</span>, which could represent a prey species or susceptible host, and <span class="math notranslate nohighlight">\(z(t)\)</span>, which could represent a predator species or infected population.  We refer to this as a \index{predator–prey model}\textbf{predator–prey model}. Both of the equations involve both of the unknowns, with no clear way to separate them.</p>
<p>We can pack the two dependent variables <span class="math notranslate nohighlight">\(y\)</span> and <span class="math notranslate nohighlight">\(z\)</span> into a vector-valued function of time, <span class="math notranslate nohighlight">\(\mathbf{u}(t)\)</span>, writing</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{split}
  u_1'(t) &amp;= f_1(t,\mathbf{u}) =  u_1(1-au_1) - \frac{u_1 u_2}{1+bu_1}\\
  u_2'(t) &amp;= f_2(t,\mathbf{u}) = -u_2 + \frac{u_1 u_2}{1+bu_1}
\end{split}\end{split}\]</div>
<p>and identifying <span class="math notranslate nohighlight">\(u_1=y\)</span>, <span class="math notranslate nohighlight">\(u_2=z\)</span>.</p>
</div></div><p>The generic form of a first-order system IVP is</p>
<div class="math notranslate nohighlight" id="equation-ivpsys">
<span class="eqno">(176)<a class="headerlink" href="#equation-ivpsys" title="Permalink to this equation">¶</a></span>\[  \mathbf{u}'(t) = \mathbf{f}\bigl(t,\mathbf{u}(t)\bigr), \qquad a \le t \le b, \qquad
  \mathbf{u}(a)=\mathbf{u}_0,\]</div>
<p>where all of the boldface quantities are vectors in <span class="math notranslate nohighlight">\(\mathbb{R}^m\)</span> or <span class="math notranslate nohighlight">\(\mathbb{C}^m\)</span>. This is an initial-value problem for a <strong>first-order system of ODEs</strong>, and the number <span class="math notranslate nohighlight">\(m\)</span> of dependent variables (and equations) is called the <strong>dimension</strong> of the system. In particular, note that <span class="math notranslate nohighlight">\(\mathbf{f}\)</span> represents <span class="math notranslate nohighlight">\(m\)</span> scalar functions in <span class="math notranslate nohighlight">\(m+1\)</span> scalar variables, including time.</p>
<div class="proof proof-type-example" id="id2">

    <div class="proof-title">
        <span class="proof-type">Example 64</span>
        
    </div><div class="proof-content">
<p>Let <span class="math notranslate nohighlight">\(\mathbf{A}(t)\)</span> be an <span class="math notranslate nohighlight">\(m \times m\)</span> matrix whose entries depend on <span class="math notranslate nohighlight">\(t\)</span>. Then</p>
<div class="math notranslate nohighlight">
\[  \frac{d \mathbf{u}}{d t} = \mathbf{A}(t)\mathbf{u}\]</div>
<p>is a <strong>linear</strong> system of differential equations. If the matrix <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> is independent of time, it is a <strong>linear, constant-coefficient</strong> system.</p>
<p>The solution to a linear, constant-coefficient IVP, given also <span class="math notranslate nohighlight">\(\mathbf{u}(0)=\mathbf{u}_0\)</span>, is formally</p>
<div class="math notranslate nohighlight" id="equation-matrixexp">
<span class="eqno">(177)<a class="headerlink" href="#equation-matrixexp" title="Permalink to this equation">¶</a></span>\[  \mathbf{u}(t) = e^{t\mathbf{A}} \mathbf{u}_0,\]</div>
<p>where <span class="math notranslate nohighlight">\(e^{t\mathbf{A}}\)</span> is a <strong>matrix exponential</strong>, which can be defined using Taylor series or by other means. This result is a seamless generalization of the scalar case, <span class="math notranslate nohighlight">\(m=1\)</span>.</p>
<div class="proof proof-type-demo">

    <div class="proof-title">
        <span class="proof-type">Demo </span>
        
    </div><div class="proof-content">
<p><a class="reference internal" href="demos/systems-exp.html"><span class="doc">Matrix exponential</span></a></p>
</div></div><p>While the matrix exponential is a vital theoretical tool, computing it is too slow to be a practical numerical method.</p>
</div></div><p>The built-in IVP solvers all handle first-order systems. You must provide them with a function (either named or anonymous) that accepts the two arguments <span class="math notranslate nohighlight">\(t\)</span> and <span class="math notranslate nohighlight">\(\mathbf{u}\)</span> and returns <span class="math notranslate nohighlight">\(\mathbf{f}(t,\mathbf{u})\)</span>.</p>
<div class="proof proof-type-demo">

    <div class="proof-title">
        <span class="proof-type">Demo </span>
        
    </div><div class="proof-content">
<p><a class="reference internal" href="demos/systems-predator.html"><span class="doc">Predator-prey system</span></a></p>
</div></div><div class="section" id="transformation-of-high-order-systems">
<h2>Transformation of high-order systems<a class="headerlink" href="#transformation-of-high-order-systems" title="Permalink to this headline">¶</a></h2>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Every higher-order ODE system can be systematically transformed into a first-order system in a higher dimension.</p>
</div>
<p>Fortunately the ability to solve first-order ODE systems implies the ability to solve (most practical) systems of higher differential order, too. The reason is that there is a systematic way to turn a higher-order problem into a first-order one of higher dimension.</p>
<div class="proof proof-type-example" id="id3">
<span id="example-nlosc3"></span>
    <div class="proof-title">
        <span class="proof-type">Example 65</span>
        
    </div><div class="proof-content">
<p>Consider the nonlinear initial-value problem</p>
<div class="math notranslate nohighlight">
\[  y''+(1+y')^3 y = 0, \qquad y(0)= y_0, \quad y'(0) = 0.\]</div>
<p>In order to write this problem as a first order system we define two scalar unknown functions, <span class="math notranslate nohighlight">\(u_1 = y\)</span> and <span class="math notranslate nohighlight">\(u_2 = y'\)</span>. With these definitions, we have the two differential equations</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{split}
  u_1' &amp;= u_2 \\
  u_2' &amp;= -(1+u_2)^3 u_1,
\end{split}\end{split}\]</div>
<p>which is a first order system in two dimensions. The initial
condition of the system is</p>
<div class="math notranslate nohighlight">
\[  u_1(0) = y_0, \quad u_2(0) = 0.\]</div>
</div></div><div class="proof proof-type-example" id="id4">
<span id="example-coupledpendula"></span>
    <div class="proof-title">
        <span class="proof-type">Example 66</span>
        
    </div><div class="proof-content">
<p>Two identical pendula suspended from the same rod and swinging in parallel planes can be modeled as the second-order system</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{split}
  \theta_1''(t) +\gamma \theta_1' + \frac{g}{L} \sin \theta_1 +
  k(\theta_1-\theta_2) &amp;= 0\\
  \theta_2''(t) +\gamma \theta_2' + \frac{g}{L} \sin \theta_2 +
  k(\theta_2-\theta_1) &amp;= 0,
\end{split}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\theta_1\)</span> and <span class="math notranslate nohighlight">\(\theta_2\)</span> are angles made by the two pendula, <span class="math notranslate nohighlight">\(L\)</span> is the length of each pendulum, <span class="math notranslate nohighlight">\(\gamma\)</span> is a frictional parameter, and <span class="math notranslate nohighlight">\(k\)</span> is a parameter describing a torque produced by the rod when it is twisted. We can convert this problem into a first-order system using the substitutions</p>
<div class="math notranslate nohighlight">
\[  u_1 = \theta_1, \quad u_2 = \theta_2, \quad u_3 = \theta_1', \quad
  u_4 = \theta_2'.\]</div>
<p>With these definitions the system becomes</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{split}
  u_1' &amp;= u_3 \\
  u_2' &amp;= u_4 \\
  u_3' &amp;= -\gamma u_3 - \frac{g}{L}\sin u_1 + k(u_2-u_1) \\
  u_4' &amp;= -\gamma u_4 - \frac{g}{L}\sin u_2 + k(u_1-u_2),
\end{split}\end{split}\]</div>
<p>which is a first-order system in four dimensions. To complete the description of the problem, you would need to specify values for <span class="math notranslate nohighlight">\(\theta_1(0)\)</span>, <span class="math notranslate nohighlight">\(\theta_1'(0)\)</span>, <span class="math notranslate nohighlight">\(\theta_2(0)\)</span>, and <span class="math notranslate nohighlight">\(\theta_2'(0)\)</span>.</p>
</div></div><p>The trick illustrated in the preceding examples is always available. Specifically, one introduces a new variable (that is, a component of <span class="math notranslate nohighlight">\(\mathbf{u}\)</span>) for all but the highest derivative appearing for every variable of the original formulation. The surest way to get the transformation correct is to define one component of the new vector variable for each scalar initial condition given. Many equations for the first-order system then come from the trivial relationships among all the lower derivatives. The remaining equations for the system come from the original, high-order equations.  In the end, there must be as many scalar component equations as unknown first-order variables.</p>
</div>
<div class="section" id="methods-for-ivp-systems">
<h2>Methods for IVP systems<a class="headerlink" href="#methods-for-ivp-systems" title="Permalink to this headline">¶</a></h2>
<p id="index-0">The generalization of a scalar IVP solver to handle systems is straightforward. Consider Euler’s method, which in system form becomes</p>
<div class="math notranslate nohighlight" id="equation-eulersys">
<span class="eqno">(178)<a class="headerlink" href="#equation-eulersys" title="Permalink to this equation">¶</a></span>\[  \begin{split}
    \mathbf{u}_{i+1} &amp;= \mathbf{u}_i + h\mathbf{f}(t_i,\mathbf{u}_i), \qquad i=0,\ldots,n-1.
  \end{split}\]</div>
<p>The vector difference equation <a class="reference internal" href="#equation-eulersys">(178)</a> is just Euler’s formula applied simultaneously to each component of the ODE system.  The method is still explicit for the solution at the new time level. Note here that as always in this book, an indexed boldface quantity such as <span class="math notranslate nohighlight">\(\mathbf{u}_i\)</span> is a vector. If we want to refer to component <span class="math notranslate nohighlight">\(j\)</span> of that vector, we would write <span class="math notranslate nohighlight">\(u_{i,j}\)</span>.</p>
<p>It might surprise you that the function <a class="reference internal" href="euler.html#function-euler"><span class="std std-ref">euler</span></a> that we wrote for scalar IVPs works for systems as well. In large part that’s because as we observed with the mathematics, operations such as addition and multiplication translate easily from scalars to vectors. As long as the definition of the IVP correctly handles a vector for the dependent variable and specifies a vector initial condition, we’re all set.</p>
<div class="section" id="new-demo-needed-here">
<h3>new demo needed here<a class="headerlink" href="#new-demo-needed-here" title="Permalink to this headline">¶</a></h3>
<p>In the rest of this chapter we present methods as though they are for scalar equations, but their application to systems is straightforward. The generalization of error analysis can be more complicated, but our statements about order of accuracy and other properties are true for systems as well as scalars.  Our codes, on the other hand, are written to accept systems.</p>
</div>
</div>
<div class="section" id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">¶</a></h2>
<ol>
<li><p>✍️ Rewrite the given higher order problems as first order systems.</p>
<p><strong>(a)</strong> <span class="math notranslate nohighlight">\(y'''-3y''+3 y' -y = t, \: y(0) = 1, \: y'(0) = 2, \: y''(0) = 3\)</span></p>
<p><strong>(b)</strong> <span class="math notranslate nohighlight">\(y'' + 4 (x^2-1)y' + y = 0, \: y(0) = 2, \: y'(0) = -1\)</span></p>
<p><strong>(c)</strong> For a given constant <span class="math notranslate nohighlight">\(a\)</span>,</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{split}
  x'' + \frac{a x}{(x^2+y^2)^{3/2}} &amp;= 0\\
  y'' + \frac{a y}{(x^2+y^2)^{3/2}} &amp;= 0,
  \end{split}\end{split}\]</div>
<p>with initial values <span class="math notranslate nohighlight">\(x(0) = 1\)</span>, <span class="math notranslate nohighlight">\(x'(0)=y(0) = 0\)</span>, <span class="math notranslate nohighlight">\(y'(0)=3\)</span></p>
<p><strong>(d)</strong> <span class="math notranslate nohighlight">\(y^{(4)} -y = e^{-t}, \: y(0) = 0, \: y'(0) = 0, \: y''(0) = 1,\: y'''(0) = 0\)</span></p>
<p><strong>(e)</strong> <span class="math notranslate nohighlight">\(y'''-y''+y'-y = t, \: y(0) = 1, \: y'(0) = 2, \: y''(0) = 3\)</span></p>
</li>
<li><p>✍️ Write the given IVP as a system. Then do two steps of Euler’s method by hand (perhaps with a calculator) with the indicated step size <span class="math notranslate nohighlight">\(h\)</span>. Using the given exact solution, compute the error after the second step.</p>
<p><strong>(a)</strong> <span class="math notranslate nohighlight">\(y''+ 4y = 4t, \: y(0) = 1,\: y'(0) = 1; \: \hat{y}(t) = t+\cos (2t),\: h=0.1\)</span></p>
<p><strong>(b)</strong> <span class="math notranslate nohighlight">\(y''- 4y = 4t, \: y(0) = 2,\: y'(0) = -1; \: \hat{y}(t) = e^{2t} + e^{-2t}-t,\: h=0.1\)</span></p>
<p><strong>(c)</strong> <span class="math notranslate nohighlight">\(2 x^2 y'' +3xy' - y = 0, \: y(2) = 1, \: y'(2) = -1/2,  \: \hat{y}(x) = 2/x, h = 1/8\)</span></p>
<p><strong>(d)</strong> <span class="math notranslate nohighlight">\(2 x^2 y'' +3xy' - y = 0,\: y(1) = 4, \: y'(1) = -1, \: \hat{y}(x) = 2(x^{1/2} + x^{-1}), h=1/4\)</span></p>
</li>
<li><p>⌨️ Solve the following IVPs using <a class="reference internal" href="euler.html#function-euler"><span class="std std-ref">euler</span></a> using <span class="math notranslate nohighlight">\(n=100\)</span> steps. Plot the solution and its first derivative together on one plot, and plot the error in each component as functions of time on another.</p>
<p><strong>(a)</strong> <span class="math notranslate nohighlight">\(u''+ 4u = 4t, \: 0&lt; t&lt; 2\pi, \: u(0) = 1,\: u'(0) = 1; \: \hat{u}(t) = t+\cos (2t)\)</span></p>
<p><strong>(b)</strong> <span class="math notranslate nohighlight">\(u''+ 9u = \sin(2t), \: 0&lt; t&lt; 2\pi, \: u(0) = 2,\: u'(0) = 1\)</span>;</p>
<p><span class="math notranslate nohighlight">\(\quad \hat{u}(t) = (1/5) \sin(3t) + 2 \cos (3t)+  (1/5) \sin (2t)\)</span></p>
<p><strong>(c)</strong> <span class="math notranslate nohighlight">\(u''- 4u = 4t \: 0&lt; t&lt; \pi, \: u(0) = 2,\: u'(0) = -1; \: \hat{u}(t) = e^{2t} + e^{-2t}-t\)</span></p>
<p><strong>(d)</strong> <span class="math notranslate nohighlight">\(u''+ 4u'+ 4u = t, \: 0&lt; t&lt; 4, \: u(0) = 1,\: u'(0) = 3/4; \: \hat{u}(t) = (3t+5/4)e^{-2t} + (t-1)/4\)</span></p>
<p><strong>(e)</strong> <span class="math notranslate nohighlight">\(x^2 y'' +5xy' + 4y = 0,\: 1&lt;x&lt;e^2, \: y(1) = 0, \: y'(1) = 2, \: \hat{y}(x) = (2/x^2) \ln x\)</span></p>
<p><strong>(f)</strong> <span class="math notranslate nohighlight">\(x^2 y'' +5xy' + 4y = 0,\: 1&lt;x&lt;e^2, \: y(1) = 1, \: y'(1) = -1, \: \hat{y}(x) = x^{-2}( 1 + \ln x)\)</span></p>
<p><strong>(g)</strong> <span class="math notranslate nohighlight">\(2 x^2 y'' +3xy' - y = 0,\: 2&lt;x&lt;20, \: y(2) = 1, \: y'(2) = -1/2, \: \hat{y}(x) = 2/x\)</span></p>
<p><strong>(h)</strong> <span class="math notranslate nohighlight">\(2 x^2 y'' +3xy' - y = 0,\: 1&lt;x&lt;16, \: y(1) = 4, \: y'(1) = -1, \: \hat{y}(x) = 2(x^{1/2} + x^{-1})\)</span></p>
<p><strong>(i)</strong> <span class="math notranslate nohighlight">\(x^2 y'' -xy' + 2y = 0,\: 1&lt;x&lt;e^{\pi}, \: y(1) = 3, \: y'(1) = 4\)</span>;</p>
<p><span class="math notranslate nohighlight">\(\quad \hat{y}(x) = x \left[ 3 \cos \left( \ln x \right)+\sin \left( \ln x \right) \right]\)</span></p>
<p><strong>(j)</strong> <span class="math notranslate nohighlight">\(x^2 y'' + 3xy' + 4y = 0,\: e^{\pi/12} &lt; x &lt; e^{\pi}, \: y(e^{\pi/12}) = 0,  \: y'(e^{\pi/12}) = -6\)</span>;</p>
<p><span class="math notranslate nohighlight">\(\quad \hat{y}(x) = x^{-1} \left[ 3 \cos \left( 3 \ln x \right)+\sin \left( 3 \ln x \right) \right]\)</span></p>
</li>
<li id="problem-sir"><p>⌨️ A disease that is endemic to a population can be modeled by tracking the fraction of the population that is susceptible to infection, <span class="math notranslate nohighlight">\(v(t)\)</span>, and the fraction that is infectious, <span class="math notranslate nohighlight">\(w(t)\)</span>. (The rest of the population is considered to be recovered and immune.) A typical model is the <strong>SIR model</strong> (see \cite{Britton2003})</p>
<div class="math notranslate nohighlight">
\[\frac{dv}{dt} = 0.2(1-v) - 3vw, \qquad \frac{dw}{dt} = (3v-1)w.\]</div>
<p>Starting with <span class="math notranslate nohighlight">\(v(0) = 0.95\)</span> and <span class="math notranslate nohighlight">\(w(0) = 0.05\)</span>, use “ode45” to find the long-term steady values of <span class="math notranslate nohighlight">\(v(t)\)</span> and <span class="math notranslate nohighlight">\(w(t)\)</span>. Plot both components of the solution as functions of time.</p>
</li>
<li><p>⌨️ Compute the solution to the systems for the given initial conditions using <code class="docutils literal notranslate"><span class="pre">solve</span></code>. Plot your results as a curve in the phase plane (that is, with <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> as the axes of the plot.)</p></li>
<li><p>Using initial conditions with <span class="math notranslate nohighlight">\(x(0)^2+y(0)^2\)</span> both smaller and larger than 1 (inside and outside the unit circle), solve</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{split}
  x'(t) &amp; = - 4y + x(1-x^2-y^2),\\
  y'(t) &amp; = 4x + y(1-x^2-y^2),
\end{split}\end{split}\]</div>
<p>starting at <span class="math notranslate nohighlight">\(0&lt;t&lt;10\)</span>.  What is the final state of the system?</p>
</li>
<li><p>Using initial conditions with <span class="math notranslate nohighlight">\(x(0)^2+y(0)^2\)</span> both inside and outside circles of radius 1 and 2, solve</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{split}
  x'(t) &amp; = - 4y + x(1-x^2-y^2)(4-x^2-y^2),\\
  y'(t) &amp; = 4x + y(1-x^2-y^2)(4-x^2-y^2),
\end{split}\end{split}\]</div>
<p>starting at <span class="math notranslate nohighlight">\(0&lt;t&lt;10\)</span>.  What is the final state of the system? Justify your answer with a plot showing the trajectories in the <span class="math notranslate nohighlight">\((x,y)\)</span>-plane for a few different initial conditions.</p>
</li>
<li id="problem-fitznag"><p>⌨️ The <strong>Fitzhugh–Nagumo equations</strong> are a simple model of the repeated firing of a neuron. They are given by</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{split}
\frac{d v_1}{dt} &amp;= - v_1(v_1-1)(v_1-a) - v_2 + I, \\
\frac{d v_2}{dt} &amp;= \epsilon ( v_1 - \gamma v_2).
\end{split}\end{split}\]</div>
<p>Assume <span class="math notranslate nohighlight">\(v_1(0) = 0.5\)</span>, <span class="math notranslate nohighlight">\(v_2(0) = 0.1\)</span>, <span class="math notranslate nohighlight">\(a = 0.1\)</span>, <span class="math notranslate nohighlight">\(\epsilon = 0.008\)</span>, <span class="math notranslate nohighlight">\(\gamma = 1\)</span>. For each value of <span class="math notranslate nohighlight">\(I\)</span> below, find and plot the solution using <code class="docutils literal notranslate"><span class="pre">solve</span></code> for <span class="math notranslate nohighlight">\(0\le t \le 600\)</span>. The solutions are highly sensitive to <span class="math notranslate nohighlight">\(I\)</span>, and you need to change the requested absolute and relative error tolerances to <span class="math notranslate nohighlight">\(10^{-9}\)</span>. In each case the solution quickly approaches a periodic oscillation.</p>
<p><strong>(a)</strong> <span class="math notranslate nohighlight">\(I = 0.05527,\quad\)</span>
<strong>(b)</strong> <span class="math notranslate nohighlight">\(I = 0.05683,\quad\)</span>
<strong>(c)</strong> <span class="math notranslate nohighlight">\(I = 0.0568385,\quad\)</span>
<strong>(d)</strong> <span class="math notranslate nohighlight">\(I = 0.05740\)</span>.</p>
<p>This exploration was carried out by Baer and Erneux \cite{BaerErneux86}.</p>
</li>
</ol>
</div>
</div>


              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="euler.html" title="previous page">Euler’s method</a>
    <a class='right-next' id="next-link" href="rk.html" title="next page">Runge–Kutta methods</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Tobin A. Driscoll and Richard J. Braun<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="../_static/js/index.js"></script>
    
  </body>
</html>