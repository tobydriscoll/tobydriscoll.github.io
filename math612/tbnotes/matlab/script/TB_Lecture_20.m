
A = magic(4) + eye(4)
x = (4:-1:1)';   % exact answer
b = A*x;

format rat
AA = [A b];
AA(2,:) = AA(2,:) - (5/17)*AA(1,:);
AA(3,:) = AA(3,:) - (9/17)*AA(1,:);
AA(4,:) = AA(4,:) - (4/17)*AA(1,:)

I = eye(4);
L21 = I + (-5/17)*I(:,2)*I(:,1)';
L31 = I + (-9/17)*I(:,3)*I(:,1)';
L41 = I + (-4/17)*I(:,4)*I(:,1)';

L41*(L31*(L21*[A b]))

L1 = L41*L31*L21

A1 = L1*A

L2 = I;
L2(3,2) = (-101/194);
L2(4,2) = (-230/194);
A2 = L2*A1

format
L3 = I;
L3(4,3) = -A2(4,3)/A2(3,3);
A3 = L3*A2

U = L3*(L2*(L1*A))

M = L3*L2*L1

[ L1(:,1) L2(:,2) L3(:,3) ]

L = inv(M)

A - L*U


