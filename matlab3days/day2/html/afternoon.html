
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>afternoon</title><meta name="generator" content="MATLAB 8.1"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2014-08-01"><meta name="DC.source" content="afternoon.m"><style type="text/css">

body {
  background-color: white;
  margin:10px;
}

h1 {
  color: #990000; 
  font-size: x-large;
}

h2 {
  color: #990000;
  font-size: medium;
}

/* Make the text shrink to fit narrow windows, but not stretch too far in 
wide windows. */ 
p,h1,h2,div.content div {
  max-width: 600px;
  /* Hack for IE6 */
  width: auto !important; width: 600px;
}

pre.codeinput {
  background: #EEEEEE;
  padding: 10px;
}
@media print {
  pre.codeinput {word-wrap:break-word; width:100%;}
} 

span.keyword {color: #0000FF}
span.comment {color: #228B22}
span.string {color: #A020F0}
span.untermstring {color: #B20000}
span.syscmd {color: #B28C00}

pre.codeoutput {
  color: #666666;
  padding: 10px;
}

pre.error {
  color: red;
}

p.footer {
  text-align: right;
  font-size: xx-small;
  font-weight: lighter;
  font-style: italic;
  color: gray;
}

  </style><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
      MathJax.Hub.Config({
        jax: ["input/TeX","output/HTML-CSS"],
      });
    </script></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#1">Elimination</a></li><li><a href="#9">Automation</a></li><li><a href="#18">Backslash</a></li></ul></div><h2>Elimination<a name="1"></a></h2><p>Toby Driscoll, July 2014</p><pre class="codeinput">clear, close <span class="string">all</span>
</pre><p>Let's walk through Gaussian elimination for a particular linear system of equations.</p><pre class="codeinput">A = [ 2 1 1 0; 4 3 3 1; 8 7 9 5; 6 7 9 8 ]
b = [ 4; 9; 17; 12];
</pre><pre class="codeoutput">
A =

     2     1     1     0
     4     3     3     1
     8     7     9     5
     6     7     9     8

</pre><p>First make the augmented matrix.</p><pre class="codeinput">Ab = [ A, b ];
</pre><p>Use the first row to eliminate nonzeros from the first column.</p><pre class="codeinput">Ab(2,:) = Ab(2,:) - 2*Ab(1,:);
Ab(3,:) = Ab(3,:) - 4*Ab(1,:);
Ab(4,:) = Ab(4,:) - 3*Ab(1,:)
</pre><pre class="codeoutput">
Ab =

     2     1     1     0     4
     0     1     1     1     1
     0     3     5     5     1
     0     4     6     8     0

</pre><p>Now repeat for the second row and column.</p><pre class="codeinput">Ab(3,:) = Ab(3,:) - 3*Ab(2,:);
Ab(4,:) = Ab(4,:) - 4*Ab(2,:)
</pre><pre class="codeoutput">
Ab =

     2     1     1     0     4
     0     1     1     1     1
     0     0     2     2    -2
     0     0     2     4    -4

</pre><p>One more time and we get a triangular structure.</p><pre class="codeinput">Ab(4,:) = Ab(4,:) - Ab(3,:)
</pre><pre class="codeoutput">
Ab =

     2     1     1     0     4
     0     1     1     1     1
     0     0     2     2    -2
     0     0     0     2    -2

</pre><p>Now we can solve for <span class="MathJax_Preview"><img src="afternoon_eq58365.png" alt="$x_4$"></span><script type="math/tex">x_4</script> immediately:</p><pre class="codeinput">x(4,1) = Ab(4,5) / Ab(4,4);
</pre><p>We can walk up the rows from there.</p><pre class="codeinput">x(3) = (Ab(3,5) - Ab(3,4)*x(4)) / Ab(3,3);
x(2) = (Ab(2,5) - Ab(2,4)*x(4) - Ab(2,3)*x(3)) / Ab(2,2);
x(1) = (Ab(1,5) - Ab(1,4)*x(4) - Ab(1,3)*x(3) - Ab(1,2)*x(2)) / Ab(1,1);
</pre><h2>Automation<a name="9"></a></h2><p>Surely we can automate this! Let's start with the solution part at the end.</p><pre class="codeinput">x(4,1) = Ab(4,5) / Ab(4,4);
</pre><p>We see some inner products in the steps that follow.</p><pre class="codeinput">x(3) = (Ab(3,5) - Ab(3,4)*x(4)) / Ab(3,3);
x(2) = (Ab(2,5) - Ab(2,3:4)*x(3:4)) / Ab(2,2);
x(1) = (Ab(1,5) - Ab(1,2:4)*x(2:4)) / Ab(1,1);
</pre><p>Could it work to write this in a loop?</p><pre class="codeinput">n = 4;
<span class="keyword">for</span> i = n:-1:1
    x(i,1) = (Ab(i,n+1) - Ab(i,i+1:n)*x(i+1:n)) / Ab(i,i);
<span class="keyword">end</span>
</pre><p>The other part can be automated too. We'll skip the details and rely on MATLAB for it.</p><pre class="codeinput">[L,U,P] = lu(A)
</pre><pre class="codeoutput">
L =

    1.0000         0         0         0
    0.7500    1.0000         0         0
    0.5000   -0.2857    1.0000         0
    0.2500   -0.4286    0.3333    1.0000


U =

    8.0000    7.0000    9.0000    5.0000
         0    1.7500    2.2500    4.2500
         0         0   -0.8571   -0.2857
         0         0         0    0.6667


P =

     0     0     1     0
     0     0     0     1
     0     1     0     0
     1     0     0     0

</pre><p>The <tt>lu</tt> command finds three matrices such that <span class="MathJax_Preview"><img src="afternoon_eq31951.png" alt="$PA = LU$"></span><script type="math/tex">PA = LU</script>, where <span class="MathJax_Preview"><img src="afternoon_eq77019.png" alt="$PA$"></span><script type="math/tex">PA</script> is a permutation of the rows of <span class="MathJax_Preview"><img src="afternoon_eq31461.png" alt="$A$"></span><script type="math/tex">A</script>, and <span class="MathJax_Preview"><img src="afternoon_eq93576.png" alt="$L$"></span><script type="math/tex">L</script> and <span class="MathJax_Preview"><img src="afternoon_eq15166.png" alt="$U$"></span><script type="math/tex">U</script> are triangular. It's not obvious why this is equivalent to Gaussian elimination, but it is.</p><p>Now, if <span class="MathJax_Preview"><img src="afternoon_eq84590.png" alt="$Ax=b$"></span><script type="math/tex">Ax=b</script>, then <span class="MathJax_Preview"><img src="afternoon_eq30061.png" alt="$PAx=Pb$"></span><script type="math/tex">PAx=Pb</script> and <span class="MathJax_Preview"><img src="afternoon_eq40741.png" alt="$L(Ux)=Pb$"></span><script type="math/tex">L(Ux)=Pb</script>. So we do a forward substitution to find <span class="MathJax_Preview"><img src="afternoon_eq24792.png" alt="$Ux$"></span><script type="math/tex">Ux</script>, and then a backward substitution to find <span class="MathJax_Preview"><img src="afternoon_eq43551.png" alt="$x$"></span><script type="math/tex">x</script>. There are shortcuts for these steps too.</p><pre class="codeinput">z = L \ (P*b);
x = U \ z
</pre><pre class="codeoutput">
x =

    1.0000
    2.0000
    0.0000
   -1.0000

</pre><p>Hmm, we seem to have gotten a different expression.</p><pre class="codeinput">x - round(x)
</pre><pre class="codeoutput">
ans =

   1.0e-15 *

    0.4441
   -0.4441
    0.0648
    0.1110

</pre><p>This is very close to a tiny error caused by roundoff, of size</p><pre class="codeinput">eps
</pre><pre class="codeoutput">
ans =

   2.2204e-16

</pre><p>In general, we cannot expect answers to be any more accurate (in a relative sense) than eps. In fact, sometimes they are much less accurate, as explained in numerical analysis.</p><h2>Backslash<a name="18"></a></h2><p>The backslash we used for triangular solves can in fact be used for the original system, <span class="MathJax_Preview"><img src="afternoon_eq84590.png" alt="$Ax=b$"></span><script type="math/tex">Ax=b</script>.</p><pre class="codeinput">x = A \ b
</pre><pre class="codeoutput">
x =

    1.0000
    2.0000
    0.0000
   -1.0000

</pre><p>This performs a factorization and two triangular solves automatically. The expression <tt>A\</tt> is the mathematical equivalent of <span class="MathJax_Preview"><img src="afternoon_eq05299.png" alt="$A^{-1}$"></span><script type="math/tex">A^{-1}</script> multiplied on the left. However, in computation we never use the inverse, because doing so is much slower.</p><p class="footer"><br>
      Published with MATLAB&reg; 8.1<br></p></div><!--
##### SOURCE BEGIN #####
%% Elimination
% Toby Driscoll, July 2014
clear, close all

%%
% Let's walk through Gaussian elimination for a particular linear system of
% equations. 
A = [ 2 1 1 0; 4 3 3 1; 8 7 9 5; 6 7 9 8 ]
b = [ 4; 9; 17; 12];

%%
% First make the augmented matrix.
Ab = [ A, b ];

%%
% Use the first row to eliminate nonzeros from the first column.
Ab(2,:) = Ab(2,:) - 2*Ab(1,:);
Ab(3,:) = Ab(3,:) - 4*Ab(1,:);
Ab(4,:) = Ab(4,:) - 3*Ab(1,:)

%%
% Now repeat for the second row and column.
Ab(3,:) = Ab(3,:) - 3*Ab(2,:);
Ab(4,:) = Ab(4,:) - 4*Ab(2,:)

%%
% One more time and we get a triangular structure.
Ab(4,:) = Ab(4,:) - Ab(3,:)

%%
% Now we can solve for $x_4$ immediately:
x(4,1) = Ab(4,5) / Ab(4,4);

%%
% We can walk up the rows from there.
x(3) = (Ab(3,5) - Ab(3,4)*x(4)) / Ab(3,3);
x(2) = (Ab(2,5) - Ab(2,4)*x(4) - Ab(2,3)*x(3)) / Ab(2,2);
x(1) = (Ab(1,5) - Ab(1,4)*x(4) - Ab(1,3)*x(3) - Ab(1,2)*x(2)) / Ab(1,1);

%% Automation
% Surely we can automate this! Let's start with the solution part at the
% end.
x(4,1) = Ab(4,5) / Ab(4,4);

%%
% We see some inner products in the steps that follow.
x(3) = (Ab(3,5) - Ab(3,4)*x(4)) / Ab(3,3);
x(2) = (Ab(2,5) - Ab(2,3:4)*x(3:4)) / Ab(2,2);
x(1) = (Ab(1,5) - Ab(1,2:4)*x(2:4)) / Ab(1,1);

%%
% Could it work to write this in a loop?
n = 4;
for i = n:-1:1
    x(i,1) = (Ab(i,n+1) - Ab(i,i+1:n)*x(i+1:n)) / Ab(i,i);
end

%%
% The other part can be automated too. We'll skip the details and rely on
% MATLAB for it.
[L,U,P] = lu(A)

%%
% The |lu| command finds three matrices such that $PA = LU$, where $PA$ is a
% permutation of the rows of $A$, and $L$ and $U$ are triangular. It's not
% obvious why this is equivalent to Gaussian elimination, but it is. 

%%
% Now, if $Ax=b$, then $PAx=Pb$ and $L(Ux)=Pb$. So we do a forward
% substitution to find $Ux$, and then a backward substitution to find $x$.
% There are shortcuts for these steps too.
z = L \ (P*b);
x = U \ z

%%
% Hmm, we seem to have gotten a different expression. 
x - round(x)

%%
% This is very close to a tiny error caused by roundoff, of size
eps

%%
% In general, we cannot expect answers to be any more accurate (in a
% relative sense) than eps. In fact, sometimes they are much less accurate,
% as explained in numerical analysis.

%% Backslash
% The backslash we used for triangular solves can in fact be used for the
% original system, $Ax=b$.
x = A \ b

%%
% This performs a factorization and two triangular solves automatically.
% The expression |A\| is the mathematical equivalent of $A^{-1}$ multiplied
% on the left. However, in computation we never use the inverse, because
% doing so is much slower. 

##### SOURCE END #####
--></body></html>