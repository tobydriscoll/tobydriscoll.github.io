
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Webster's horn equation</title><meta name="generator" content="MATLAB 8.4"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2016-02-03"><meta name="DC.source" content="websterhorn.m"><style type="text/css">

body {
  background-color: white;
  margin:10px;
}

h1 {
  color: #990000; 
  font-size: x-large;
}

h2 {
  color: #990000;
  font-size: medium;
}

/* Make the text shrink to fit narrow windows, but not stretch too far in 
wide windows. */ 
p,h1,h2,div.content div {
  max-width: 600px;
  /* Hack for IE6 */
  width: auto !important; width: 600px;
}

pre.codeinput {
  background: #EEEEEE;
  padding: 10px;
}
@media print {
  pre.codeinput {word-wrap:break-word; width:100%;}
} 

span.keyword {color: #0000FF}
span.comment {color: #228B22}
span.string {color: #A020F0}
span.untermstring {color: #B20000}
span.syscmd {color: #B28C00}

pre.codeoutput {
  color: #666666;
  padding: 10px;
}

pre.error {
  color: red;
}

p.footer {
  text-align: right;
  font-size: xx-small;
  font-weight: lighter;
  font-style: italic;
  color: gray;
}

  </style><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
      MathJax.Hub.Config({
        jax: ["input/TeX","output/HTML-CSS"],
      });
    </script></head><body><div class="content"><h1>Webster's horn equation</h1><!--introduction--><p>Toby Driscoll, February 2016</p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#7">Eigenmodes</a></li><li><a href="#12">Response amplitudes</a></li><li><a href="#14">References</a></li></ul></div><p>(Chebfun example applics/WebsterHorn.m) [Tags: #ODE, #BVP, #waves]</p><p>Webster's horn equation (which was established mainly by Daniel Bernoulli and Euler, not Webster) is a simple model for sound vibrations inside a thin, rigid  tube:</p><p><span class="MathJax_Preview"><img src="websterhorn_eq14241502283814164842.png" alt="$$ S \frac{\partial^2 u}{\partial t^2} = \frac{\partial}{\partial x}&#xA;\left[ \nu S \frac{\partial u}{\partial x} \right],$$"></span><script type="math/tex"> S \frac{\partial^2 u}{\partial t^2} = \frac{\partial}{\partial x}
\left[ \nu S \frac{\partial u}{\partial x} \right],</script></p><p>where <span class="MathJax_Preview"><img src="websterhorn_eq06390586243604665003.png" alt="$S(x)$"></span><script type="math/tex">S(x)</script> is cross-sectional area along the tube, <span class="MathJax_Preview"><img src="websterhorn_eq13752947836465779354.png" alt="$u(x,t)$"></span><script type="math/tex">u(x,t)</script> is the displacement of air, and <span class="MathJax_Preview"><img src="websterhorn_eq16519649717996589748.png" alt="$\nu$"></span><script type="math/tex">\nu</script> is a physical constant. If we set <span class="MathJax_Preview"><img src="websterhorn_eq08670579573660668675.png" alt="$\nu=1$"></span><script type="math/tex">\nu=1</script> and assume a harmonic solution in time, <span class="MathJax_Preview"><img src="websterhorn_eq14287064422883689460.png" alt="$u(x,t)=v(x)\exp(i\omega t)$"></span><script type="math/tex">u(x,t)=v(x)\exp(i\omega t)</script>, then we arrive at the ODE</p><p><span class="MathJax_Preview"><img src="websterhorn_eq07744491204424888047.png" alt="$$ v''(x) + \frac{S'(x)}{S(x)} \, v'(x) + \omega^2 v(x) = 0.$$"></span><script type="math/tex"> v''(x) + \frac{S'(x)}{S(x)} \, v'(x) + \omega^2 v(x) = 0.</script></p><p>Let's assume an axisymmetric tube whose radius is <span class="MathJax_Preview"><img src="websterhorn_eq05890083721635576775.png" alt="$r(x)$"></span><script type="math/tex">r(x)</script>, as given by</p><pre class="codeinput">x = chebfun(<span class="string">'x'</span>,[0,1]);
r = 0.01*exp(x) + 0.12*exp(x.^6);
plot([r,-r],<span class="string">'k'</span>), axis <span class="string">equal</span>
S = pi*r.^2;
</pre><img vspace="5" hspace="5" src="websterhorn_01.png" alt=""> <h2>Eigenmodes<a name="7"></a></h2><p>We can view the problem as the eigenvalues of the operator</p><pre class="codeinput">A = chebop( @(u) diff(u,2) + diff(u)*diff(S)/S, [0,1] );
</pre><p>Let's choose some boundary conditions for the horn.</p><pre class="codeinput">A.lbc = <span class="string">'dirichlet'</span>;  A.rbc = <span class="string">'neumann'</span>;
</pre><p>Now we solve the eigenvalue problem and find the resonant frequencies of the horn.</p><pre class="codeinput">[V,Lam] = eigs(A,8,<span class="string">'sm'</span>);
lam = diag(Lam);  om = sort(sqrt(-lam))
</pre><pre class="codeoutput">
om =

    1.1130
    4.3548
    7.6472
   10.8536
   14.0298
   17.1926
   20.3483
   23.5000

</pre><p>We can also see the solutions for <span class="MathJax_Preview"><img src="websterhorn_eq03158747792916826732.png" alt="$v$"></span><script type="math/tex">v</script> at those resonances.</p><pre class="codeinput">plot(V(:,end-3:end))
</pre><img vspace="5" hspace="5" src="websterhorn_02.png" alt=""> <p>Each next-higher mode introduces a new bump in the solution curve.</p><h2>Response amplitudes<a name="12"></a></h2><p>We can solve Webster's equation at any frequency <span class="MathJax_Preview"><img src="websterhorn_eq08589834809570054062.png" alt="$\omega$"></span><script type="math/tex">\omega</script>, not just the resonant ones.</p><pre class="codeinput">omega = sort( [om'+0.025, om'-0.025, linspace(.2,9,61)] );
<span class="keyword">for</span> k = 1:length(omega)
    ode = @(u) diff(u,2) + diff(u)*diff(S)/S + omega(k)^2*u;
    L = chebop(ode,[0,1],1,<span class="string">'neumann'</span>);
    u = L\0;
    ampl(k) = sqrt( max(u.^2) );
<span class="keyword">end</span>
plot(omega,ampl,<span class="string">'-'</span>)
hold <span class="string">on</span>, plot([om';om'],[0;100],<span class="string">'k--'</span>)
axis([0 9 0 15])
xlabel(<span class="string">'frequency'</span>),  ylabel(<span class="string">'amplitude'</span>)
</pre><img vspace="5" hspace="5" src="websterhorn_03.png" alt=""> <p>In principle, the resonant peaks are unbounded. It's more physically realistic to introduce some damping into the solution by means of a complex frequency.</p><pre class="codeinput"><span class="keyword">for</span> k = 1:length(omega)
    freq = omega(k) + 0.1i;
    ode = @(u) diff(u,2) + diff(u)*diff(S)/S + freq^2*u;
    L = chebop(ode,[0,1],1,<span class="string">'neumann'</span>);
    u = L\0;
    ampl(k) = sqrt( max( u.*conj(u) ) );
<span class="keyword">end</span>
plot(omega,ampl)
</pre><img vspace="5" hspace="5" src="websterhorn_04.png" alt=""> <h2>References<a name="14"></a></h2><p>[1] E. Eisner, Complete solutions of the ?Webster? horn equation, <i>J. Acoust. Soc. Amer.</i> 41(4), 1126?1146, 1967.</p><p class="footer"><br>
      Published with MATLAB&reg; 8.4<br></p></div><!--
##### SOURCE BEGIN #####
%% Webster's horn equation
% Toby Driscoll, February 2016

%%
% (Chebfun example applics/WebsterHorn.m)
% [Tags: #ODE, #BVP, #waves]

%%
% Webster's horn equation (which was established mainly by Daniel Bernoulli
% and Euler, not Webster) is a simple model for sound vibrations inside
% a thin, rigid  tube:

%%
% $$ S \frac{\partial^2 u}{\partial t^2} = \frac{\partial}{\partial x}
% \left[ \nu S \frac{\partial u}{\partial x} \right],$$

%%
% where $S(x)$ is cross-sectional area along the tube, $u(x,t)$ is the
% displacement of air, and $\nu$ is a physical constant. If we set $\nu=1$
% and assume a harmonic solution in time, $u(x,t)=v(x)\exp(i\omega t)$,
% then we arrive at the ODE

%%
% $$ v''(x) + \frac{S'(x)}{S(x)} \, v'(x) + \omega^2 v(x) = 0.$$ 

%% 
% Let's assume an axisymmetric tube whose radius is $r(x)$, as given by
x = chebfun('x',[0,1]);
r = 0.01*exp(x) + 0.12*exp(x.^6);
plot([r,-r],'k'), axis equal
S = pi*r.^2;

%% Eigenmodes
% We can view the problem as the eigenvalues of the operator 
A = chebop( @(u) diff(u,2) + diff(u)*diff(S)/S, [0,1] );

%%
% Let's choose some boundary conditions for the horn.
A.lbc = 'dirichlet';  A.rbc = 'neumann';

%%
% Now we solve the eigenvalue problem and find the resonant frequencies of
% the horn.
[V,Lam] = eigs(A,8,'sm');
lam = diag(Lam);  om = sort(sqrt(-lam))

%%
% We can also see the solutions for $v$ at those resonances.
plot(V(:,end-3:end))

%%
% Each next-higher mode introduces a new bump in the solution curve. 

%% Response amplitudes
% We can solve Webster's equation at any frequency $\omega$, not just the
% resonant ones.
omega = sort( [om'+0.025, om'-0.025, linspace(.2,9,61)] );
for k = 1:length(omega) 
    ode = @(u) diff(u,2) + diff(u)*diff(S)/S + omega(k)^2*u;
    L = chebop(ode,[0,1],1,'neumann');
    u = L\0;
    ampl(k) = sqrt( max(u.^2) );
end
plot(omega,ampl,'-')
hold on, plot([om';om'],[0;100],'kREPLACE_WITH_DASH_DASH')
axis([0 9 0 15])
xlabel('frequency'),  ylabel('amplitude')

%%
% In principle, the resonant peaks are unbounded. It's more physically
% realistic to introduce some damping into the solution by means of a
% complex frequency. 
for k = 1:length(omega) 
    freq = omega(k) + 0.1i;
    ode = @(u) diff(u,2) + diff(u)*diff(S)/S + freq^2*u;
    L = chebop(ode,[0,1],1,'neumann');
    u = L\0;
    ampl(k) = sqrt( max( u.*conj(u) ) );
end
plot(omega,ampl)

%% References
%
% [1] E. Eisner, Complete solutions of the ?Webster? horn equation, _J.
% Acoust. Soc. Amer._ 41(4), 1126?1146, 1967.



##### SOURCE END #####
--></body></html>