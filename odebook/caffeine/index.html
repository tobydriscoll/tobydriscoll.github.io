
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>caffeine</title><meta name="generator" content="MATLAB 8.4"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2016-01-29"><meta name="DC.source" content="caffeine.m"><style type="text/css">

body {
  background-color: white;
  margin:10px;
}

h1 {
  color: #990000; 
  font-size: x-large;
}

h2 {
  color: #990000;
  font-size: medium;
}

/* Make the text shrink to fit narrow windows, but not stretch too far in 
wide windows. */ 
p,h1,h2,div.content div {
  max-width: 600px;
  /* Hack for IE6 */
  width: auto !important; width: 600px;
}

pre.codeinput {
  background: #EEEEEE;
  padding: 10px;
}
@media print {
  pre.codeinput {word-wrap:break-word; width:100%;}
} 

span.keyword {color: #0000FF}
span.comment {color: #228B22}
span.string {color: #A020F0}
span.untermstring {color: #B20000}
span.syscmd {color: #B28C00}

pre.codeoutput {
  color: #666666;
  padding: 10px;
}

pre.error {
  color: red;
}

p.footer {
  text-align: right;
  font-size: xx-small;
  font-weight: lighter;
  font-style: italic;
  color: gray;
}

  </style><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
      MathJax.Hub.Config({
        jax: ["input/TeX","output/HTML-CSS"],
      });
    </script></head><body><div class="content"><h1></h1><!--introduction--><p>First-order pharmacokinetics models the elimination of a drug from the blood plasma with the exponential decay ODE, <span class="MathJax_Preview"><img src="caffeine_eq12705014327825159332.png" alt="$c'=-k c$"></span><script type="math/tex">c'=-k c</script>, for a positive rate constant <span class="MathJax_Preview"><img src="caffeine_eq15636846968047188835.png" alt="$k$"></span><script type="math/tex">k</script>. The rate is often expressed as a half-life <span class="MathJax_Preview"><img src="caffeine_eq01919681319774283066.png" alt="$t_H$"></span><script type="math/tex">t_H</script>, defined by <span class="MathJax_Preview"><img src="caffeine_eq10311218814164613829.png" alt="$e^{-k t_H} = 1/2$"></span><script type="math/tex">e^{-k t_H} = 1/2</script>.</p><!--/introduction--><p>Experimental evidence shows that a 300 mg oral dose of caffeine, such as might be found in a large mug of brewed coffee, creates a concentration of about 8 $\mu$g/mL in blood plasma, followed by first-order kinetics with a half-life of about 6 hours (although this rate can vary a great deal from person to person) [cite Newton et al., 1981]. This implies the ODE</p><pre class="codeinput">k = log(2)/6;
L = chebop( @(t,c) diff(c) + k*c, [0,24] );
</pre><p>We will model the effect of ingesting 300 mg of caffeine as a constant rate of increase in concentration starting at a given <span class="MathJax_Preview"><img src="caffeine_eq08844374543483926125.png" alt="$t_0$"></span><script type="math/tex">t_0</script> and lasting 30 minutes.</p><pre class="codeinput">t = chebfun(<span class="string">'t'</span>,[0,24]);
coffee = @(t0) 16*(t&gt;t0).*(t&lt;t0+0.5);
</pre><p>Starting from a bloodstream free of caffeine, suppose coffee is consumed at 7:00, 10:00, and 16:00. We will start measuring time from the first cup.</p><pre class="codeinput">intake = coffee(0) + coffee(3) + coffee(9);
L.lbc = 0;
</pre><p>Here is the resulting level of caffeine in blood plasma.</p><pre class="codeinput">c = L\intake;
plot(c)
hold <span class="string">on</span>, plot(intake,<span class="string">'color'</span>,.6*[1 1 1])
xlabel(<span class="string">'time since 7AM'</span>), ylabel(<span class="string">'{\mu}g/mL'</span>)
</pre><img vspace="5" hspace="5" src="caffeine_01.png" alt=""> <p>As you can see, a full 24 hours does not leave enough time to completely clear the caffeine from the bloodstream.</p><p class="footer"><br>
      Published with MATLAB&reg; 8.4<br></p></div><!--
##### SOURCE BEGIN #####
%%
% First-order pharmacokinetics models the elimination of a drug from the
% blood plasma with the exponential decay ODE, $c'=-k c$, for a positive
% rate constant $k$. The rate is often expressed as a half-life $t_H$,
% defined by $e^{-k t_H} = 1/2$. 

%%
% Experimental evidence shows that a 300 mg oral dose of caffeine, such as
% might be found in a large mug of brewed coffee, creates a concentration
% of about 8 $\mu$g/mL in blood plasma, followed by first-order kinetics
% with a half-life of about 6 hours (although this rate can vary a great
% deal from person to person) [cite Newton et al., 1981]. This implies the
% ODE
k = log(2)/6;
L = chebop( @(t,c) diff(c) + k*c, [0,24] );

%%
% We will model the effect of ingesting 300 mg of caffeine as a constant
% rate of increase in concentration starting at a given $t_0$ and lasting
% 30 minutes.
t = chebfun('t',[0,24]);
coffee = @(t0) 16*(t>t0).*(t<t0+0.5);

%% 
% Starting from a bloodstream free of caffeine, suppose coffee is consumed
% at 7:00, 10:00, and 16:00. We will start measuring time from the
% first cup.
intake = coffee(0) + coffee(3) + coffee(9);
L.lbc = 0;

%%
% Here is the resulting level of caffeine in blood plasma. 
c = L\intake;
plot(c)
hold on, plot(intake,'color',.6*[1 1 1])
xlabel('time since 7AM'), ylabel('{\mu}g/mL')

%%
% As you can see, a full 24 hours does not leave enough time to completely
% clear the caffeine from the bloodstream.

##### SOURCE END #####
--></body></html>